
<!DOCTYPE html>
<html lang="en">
<head>
    <title>Online Order</title>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link href="LandingPage/img/favicon.png" rel="icon">
    <link href="LandingPage/img/apple-touch-icon.png" rel="apple-touch-icon">


    <link rel="manifest" href="img/favicon/manifest.json">
    <meta name="msapplication-TileColor" content="#ffffff">
    <meta name="msapplication-TileImage" content="img/favicon/ms-icon-144x144.png">
    <meta name="theme-color" content="#ffffff">
    <link href="/css/Googlefonts.css" rel="stylesheet" defer>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" defer>
    <link href="/css/bootstrap.min.css" rel="stylesheet" defer>
    <link href="/css/jquery-bxslider.css" rel="stylesheet" defer>
    <link href="/css/Googlefonts.css" rel="stylesheet">
    <link rel="stylesheet" href="/css/style.css" defer>
    <link rel="stylesheet" href="/css/custom.css" defer>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-sweetalert/1.0.1/sweetalert.min.css"
          integrity="sha512-hwwdtOTYkQwW2sedIsbuP1h0mWeJe/hFOfsvNKpRB3CkRxq8EW7QMheec1Sgd8prYxGm1OM9OZcGW7/GUud5Fw==" crossorigin="anonymous" />
    <meta name="format-detection" content="telephone=no" />
    <meta name="msapplication-tap-highlight" content="no" />

    <!--Commented by Aditya for shift4 and elavon functionality
    <meta http-equiv="Content-Security-Policy"
        content="base-uri 'self';
             block-all-mixed-content;
             default-src 'self' https://accept.authorize.net/payment/payment https://api.demo.convergepay.com/ https://test.authorize.net/payment/payment https://maps.google.com https://accounts.google.com https://fonts.gstatic.com https://cdnjs.cloudflare.com https://www.google-analytics.com https://www.google.com;
             img-src data: https:;
             object-src 'none';
             script-src https://accept.authorize.net/payment/payment https://api.demo.convergepay.com/ https://test.authorize.net/payment/payment https://cdnjs.cloudflare.com https://apis.google.com https://maps.googleapis.com https://polyfill.io https://code.jquery.com
        https://maps.google.com https://www.googletagmanager.com https://connect.facebook.net
                        'self'
        'unsafe-inline';
             style-src https://stackpath.bootstrapcdn.com/ https://fonts.googleapis.com https://cdnjs.cloudflare.com
                       'self'
                       'unsafe-inline';
             upgrade-insecure-requests;">-->


    <script src="/js/Analytics.js"></script>
    <script src="/js/GeoLocalizert.js"></script>
    <meta name="theme-color" content="#4e8ef7">



    <style>
        .customclose {
            background-color: #EB1700;
            border-color: #EB1700;
            color: white;
        }

        .ad2hs-prompt {
            background-color: rgb(59, 134, 196); /* Blue */
            border: none;
            border-radius: 10px;
            display: none !important;
            color: white;
            padding: 15px 32px;
            text-align: center;
            text-decoration: none;
            font-size: 16px;
            position: absolute;
            margin: 0 1rem 1rem;
            left: 0;
            right: 0;
            bottom: 0;
            width: calc(100% - 32px);
        }

        .ios-prompt {
            background-color: #fcfcfc;
            border: 1px solid #666;
            display: none;
            border-radius: 10px;
            padding: 0.8rem 1rem 0 0.5rem;
            text-decoration: none;
            font-size: 16px;
            color: #555;
            position: fixed;
            margin: 0 auto 1rem;
            left: 1rem;
            right: 1rem;
            bottom: 0;
            z-index: 9;
            margin-bottom: 80px;
        }

        .imgstyle {
            display: block;
            margin-left: auto;
            margin-right: auto;
            width: 26%;
        }

        .btn_reloadtccloyl {
            padding: 7px 5px;
            text-align: center;
            background-color: #e72c18;
            box-shadow: transparent 0px 0px 0px 1px inset;
            border-radius: 4px;
            font-weight: 700;
            font-size: 16px;
            color: #fff;
            border: 0;
            cursor: pointer;
        }

        .oldrow {
            background-color: grey;
        }

        .guestactive {
            color: red;
        }

        .invalid {
            border: 1px solid red;
        }

        .error {
            color: red;
        }

        .guestname {
            cursor: pointer;
        }

        .jMaAIj {
            display: block;
            -webkit-box-flex: 1;
            flex-grow: 1;
            height: 1px;
            background-color: rgb(196, 196, 196);
            content: "";
        }
    </style>

	<meta name="theme-color" content="#ffffff" />
	<link rel="manifest" href="/manifest.webmanifest" />
	<meta name="theme-color" content="#ffffff" />
	<link rel="manifest" href="/manifest.webmanifest" />
</head>
<body>
    <div id="loader">
        <img src="/img/loader.gif" alt="loader">
    </div>
    <div id="wrapper" class="">

        <div class="overlay" style="display: none;"></div>
        <button type="button" class="ad2hs-prompt">Install Web App</button>
        <div class="ios-prompt">
            <span style="color: rgb(187, 187, 187); float: right; margin-top: -14px; margin-right: -11px;">&times;</span>
            <img src="img/add2home.svg" style="float: left; height: 80px; width: auto; margin-top: -8px; margin-right: 1rem;">
            <p style="margin-top: -3px; line-height: 1.3rem;">
                To install this Web App in your iPhone/iPad press
                <img src="img/share.svg" style="display: inline-block; margin-top: 4px; margin-bottom: -4px; height: 20px; width: auto;"> and then Add to Home Screen.
            </p>
        </div>

        <div id="page-content-wrapper">

            




<style type="text/css">
    html:focus-within {
        scroll-behavior: smooth;
    }
    /* Always set the map height explicitly to define the size of the div
    * element that contains the map. */
    #map {
        height: 50%;
    }

    .modal {
        z-index: 99999;
    }

    .modal-backdrop {
        z-index: 10;
    }

    .pac-container {
        z-index: 100000;
    }

    .customtooltip {
        position: fixed;
        background-color: #003875;
        top: 94px;
        box-shadow: rgb(0 0 0 / 20%) 0px 8px 24px;
        border-radius: 4px;
        z-index: 9999;
        display: none;
        padding: 7px;
        color: #fff;
    }

        .customtooltip:before {
            content: "";
            width: 0;
            height: 0;
            border-left: 7px solid #9c969600;
            border-right: 7px solid transparent;
            border-bottom: 10px solid #fff;
            position: absolute;
            top: -9px;
            right: 150px;
            border-block-color: #003875;
        }

    #description {
        font-family: Roboto;
        font-size: 15px;
        font-weight: 300;
    }

    #infowindow-content .title {
        font-weight: bold;
    }

    #infowindow-content {
        display: none;
    }

    #map #infowindow-content {
        display: inline;
    }

    .pac-card {
        margin: 10px 10px 0 0;
        border-radius: 2px 0 0 2px;
        box-sizing: border-box;
        -moz-box-sizing: border-box;
        outline: none;
        box-shadow: 0 2px 6px rgba(0, 0, 0, 0.3);
        background-color: #fff;
        font-family: Roboto;
    }




    #pac-input {
        padding: 8px 30px;
        border: 2px solid #ddd;
        border-radius: 5px;
    }

        #pac-input:focus {
            border-color: #4d90fe;
        }

    #title {
        color: #fff;
        background-color: #4d90fe;
        font-size: 25px;
        font-weight: 500;
        padding: 6px 50px;
    }

    .oldrow {
        background-color: grey;
    }

    .guestactive {
        color: red;
    }

    .invalid {
        border: 1px solid red;
    }

    .error {
        color: red;
    }

    .guestname {
        cursor: pointer;
    }

    .tooltip {
        color: rgb(25, 125, 217);
        position: relative;
        display: contents;
        border-bottom: 1px dotted black;
    }

        .tooltip .tooltiptext {
            visibility: hidden;
            width: 120px;
            background-color: black;
            color: #fff;
            text-align: center;
            border-radius: 6px;
            padding: 5px 0;
            position: absolute;
            z-index: 1;
            top: 150%;
            left: 50%;
            margin-left: -60px;
        }

            .tooltip .tooltiptext::after {
                content: "";
                position: absolute;
                bottom: 100%;
                left: 50%;
                margin-left: -5px;
                border-width: 5px;
                border-style: solid;
                border-color: transparent transparent black transparent;
            }

        .tooltip:hover .tooltiptext {
            visibility: visible;
        }

    .submitOrder, .leaveOrder {
        width: 49%;
        color: red;
        display: block;
        font-weight: 700;
        margin-top: 20px;
    }
</style>

<div class="container-fluid top_nav">
    <div class="row">

        <div class="col-md-4 d-flex toogle_btn align-items-center col-6">
            <div class="toogle_button">
                <button type="button" class="animated fadeInLeft desktop_menu" data-toggle="bottom_fixed_mob">
                    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" style="flex-shrink: 0;"><path fill-rule="evenodd" clip-rule="evenodd" d="M4 8C3.45 8 3 7.55 3 7C3 6.45 3.45 6 4 6H20C20.55 6 21 6.45 21 7C21 7.55 20.55 8 20 8H4ZM4 13H20C20.55 13 21 12.55 21 12C21 11.45 20.55 11 20 11H4C3.45 11 3 11.45 3 12C3 12.55 3.45 13 4 13ZM4 18H20C20.55 18 21 17.55 21 17C21 16.45 20.55 16 20 16H4C3.45 16 3 16.45 3 17C3 17.55 3.45 18 4 18Z" fill="#494949"></path></svg>
                </button>
            </div>
            <ul class="inline-btn">
                            <li class="sec_type">
                                <a href="Javascript:ChangeOT(5)" class="delivery">Delivery</a><a href="Javascript:ChangeOT(6)" class="active pickup" style="pointer-events: none;">Takeout</a>
                            </li>
            </ul>
        </div>
            <div class="col-md-4 text-center justify-content-center d-flex align-items-center col-5 mob_none">
                    <h4>
                        <b>
Hapisgah 
                        </b>
                    </h4>
            </div>

            <div class="col-6 d-flex toogle_btn align-items-center justify-content-center mob_show">
                    <h5>
                        <b>
Hapisgah                         </b>

                    </h5>
                <a href="javascript:void(0)" class="mob_location"><i id="mapMarker" class="fa fa-map-marker"></i></a>




            </div>

        <div class="col-md-4 d-flex toogle_btn align-items-center justify-content-end mob_none address_details">


            <div class="toogle_button">
                    <button id="id_cart" type="button" class="hamburger animated fadeInLeft is-closed" data-toggle="offcanvas">
                        <i class="fa fa-shopping-cart"></i>
                        <span class="qty">




0                        </span>
                    </button>


            </div>




            <div class="loction-set">
                <div class="loction-inner">
                        <form action="javascript:void(0);" class="location-search">

                            <label>Search for a new address</label>
                            <span class="icon-map-input">
                                <i class="fa fa-map-marker" aria-hidden="true"></i>
                            </span>

                            <div id="pac-container">
                                <input id="pac-input" type="text" placeholder="Address" class="form-control add" />
                            </div>
                        </form>
                    <div class="pac-card" id="pac-card">
                        <div>

                            <div id="type-selector" class="pac-controls" style="display:none">
                                <input type="radio"
                                       name="type"
                                       id="changetype-all"
                                       checked="checked" />
                                <label for="changetype-all">All</label>

                                <input type="radio" name="type" id="changetype-establishment" />
                                <label for="changetype-establishment">Establishments</label>

                                <input type="radio" name="type" id="changetype-address" />
                                <label for="changetype-address">Addresses</label>

                                <input type="radio" name="type" id="changetype-geocode" />
                                <label for="changetype-geocode">Geocodes</label>
                            </div>
                            <div id="strict-bounds-selector" class="pac-controls" style="display:none">
                                <input type="checkbox" id="use-strict-bounds" value="" />
                                <label for="use-strict-bounds">Strict Bounds</label>
                            </div>
                        </div>

                    </div>
                        <div id="map"></div>

                    <div id="infowindow-content">
                        <img src="" width="16" height="16" id="place-icon" />
                        <span id="place-name" class="title"></span><br />
                        <span id="place-address"></span>
                    </div>
                    <hr class="doublled">

                    <hr>
                    <div class="auto-set">
                        <div class="row">
                            <div class="col-1">
                                <i class="fa fa-dot-circle-o loc-icon red-icon" aria-hidden="true"></i>
                            </div>
                            <input type="hidden" id="LocationDetail" />
                            <div id="UserAddressDetails" class="row">
                            </div>

                        </div>
                    </div>
                </div>
                <div class="map-box">

                    <div class="map-frame" id="mapframe" style="width:100% !important; height:180px !important">


                    </div>
                    <div class="row mt-3 align-items-center">
                        <div class="col-7">

                            <input type="hidden" id="latitude" />
                            <input type="hidden" id="longitude" />
                            <p style="margin-bottom: 0;" id="eidtUserAddress"></p>
                        </div>
                        <div class="col-5 text-right" style="display:none;">
                            <a class="btn btn-pin btnAdjustpin" href="#">Adjust Pin</a>
                        </div>
                    </div>
                    <hr class="doublled">
                    <form action="#" style="text-align:initial !important">


                        <p><strong>Apartment number or suite</strong></p>
                            <input id="Apartmentnumber" type="text" class="form-control" placeholder="Apartment number or suite" maxlength="10"><span id="spanapartmenterror">Only 10 character allowed</span><br />
                            <p class="mt-2"><strong>Drop-off Options</strong></p>
                            <input type="radio" id="hand" value="Hand it to me" checked="checked" name="drop-option" data-placeholder="e.g. enter on Main St, it’s the 4th door on the right" />
                            <label for="hand">Hand it to me</label><br>
                            <input type="radio" id="door" value="Leave it at my door" name="drop-option" data-placeholder="e.g. ring the bell after dropoff, leave next to the porch, call upon arrival, etc." />
                            <label for="door">Leave it at my door</label>
                            <br />
<textarea rows="2" cols="46" name="comment" id="additional_drop_info" form="usrform" placeholder="e.g. enter on Main St, it’s the 4th door on the right" maxlength="16"></textarea><span id="spandroperror"><br />Only 32 character allowed</span><br />                        <div class="row mt-3">
                            <div class="col-6">
                                <input type="submit" class="canclled" value="Cancel">
                            </div>
                            <div class="col-6">
                                <input type="button" class="submitted_map" value="Submit" id="btnupdateAddress">
                            </div>
                        </div>
                    </form>
                </div>
            </div>




        </div>
    </div>
</div>

<div class="container content_box">
    <div class="row">
        <!-- row -->
        <div class="col-md-9 hiddden-cart">
            <!-- col-md-9 -->
            <div class="store_header">

                        <div class="store_banner">
                            <img src="https://cdn.orderapp.online/Steakhouse/SteakDeluxe_09 2010422030624.jpg" alt="store_banner">
                        </div>


            </div>
            <div class="row align-items-center">
                <div class="col-6 text-right">
                    <!-- <ul class="inline-btn">
                    <li><a href="#"><i class="fa fa-users" aria-hidden="true"></i> Group Order</a></li>
                    <li class="sec_type"><a href="javascript:void(0)" class="active delivery">Delivery</a><a href="javascript:void(0)" class="pickup">Pickup</a></li>
                    </ul> -->
                </div>

            </div>
            <hr>
            <div class="row">
            </div>

            <div class="row">

            </div>



            <div class="row footer_user_location">
                <div class="col-md-12 text-center">
                </div>
            </div>
        </div> <!-- col-md-9 -->
        <input data-val="true" data-val-required="The StartGPClicked field is required." id="StartGPClicked" name="StartGPClicked" type="hidden" value="False" />
        <div class="col-md-3 cart mobile_hidden none-d" id="sidebar-wrappers">
            <i class="fa fa-close mob_none" style="display: none;"></i>
 <h4 style="margin-top:4px"><strong>Your Order</strong></h4>            <input type="hidden" id="CheckConditions" />
            <table class="cart_table">
                    <tbody id="tblCart">

                                    <tr class="total_price" style="display:none">
                                        <td colspan="3"><a href="javascript:Checkout()" id="btn_checkout">Checkout <span class="pull-right cart_total" id="cartTotalDue"></span></a></td>


                                    </tr>
                                <tr class="total_price" style="display:none">

                                    <td colspan="3">  <a href="javascript:void()" data-toggle="modal" data-target="#paypal-modal">Start Over</a></td>
                                </tr>
                            <tr id="noItems">
                                <td colspan="3"><i>No Items in Cart</i></td>
                            </tr>
                            <tr>
                                <td colspan="3"><input type="hidden" id="checkonline"></td>
                            </tr>

                    </tbody>
            </table>

        </div>
    </div><!-- row -->
</div>



<!--Mobile bottom fixed bar-->
<div class="container-fluid bottom_fixed_mob">
    <div class="row">
        <div class="col-12">
            <!--Mobile Only-->
            <ul class="list-inline mobile_only">
                    <li class="list-inline" id="mob_1">

                    </li>
                <li class="list-inline-item" id="mob_2" style="display:none">
                    <a href="javascript:$('.cart').addClass('mobile_hidden')" class="menu-href"><i class="fa fa-book"></i>Menu</a>
                </li>
                    <li class="list-inline-item" id="mob_3">
                        <a href="javascript: $('.cart').removeClass('mobile_hidden')" class="cart_toggle menu-href" data-toggle="offcanvas">
                            <i class="fa fa-shopping-cart"></i>Cart<span class="cart_cunt qty">0</span>
                        </a>
                    </li>
                <li class="list-inline-item" id="mob_4">
                    <a href="javascript:CheckLoggedIn()"><i class="fa fa-spoon"></i>My Orders</a>
                </li>



                    <li class="list-inline-item"><a href="javascript:openLogin(true)" id="logout"><i class="fa fa-sign-in"></i>Sign in</a></li>
            </ul>
            <!--//Mobile Only-->
            <!--PC Only-->
            <ul class="list-inline mobile_hidden">
                <li class="list-inline-item">
                    <a href="javascript:CheckLoggedIn()"><i class="fa fa-spoon"></i>My Orders</a>
                </li>



                    <li class="list-inline-item"><a href="javascript:openLogin(true)" id="logout"><i class="fa fa-sign-in"></i>Sign in</a></li>

            </ul>
            <!--//PC Only-->
        </div>
    </div>
</div>
<script src="/js/jquery-3.5.1.min.js"></script>
<script src="/js/popper.min.js"></script>
<script src="js/bootstrap.min.js"></script>
<script src="js/custom.js"></script>
<script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyDq7K_Z54Jo0JjAnVHCLTyAQrH1qAKZDa4&libraries=places&v=weekly"
        defer></script>


<div class="modal fade" id="OrderfailedModal" tabindex="-1" role="dialog" aria-labelledby="success-modal" aria-hidden="true" data-keyboard="false" data-backdrop="static">
    <div class="modal-dialog modal-dialog-centered" role="document">
        <div class="modal-content">
            <div class="modal-header">

                <button type="button" class="close" data-dismiss="modal" aria-label="Close" id="btn_closephonemodalenabledine">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body">
                <form action="javascript:void(0);" class="promo-form form-inline">
                    <h4><label for="country-code" id="labelMessage"></label></h4>
                    <div id="Modelordersummary"></div>
                </form>

            </div>
        </div>
    </div>
</div>

<div class="modal fade" id="grouporderInfo_modal" tabindex="-1" role="dialog" aria-labelledby="groupOrder" aria-hidden="true" style="z-index: 999999;">
    <div class="modal-dialog modal-dialog-centered" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title" id="groupOrder">Group ordering is easy</h3>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body">
                <ul class="group-order-list">
                    <li>
                        <div class="img-group">
                            <img src="img/save-money1.png" alt="save-money">
                        </div>
                        <div class="text-group">
                            <h5>Save time and money</h5>
                            <p>With one shared cart and one delivery fee</p>
                        </div>
                    </li>
                    <li>
                        <div class="img-group bg1">
                            <img src="img/share.png" alt="save-money">
                        </div>
                        <div class="text-group">
                            <h5>Share with friends</h5>
                            <p>Invite upto 10 friends to add what they want</p>
                        </div>
                    </li>
                    <li>
                        <div class="img-group bg2">
                            <img src="img/checkout-pay.png" alt="save-money">
                        </div>
                        <div class="text-group">
                            <h5>Check out and pay</h5>
                            <p>One cart, one payment - and everything is ready at once</p>
                        </div>
                    </li>
                </ul>
            </div>
            <div class="modal-footer justify-content-start">
                <button type="button" class="btn btn-primary" data-dismiss="modal">Got it</button>
            </div>
        </div>
    </div>
</div>

<div class="modal fade" id="ShowGroupOrderUsers-Modal" tabindex="-1" role="dialog" aria-labelledby="groupOrder" aria-hidden="true">
    <div class="modal-dialog modal-lg" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title" id="groupOrder">
                    Group order at
Hapisgah                     <span></span>
                </h3>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body">
                <p>
                    Check out and pay when everyone has added to the order.<br>
                    <a href="#" data-toggle="modal" data-target="#grouporderInfo_modal">Learn more about group ordering</a>
                </p>
                <hr>

                <hr>
                <h5 class="Parent_Linkcopied">
 <span id="lbl_FriendsCount">0 </span> Friend

                        <input type="hidden" class="form-control" id="txt_inviteURL2" value="" style="width:-webkit-fill-available" />

                    <a href="javascript:CopyInvitationaLink('ShowGroupOrderUsers-Modal');" class="pull-right">Share Link</a>

                </h5>
                <p>
                    <span class="lbl-linkcopied pull-right" style="color: green;font-weight:700;display:none"><i class="fa fa-check"></i> Link copied !</span>
                    Invite upto 10 friends. Your friends appear here once they joined the group order.
                </p>
                <hr>
                <ul class="shared-peoples">
                        <li title="">You</li>



                </ul>


            </div>
            <div class="modal-footer justify-content-start">
                <div class="row ml-3">
                    <div class="col-8">
                        <input type="button" class="canclled" data-dismiss="modal" onclick="javascript:CancelGroupOrder();" value="Cancel Group Order">
                    </div>
                    <div class="col-4">
                        <button type="button" class="btn btn-primary" data-dismiss="modal">Done</button>
                    </div>
                </div>

            </div>
        </div>
    </div>
</div>
<div class="modal fade" id="Invitation-Modal" tabindex="-1" role="dialog" aria-labelledby="success-modal" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h4>Invite Friends</h4>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body">
                <form action="#" class="form-inline">
                    <div class="row">
                        <div class="col-12">
                            <p>Invite up to 10 friends.</p>
                        </div>
                        <div class="col-8">
                                <input type="text" class="form-control" id="txt_inviteURL" value="" style="width:-webkit-fill-available" />
                        </div>
                        <div class="col-4">
                            <input type="button" class="submitted" data-dismiss="modal" onclick="javascript:CopyInvitationaLink('Invitation-Modal')" value="Copy">
                            <label class="lbl-linkcopied mr-2" style="color:green;display:none"><i class="fa fa-check"></i> Link copied !</label>

                        </div>
                    </div>
                </form>

            </div>
            <div class="modal-footer">
                <!--<div class="row">

                   <div class="col-12">
                        <input type="button" class="submitted close" data-dismiss="modal" value="Ok">
                    </div>
                </div>!-->
            </div>

        </div>
    </div>
</div>
<div class="modal fade" id="pay-modal" tabindex="-1" role="dialog" aria-labelledby="success-modal" aria-hidden="true" data-keyboard="false" data-backdrop="static">
    <div class="modal-dialog modal-dialog-centered" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h3 id="payModalheader"></h3>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close" id="btn_closephonemodal">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body">
                <form action="javascript:void(0);" class="promo-form form-inline">
                    <h4><label for="country-code" id="lblPayMessage"></label></h4>
                    <div id="ordersummary"></div>
                    <br>
                    <h5 id="p_scanQRCode" style="display:none;color:green">Scan QR code and input phone number to view individual checks</h5>
                    <a href="#" class="btn btn-danger" id="btn_qrcode" style="display:none;background:red">Scan ORCode</a>

                </form>

            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary  Dinein-close px-4" data-dismiss="modal" value="Ok" aria-label="Close" id="btn_closephonemodal" style="font-size:20px">
                    OK
                </button>
            </div>
        </div>
    </div>
</div>
<input type="hidden" id="CardPostalCode" value="65000" />
<input type="hidden" id="CardaddressLine" value="65 Main Street" />
<div class="modal fade" id="preAuthModal" tabindex="-1" role="dialog" aria-labelledby="success-modal" aria-hidden="true" data-keyboard="false" data-backdrop="static">
    <div class="modal-dialog modal-dialog-centered" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h5>
                    Credit/ Debit Card Pre-Authorization<h5>
                        <button type="button" class="close" data-dismiss="modal" aria-label="Close" id="btn_closepreAuthModal">
                            <span aria-hidden="true">&times;</span>
                        </button>
            </div>
            <div class="modal-body">
                <div class="container">
                    <div class="row">
                        <div class="col-12">
                            <strong id="PreAuthErrorMsg" style="color:red;"></strong>

                        </div>
                    </div>

                    <br />
                    <div class="row">
                        <div class="col-6">
                            <div class="form-group">
                                <label for="preAuthAmount" class="form-label">Pre-Authorize Amount</label>
                                    <input type="number" class="form-control" name="preAuthAmount" value="0.0" id="preAuthAmount" />

                            </div>
                        </div>
                    </div>
                    <br />
                    <div class="row">
                        <div class="col-12">
                            <div id="SavedCard">
                            </div>

                        </div>
                    </div>

                    <br />
                    <div class="row">
                        <div class="col-12">
                                <button class="payment_btn add_card_btn shift4card_add form-control" onclick="$('#preAuthModal').modal('hide'); InitializeShift4();" data-toggle="modal" data-target="#credit-card"><i class="fa fa-credit-card"></i> Add New Credit/Debit Card <i class="fa fa-angle-right"></i></button>
                        </div>
                    </div>
                    <br />

                </div>

            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-success  px-4" value="Ok" aria-label="Authorize" id="btn_preAuthAmount" style="font-size:20px">
                    Authorize
                </button>

            </div>
        </div>
    </div>
</div>
<script>
</script>




<div class="modal fade" id="phonemodal" tabindex="-1" role="dialog" aria-labelledby="exampleModalCenterTitle" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h5>Delivery Address</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body">


                <form action="javascript:void(0);" class="location-search">
                    <span class="icon-map-input">
                        <i class="fa fa-map-marker" aria-hidden="true"></i>
                    </span>
                    <input id="address" class="add" type="text" placeholder="Address">
                </form>

            </div>
        </div>
    </div>
</div>
<div class="modal fade" id="ChangeStore-Modal" tabindex="-1" role="dialog" aria-labelledby="success-modal" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="justify-content-center"><label id="prompt">Do you want to change store for pickup?</label></h4>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body">
                <form action="#" class="promo-form form-inline">

                    <br>
                    <div class="row ml-3">
                        <div class="col-6">
                            <a class="btn cancelmodal close canclled" data-dismiss="modal" aria-label="Close">No</a>
                        </div>
                        <div class="col-6">
                            <a href="/AllStore" class="btn submitted btn_changestore" id="btn_changestore">Yes</a>
                        </div>
                    </div>

                </form>

            </div>

        </div>
    </div>
</div>
<div class="modal fade" id="Phonenumber_Modal" tabindex="-1" role="dialog" data-backdrop="static" data-keyboard="false" aria-labelledby="exampleModalCenterTitle" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered" role="document">
        <div class="modal-content">

            <div class="modal-body">
                <div>
                    <h5 class="hideforcheckout">Enter Phone Number</h5>
                    <form action="javascript:void(0);" class="m-3">

                        <input id="txt_phn" class="form-control hideforcheckout" type="tel" inputmode="numeric" pattern="[0-9]*" placeholder="10 Digit number" autocomplete="off" onkeypress="OnlyNumeric()" maxlength="10">
                        <h4 style="color:red"><label id="lbl_error"></label></h4>
                        <p class="mt-3" style="text-align: right;">
                            <button type="button" class="btn btn-secondary add_to_cart" id="btn_getcheckDetails" style="display:none">OK</button>

                            <button type="button" class="btn btn-secondary add_to_cart" id="btn_SavePhoneNumber">OK</button>
                            <button type="button" class="btn btn-secondary px-4" id="btn_RedirectQRCode" style="display:none" onclick="window.location.href='/QRCodeScan'">OK</button>
                        </p>

                    </form>
                </div>
            </div>
        </div>
    </div>
</div>

<div class="modal fade" id="deliveryaddressmodal" tabindex="-1" role="dialog"  data-keyboard="false" aria-labelledby="exampleModalCenterTitle" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="justify-content-center"><label id="prompt">Delivery Address</label></h4>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body">
                <div id="div_inputaddress" style="text-align: center;">
                    <h5>Search your address</h5>
                    <form action="javascript:void(0);" class="location-search">
                        <span class="icon-map-input">
                            <i class="fa fa-map-marker" aria-hidden="true"></i>
                        </span>
                        <input id="address2" class="add pac-target-input" type="text" placeholder="Address" autocomplete="off">
                    </form>
                </div>
                <div id="UserAddressDetails">
                    <input type="hidden" id="hd_mainaddr" />
                    <input type="hidden" id="hd_secondaryaddr" />
                    <input type="hidden" id="hd_lat" />
                    <input type="hidden" id="hd_long" />
                    <input type="hidden" id="hd_postalcode" />

                </div>
                <div class="div_editaddr">
                    <h6><strong class="strname" id="input_useraddress"></strong></h6>


                    <hr class="doublled">
                    <form action="#">


                        <p><strong>Apartment number or suite</strong></p>
                            <input id="txt_Apartmentnumber" type="text" class="form-control" placeholder="Apartment number or suite" maxlength="10"><span id="spanapartmenterror">Only 10 character allowed</span><br />
                            <p class="mt-2"><strong>Drop-off Options</strong></p>
                            <input type="radio" id="rd_hand" value="Hand it to me" checked="checked" name="rd_drop-option" data-placeholder="e.g. enter on Main St, it’s the 4th door on the right" />
                            <label for="hand">Hand it to me</label><br>
                            <input type="radio" id="rd_door" value="Leave it at my door" name="rd_drop-option" data-placeholder="e.g. ring the bell after dropoff, leave next to the porch, call upon arrival, etc." />
                            <label for="door">Leave it at my door</label>
                            <br />
<textarea rows="2" cols="46" name="comment" id="txt_additional_drop_info" form="usrform" placeholder="e.g. enter on Main St, it’s the 4th door on the right" maxlength="16"></textarea><span id="spandroperror"><br />Only 32 character allowed</span><br />                        <div class="row mt-3">
                            <div class="col-6">
                                <input type="button" class="canceleditaddr" name="5" id="btn_cancelUpdateaddr" value="Cancel" style="border-radius:19px">
                            </div>
                            <div class="col-6">
                                <input type="button" class="Deliveryadress-popup" name="5" value="Submit" id="popupbtn_updateAddress">
                            </div>
                        </div>
                    </form>
                </div>
                <div id="div_notfound" class="m-4" style="display:none; text-align:center">
                    <h5>This Address is out of range</h5>
                    <p>Sorry we can't deliver to your address, you can pickup your order or try another address</p>
                    <a id="btn_redirectstore" class="Deliveryadress-popup my-5">See Pickup location</a>
                </div>
                <div id="div_storeoffline" class="m-4" style="display:none">
                    <h5>The nearest store to your location is temporarily closed.</h5>
                    <p>Sorry we can't deliver to your address, you can pickup your order or try another address</p>
                    <a id="btn_redirectstoreII" class="Deliveryadress-popup my-5" style="color:white">See Pickup location</a>
                </div>
            </div>
        </div>
    </div>
</div>
<div class="modal fade product_modal" id="credit-card" tabindex="-1" role="dialog" aria-labelledby="credit-card" aria-hidden="true" style="max-height:1100px">
    <div class="modal-dialog modal-dialog-centered" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h3 style="text-align: center;">Add New Card</h3>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body">

                <div class="payment_container" id="form-main">

                    <fieldset id="payment-iframe">
                        <div id="i4goFrame"></div>
                    </fieldset>

                </div>
                <div id="walletContainer">
                    <label for="walletOptions"></label>
                    <button class="pay-button pay-hidden apple-pay-button"></button>
                    <button class="pay-button pay-hidden google-pay-button"></button>
                </div>
            </div>

        </div>
    </div>
</div>
<!--Date picket model-->
<div class="modal fade" id="selectdate" tabindex="-1" role="dialog" aria-labelledby="selectdate" aria-hidden="true" data-backdrop="static" data-keyboard="false">
    <div class="modal-dialog" role="document">
        <div class="modal-content" style="max-width: 500px; margin: 0 auto;">

            <div class="modal-body">


                <div class="inner-date modal-dates">
                        <p style="text-align: left;"><strong>Select a Pickup Date</strong></p>
                    <ul class="date-ul" id="dateselect">
                            <li class="active selDate" onclick="ShowThisDaySlot(6)" id="today" data-time="TODAY" data-date="TODAY" data-id="today"><span class="slday">TODAY</span><br><span class="sldate">06</span></li>
                            <li id="tomorrow" class=" selDate" onclick="ShowThisDaySlot(7)" data-time="Tomorrow" data-date="Tomorrow"><span class="slday">SUN</span><br><span class="sldate">07</span></li>
                            <li id="thirdoption" class=" selDate" onclick="ShowThisDaySlot(8)" data-time="08 Dec" data-date=12-08-2025><span class="slday">MON</span><br><span class="sldate">08</span></li>
                            <li id="fourthoption" class=" selDate" onclick="ShowThisDaySlot(9)" data-time="09 Dec" data-date=12-09-2025><span class="slday">TUE</span><br><span class="sldate">09</span></li>
                            <li id="fifithoption" class=" selDate" onclick="ShowThisDaySlot(10)" data-time="10 Dec" data-date=12-10-2025><span class="slday">WED</span><br><span class="sldate">10</span></li>
                    </ul>
                    <div class="row">
                        <div class="col-12">
                                <p><strong>Desired Pickup Time</strong></p>                        </div>
                        <div class="col-6">
                            <p>All times in Eastern Standard Time</p>
                        </div>

                    </div>
                    <ul class="schld-ul">

                                    <li class="active time-b" id="ClosedStore" onclick="javascript: return false">Order Closed Today</li>
                    </ul>
                        <div class="collapse" id="schdl-collapser">



                        </div>
                </div>
            </div>

        </div>
    </div>

</div>
</div>
<div class="modal fade" id="deliveryPrompt-modal" tabindex="-1" role="dialog" aria-labelledby="success-modal" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body">
                <form action="#" class="promo-form form-inline">
                    <p><h4><label>Your Cart and Menu will refresh based on new address.</label></h4></p>
                    <br>
                    <div class="row ml-3">
                        <div class="col-6">
                            <input type="button" id="btn_Canceldeliveryaddress" class="close canclled" data-dismiss="modal" aria-label="Close" value="No">
                        </div>
                        <div class="col-6">
                            <input type="button" class="submitted" data-dismiss="modal" onclick="javascript:ChangeIndexDeliveryAddress();" value="Yes">
                        </div>
                    </div>

                </form>

            </div>

        </div>
    </div>
</div>
<div class="modal fade" id="DineInGuestmodal" tabindex="-1" role="dialog" data-backdrop="static" data-keyboard="false" aria-labelledby="exampleModalCenterTitle" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h5>Select Guest</h5>
            </div>
            <div class="modal-body" style="overflow-y:scroll">
                <form action="#" class="m-3" style="max-height:600px">
                    <div class="row">
                        <div class="col-6">
                            <label>Enter Guest Count</label><br>
                            <input id="txt_guestcount" type="tel" inputmode="numeric" pattern="[0-9]*" name="guest_count" class="form-control" onkeypress="OnlyNumeric()" maxlength="1">
                        </div>
                        <div class="col-4">
                            <label style=" display: none;">123</label><br>
                            <button class="btn mr-5 add_to_cart mt-2" type="button" id="btn_Ok"><span style="color:white">Ok</span></button>
                            <button class="btn mr-5 add_to_cart mt-2" type="button" id="btn_guest" style="display:none"><span style="color:white">Reset guest</span></button>
                        </div>
                    </div>
                    <div class="row m-2" id="splitPromt" style="display:none">
                        <h5><label for="country-code" id="lblMessage1">Do you want to split the check now?</label></h5>
                        <br>

                        <button class="btn btn-success mr-5 px-4" type="button" id="btn_SplitTrue">Yes</button>
                        <button class="btn btn-danger ml-5 px-4" type="button" id="btn_SplitFalse" style="background:red">No</button>
                    </div>
                    <div class="row mx-2 mt-4" id="splitguestheading" style="display:none;color:red">
                        <h5><label for="country-code">Enter Guest details</label></h5>
                    </div>
                    <div class="row mt-3" id="rw_guestdetail" style="display:none">
                        <div class="col-12 col-sm-5 col-md-5 col-lg-5 col-xl-5">
                            <label for="phone">Guest Name</label><br>
                            <input type="text" id="txt_guestname" class="form-control" name="guestname" placeholder="Enter guest name">
                        </div>
                        <div class="col-12 col-sm-5 col-md-5 col-lg-5 col-xl-5">
                            <label for="phone">Guest Phone Number</label><br>
                            <input type="tel" id="txt_guestnumber" inputmode="numeric" pattern="[0-9]*" class="form-control" maxlength="10" name="guestname" placeholder="Enter guest phone number" onkeypress="OnlyNumeric()">
                        </div>
                        <div class="col-2 mt-4">
                            <button type="button" id="btn_addguestdetail" class="btn  add_to_cart mt-2"><span style="color:white">Add</span></button>
                        </div>
                    </div>

                    <div class="row m-2" id="editPromt" style="display:none">
                        <h5><label for="country-code" id="lblMessage2">You have entered all guest details. Do you want to edit guests details?</label></h5>
                        <br>
                        <div class="row">
                            <button class="btn btn-success px-4 ml-3" type="button" id="btn_EditYes">Edit</button>
                            <button class="btn  ml-5  add_to_cart" type="button" id="btn_EditNo"><span style="color:white">Start Order</span></button>
                        </div>
                    </div>
                    <div class="row mt-3" id="rw_editguestdetail" style="display: none;">
                        <div class="col-12 col-sm-4 col-md-4 col-lg-4 col-xl-4">
                            <label for="phone">Guest Name</label><br>
                            <input type="text" id="txt_editguestname" class="form-control" name="guestname" placeholder="Enter guest name" onkeypress="OnlyAlbhabet()">
                        </div>
                        <div class="col-12 col-sm-5 col-md-5 col-lg-5 col-xl-5">
                            <label for="phone">Guest Phone Number</label><br>
                            <input type="tel" id="txt_editguestnumber" inputmode="numeric" pattern="[0-9]*" class="form-control" maxlength="10" name="guestname" placeholder="Enter guest phone number" onkeypress="OnlyNumeric()">
                        </div>
                        <div class="col-2 mt-4">
                            <button type="button" id="btn_updateguestdetail" class="btn  add_to_cart mt-2" valuetoedit=""><span style="color:white">Update</span></button>
                        </div>

                    </div>
                    <br><br>
                    <p style="text-align: right;">
                        <button type="button" class="btn btn-secondary" id="btn_CloseEditdetail" style="display:none;">Cancel</button>
                        <button type="button" class="btn  add_to_cart" id="btn_showguestdetail" style="display:none;"><span style="color:white">OK</span></button>
                    </p>
                </form>


            </div>
        </div>
    </div>
</div>
<div class="modal fade" id="resetcart-modal" tabindex="-1" role="dialog" aria-labelledby="success-modal" aria-hidden="true" data-keyboard="false" data-backdrop="static">
    <div class="modal-dialog modal-dialog-centered" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body">
                <form action="#" class="promo-form form-inline">
                    <h4><label id="prompt">You are changing order type! Do you want to reset the cart?</label></h4>
                    <br>
                    <div class="row ml-3">
                        <div class="col-6">
                            <input type="button" class="cancelmodal" id="btn_Welcomeresetcancl" name="" value="Cancel">
                        </div>
                        <div class="col-6">
                            <input type="button" class="resetitem" id="btn_Welcomereset" name="" value="Ok">
                        </div>
                    </div>

                </form>

            </div>

        </div>
    </div>
</div>
<div class="modal fade" id="Upsellmodal" tabindex="-1" role="dialog" aria-labelledby="success-modal" aria-hidden="true" data-keyboard="false" data-backdrop="static">
    <div class="modal-dialog modal-dialog-centered" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <p style="font-size:18px">
                    <b>
                        Select
                        <span id="upsellname"></span>
                    </b>
                </p>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close" id="SkipUpsell" methodfor="Index">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body" id="upsellbody">

                <br>

            </div>
            <h6 id="ErrorMsgUpsell" style="color:red"></h6>
            <div class="modal-footer">
                    <button type="button" class="btn btn-default" id="SkipUpsell" methodfor="Index" style="padding: 8px 20px;">Skip</button>
                    <a href="javascript:SendOrderUpsell()" class="btn btn-primary add_to_cart">Send order </a>
            </div>
        </div>
    </div>
</div>
<div class="modal fade" id="DineinChecksmodal" tabindex="-1" role="dialog" aria-labelledby="success-modal" aria-hidden="true" data-keyboard="false" data-backdrop="static">
    <div class="modal-dialog modal-dialog-centered" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <p>
                    <b>
                        Following checks found open on this table, please choose to pickup
                        <span id="upsellname"></span>
                    </b>
                </p>
            </div>
            <div class="modal-body my-4" id="CheckDetailsbody">

                <br>

            </div>
            <div class="modal-footer">
                <div class="row">
                    <div class="col-12">
                        <h4 id="lbl_error" style="color:red;margin-right:62px">
                        </h4>
                    </div>
                    <div class="col-12">
                        <button type="button" class="btn btn-secondary px-4 pull-right" id="btnRedirectQRCode" style="display:none" onclick="window.location.href='/QRCodeScan'">OK</button>
                    </div>
                </div>
            </div>

        </div>
    </div>
</div>
<div class="modal fade" id="DeletegroupOrderUser-modal" tabindex="-1" role="dialog" aria-labelledby="success-modal">
    <div class="modal-dialog modal-dialog-centered" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <label id="lbl_message"></label>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">×</span>
                </button>
            </div>
            <div class="modal-body">
                <form action="#" class="promo-form form-inline">

                    <br>
                    <div class="row ml-3">
                        <div class="col-6">
                            <input type="button" class="close canclled" onclick="javascript: $('#DeletegroupOrderUser-modal').modal('hide');" value="No">
                        </div>
                        <div class="col-6">
                            <input type="button" class="submitted" id="btn_dltGroupUserModal" data-dismiss="modal" onclick="javascript:DeletegroupOrderUser();" value="Yes">
                        </div>
                    </div>

                </form>

            </div>

        </div>
    </div>
</div>
<div class="modal fade" id="MessagePopUp-modal" tabindex="-1" role="dialog" aria-labelledby="success-modal">
    <div class="modal-dialog modal-dialog-centered" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <label id="lbl_message"></label>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">×</span>
                </button>
            </div>
            <div class="modal-body">
                <form action="#" class="promo-form form-inline">

                    <br>
                    <div class="row ml-3">
                        <div class="col-6">
                            <input type="button" class="close canclled" onclick="javascript: $('#MessagePopUp-modal').modal('hide');" value="No">
                        </div>
                        <div class="col-6">
                            <input type="button" class="submitted" id="btn_dltGroupUserModal" data-dismiss="modal" onclick="javascript: isOrderSend = true; SendOrder();" value="Yes">
                        </div>
                    </div>

                </form>

            </div>

        </div>
    </div>
</div>
</div>
</div>
</div>

<div id="Dmap" class="d-none"></div>
<input id="GPGuestSignInForward" name="GPGuestSignInForward" type="hidden" value="" />
<div id="fb-root"></div>

<script>
$(window).on('scroll', function () {
        elements_all_menu = document.getElementById('all_menu');
        menus_topPos = elements_all_menu.getBoundingClientRect().top + 30;
        $('.fixed_store_menu').css('top', menus_topPos + 'px');
    });
    $(document).ready(function () {
        get_menu_height = jQuery('.container-fluid.top_nav').outerHeight() + 20;
        jQuery('.container.content_box').css('margin-top', get_menu_height + 'px');
        $('.col-md-3.cart').css('top', jQuery('.top_nav').innerHeight() + 'px');
        $('.col-md-3.cart').css('padding-top', '5px');

        var groupOrderSignInStatus = '';

         if (groupOrderSignInStatus != '' && groupOrderSignInStatus =='Invalid') {
             $('#promo-modal').modal('show');
             $('#promo-modal #lblMessage').html("<h4>Group ordering link is no longer valid! and if you want to start over, <a href='/Welcomepage' style='color:#003875;'>click here</a></h4>");
         }
        else if (groupOrderSignInStatus != '' && groupOrderSignInStatus != '1' ) {
            $('#GPGuestSignInForward').val('1');
             $('#loginModal').modal('show', { backdrop: 'static', keyboard: false });

         }
        $('video').trigger('pause');
        $('#mapMarker').click(function(){
            
            //$('#sidebar-wrappers').addClass('mobCartPosition');
            $('#sidebar-wrappers').toggleClass('mobCartPosition');
        });
    });
    $('.product_modal').on('shown.bs.modal', function () {
        setTimeout(function () {
            $('.product_modal .modal-body').scrollTop(0);
        }, 100);
        //$('.product_modal .modal-body').animate({ scrollTop: 0 }, 'fast');
    });
   
    $(function () {
        //Left Right Arrow in Menu
        toScroll = 150;
        $('#slideBack').click(function (event) {
            event.preventDefault();
            $('#mainNav').animate({
                scrollLeft: "-=" + toScroll + "px"
            }, "slow");
        });

        $('#slide').click(function (event) {
            event.preventDefault();
            $('#mainNav').animate({
                scrollLeft: "+=" + toScroll + "px"
            }, "slow");
        });
        //Left Right Arrow in Menu
        //New Fixed Item Menu
        $('#all_menu').click(function () {
            $(this).toggleClass('toggled_menu');
            $(".fixed_store_menu").toggleClass('opacity');
        });
        $('#close_fix_menu').click(function () {
            $(".fixed_store_menu").toggleClass('opacity');
        });
        //New Fixed Item Menu
        //Menu Click Top Bar
        $(".store_menu#mainNav li").on('click', function (e) {
            // setTimeout(function(){
            $('.store_menu li').removeClass('active');
            var prevWidth = 0
            $(this).prevAll().each(function () { prevWidth += 20 + $(this).width(); });
            $("#mainNav").scrollLeft(prevWidth);
            // }, 1100);
        });
        //Menu Click Top Bar
        //Scroll Event Menu Items
        $(window).on('scroll', function () {
            setTimeout(function () {
                $('.store_menu#mainNav>li.active').each(function () {
                    var prevWidth = 0
                    $(this).prevAll().each(function () { prevWidth += 20 + $(this).width(); });
                    $("#mainNav").scrollLeft(prevWidth);
                });
            }, 1100);
            if (jQuery(window).width() < 767) {
                if ($(".menu_nav").hasClass("fixed_navigation")) {
                    top_height_mob = $('.top_nav').outerHeight();
                    $('.menu_nav.fixed_navigation').css('top', top_height_mob + 'px');
                } else {
                    $('.menu_nav').css('top', '');
                }
            }
            else {
                $('.menu_nav.fixed_navigation').css('top', '52px');
            }
        });
        //Scroll Event Menu Items

        topMenu = $(".store_menu"),
            topMenuHeight = $('.top_nav').outerHeight() + $('.menu_nav').outerHeight(),
            // All list items
            menuItems = topMenu.find("a"),
            // Anchors corresponding to menu items
            scrollItems = menuItems.map(function () {
                var item = $($(this).attr("href"));
                if (item.length) { return item; }
            });

        // Bind click handler to menu items
        // so we can get a fancy scroll animation
        menuItems.click(function (e) {
            var href = $(this).attr("href"),
                offsetTop = href === "#" ? 0 : $(href).offset().top - topMenuHeight + 7;
            $('html, body').stop().animate({
                scrollTop: offsetTop
            }, 850);
            setTimeout(function () {
                menuItems.parent().removeClass("active");
                $('[href="' + href + '"]').parent().addClass('active');
            }, 1000);
            // console.log('asd');
            e.preventDefault();
        });
        //Fixed menu close if click outside of the menu
        $(document).click(function (event) {
            if (!$(event.target).closest("#all_menu,.fixed_store_menu").length) {
                $("body").find(".fixed_store_menu").removeClass("opacity");
            }
        });
        //Fixed menu close if click outside of the menu
    });</script>
<script>
$("#btn-viewgroupOrder,#btn-startgroupOrder").hover(function () {
    $('.customtooltip' ).show();
},
function () {
     $('.customtooltip' ).hide();
});

    $(document).on('click', '#date_trigger', function () {

        $('.loction-set').hide(100);
        var time = $.trim($(this).text()).split(' ');
        var d = new Date('2025/12/06');
        var asapTest = $.trim($(this).text());


        if ($.trim(time[0]) == 'Schedule' || asapTest == 'ASAP' || $.trim(time[0]).toLowerCase() == 'today') {
            $('#schdl-collapser').show();
           // debugger
            // var DayId = '#schdl-collapser #Date-' + d.getDate();
            var DayId = '.inner-date #Date-' + ("0" + d.getDate()).slice(-2);

            $.each($('[id^="Date-"]'), function () {
                $(this).hide();
            });
            $.each($(DayId), function () {
                $(this).show();
            });
            if (time.length > 2) { selectedId = '#Date-' + ("0" + d.getDate()).slice(-2) + ' [id^="modal-' + time[1] + ' ' + time[2] + '"]'; }
            else { selectedId = '#Date-' + ("0" + d.getDate()).slice(-2) + ' [id^="modal-' + time[1] + '"]'; }
            $(selectedId).addClass('active');
        }
        else if ($.trim(time[0]).toLowerCase() == 'tomorrow') {
            var day = '#' + $.trim(time[0].toLowerCase());
            var Day = $('#tomorrow .sldate').text();
            var slotTime = time[1] + ' ' + time[2];
            $('#schdl-collapser').show();

            var DayId = '#schdl-collapser #Date-' + $.trim(Day);
            $.each($('[id^="Date-"]'), function () {
                $(this).hide();
            });

            $.each($(DayId), function () {

                $(this).show();
                var slotId = DayId + ' [id^="modal-"]';

                $.each($(slotId), function () {
                    var thisId = $(this).attr('id');
                    var idSplit = thisId.split('-');

                    if (idSplit[1] == slotTime) {
                        $('.time-btn').removeClass('active');
                        var selectedslot = DayId + ' [id^="' + thisId + '"]';
                        $(selectedslot).addClass('active');
                        //$(this).parent().children('.time-btn').addClass('active');
                        //$(this).addClass('active');
                    }
                });
            });
            $('#ClosedStore').hide();
            $('.schld-ul .asap').hide();

            $('#dateselect li').removeClass('active');
            $('#' + $.trim(time[0]).toLowerCase()).addClass('active');
        }
        else {
            var DayId = '#schdl-collapser #Date-' + $.trim(time[0]);

            var slotTime = time[2] + ' ' + time[3];
            $('#schdl-collapser').show();
            $.each($('[id^="Date-"]'), function () {
                $(this).hide();
            });

            $.each($(DayId), function () {
                $(this).show();
                var slotId = DayId + ' [id^="modal-"]';
                $.each($(slotId), function () {
                    var thisId = $(this).attr('id');
                    var idSplit = thisId.split('-');
                    if (idSplit[1] == slotTime) {
                        $('.time-btn').removeClass('active');
                        $(this).parent().children('.time-btn').addClass('active');
                    }
                });
            });

            $('#ClosedStore').hide();
            $('#dateselect li').removeClass('active');
            $('.schld-ul .asap').hide();
            var datetimeAttr = time[0] + ' ' + time[1];
            $('[data-time="' + datetimeAttr + '"]').addClass('active');

            if (time.length > 2) { selectedId = '#Date-' + ("0" + d.getDate()).slice(-2) + ' [id^="modal-' + time[1] + ' ' + time[2] + '"]'; }
            else { selectedId = '#Date-' + ("0" + d.getDate()).slice(-2) + ' [id^="modal-' + time[1] + '"]'; }
            $(selectedId).addClass('active');
        }

        $('#selectdate').modal('show');
    });

    function RefreshMenu(slot) {
        debugger
        $('#loader').show();
        var date = $('ul.date-ul .active').attr('data-date');
        if (date == undefined) {
            date = 'TODAY'
        }
        CurrentTimeSlotSelected = slot;
        CurretDateSelected = date;
        $.get('/Index?handler=TimeSlotSlection&time=' + slot + '&date=' + date, null, function (data) {
            if (data == "1") {
             $('#promo-modal').modal('show');
             $('#promo-modal #lblMessage').html('<h4>Change in time slot would reset the cart. Do you want to proceed?</h4>');
             var htmlButtons = '<button class="btn px-2 mt-2 close" onclick="javascript:ChangeTimeSlot()" type="button" data-dismiss="modal" aria-label="Close"><span aria-hidden="true" class="px-4 py-1" style="background-color: #403636;color: white;border-radius: 5px;font-weight:500;">Yes</span> </button><button class="btn px-2 mt-2 close" type="button" onclick="javascript:closeTimePopup()" data-dismiss="modal" aria-label="Close"><span aria-hidden="true" class="px-4 py-1" style="background-color: #403636;color: white;border-radius: 5px;font-weight:500;">No</span> </button>';
             $('#promo-modal .modal-footer').html(htmlButtons);
            $('#loader').hide();
            }
            else { setTime(); ChangeTimeSlot();}
            });
        $.ajax({
        type: 'get',
        url: '/Index?handler=OrderTime&time=' + slot + '&date=' + date,
        data: null,
        contentType: 'application/json;charset=utf-8',
        dataType: 'json',
        success: function (data) {
        if (data == true) {
             $('#promo-modal').modal('show');
            $('#promo-modal #lblMessage').html('<h4>Items in cart are no longer valid for previous time slot, your cart has been reset</h4>');
            setTimeout(function () {
            $('#loader').show();
            window.location.href = "Index";
            }, 5000);
        }
        else {
                    $('#loader').show();
                    window.location.href = "Index";
        }
        if ($("#CheckConditions").val() == "selectdateModel")
        $(function () {
        $.getJSON('/Index?handler=DineInGuestdetail', function (data) {
        if (data == "") {
         $('#DineInGuestmodal').modal('show');
        $('#loader').hide();
        }
         });
         });
        }
        });
    //$('#loader').hide();

    }

    var CurrentTimeSlotSelected;
    var CurretDateSelected;
    function setTime() {
        if (timemonth != undefined && timeText != undefined) {

            $('#date_trigger').text(timemonth + ' ' + timeText.split('-')[0]);
            $('.time-btn').removeClass('active');
            $(timeid).addClass('active');
            $('#' + timeid).addClass('active');
            $('#modal-' + timeid).addClass('active');
            $('.date_select').hide(100);
            $('#selectdate').modal('hide');
        }



    };
    function ChangeTimeSlot() {
        setTime();
        var slot = CurrentTimeSlotSelected;
        var date = CurretDateSelected;
        $.ajax({
        type: 'get',
        url: '/Index?handler=OrderTime&time='+slot+'&date='+date,
        data: null,
        contentType: 'application/json;charset=utf-8',
        dataType: 'json',

        success: function (data) {
        //if(slot!='ASAP')


                window.location.href = "Index";




        }
        });
    }
    function closeTimePopup(){
        $('#selectdate').modal('hide');
    }

   
    $(document).ready(function () {

       


var newordertype = '3';
    var oldordertype = '3';
    var currency = '$';
var cartreset = '';
var slectedguestid = '';
var cartTime = '';
    if (3 == 0 && 3 == 0 &&  'False' == 'False'  && 'False' == "True") {

    CheckSplitcheckGuestPhonenumber();
//$('#PhoneNumber').modal('show');
}
else if (3 == 0 && 3 == 0 && 'False'=='False') {
    CheckDineInGuestPhonenumber();
}
if (slectedguestid != "") {
$('.Guestuser').removeClass('guestactive');
$('#' + slectedguestid).addClass('guestactive');
}
if (cartreset == 'true' && (cartTime != 'undefined' || cartTime != '')) {

//$('#resetcart-modal').modal('show');
$('#resetcart-modal .close').hide();
// $('#resetcart-modal').modal({ backdrop: 'static', keyboard: false })
$('#btn_Welcomereset').attr('name', newordertype);
$('#btn_Welcomeresetcancl').attr('name', newordertype);
}
else {
//$("#id_cart").trigger('click');
$('#wrapper').toggleClass('toggled');
$(".content_box .col-md-9").toggleClass("hiddden-cart", 1000);
$(".col-md-3.cart").toggleClass("none-d", 1000);
// $("#id_cartdinein").trigger('click');
if ($('#date_trigger').text().trim() == "Schedule Order") {
$('#selectdate').modal('show');

}
if ('' != "ASAP") {
getmodalTime();
}
else {
$('ul.schld-ul .asap').addClass('active');

}
if ($('#schld-ul').children().length == 0) {
$('#schdl-collapser').addClass('show');
}
$('#loader').hide();
}
    //$('#storemap').css('display', 'block');
    //$('#storemap').css('display', 'none');
    //$('#storemap').css('display', 'block');
   // document.getElementById(StoreMapIframe).contentDocument.location.reload(true);
    $('#StoreMapIframe').attr("src", $('#StoreMapIframe').attr("src"));





});

function getmodalTime() {
var datetime = '';
    var date = datetime.trim().split(' ')[0];
    var orderdate = new Date(date);
var todaydate = new Date('2025/12/06');
var time = datetime.trim().split(' ')[1] + ' ' + datetime.trim().split(' ')[2];
newdate = date.split("/")[1];
sldate = document.getElementById("dateselect").children;
for (var x = 0; x < sldate.length; x++) {
slday = sldate[x].children.item('2').textContent;
if (slday == newdate) {
$('ul.date-ul li').removeClass('active');

if (orderdate.getDate() === todaydate.getDate() && orderdate.getDay() === todaydate.getDay() && orderdate.getMonth() === todaydate.getMonth()) {
sldate[x].className = "selDate active";
$('#schdl-collapser, #schdl-collapsed').addClass('show');
$('.date_select, .inner-date.modal-dates').addClass('scroll-enable');
$('ul.schld-ul').show();
$('ul.schld-ul li').removeClass('active');
$('.time_hidden').attr('style', 'display:none');
}
else {
sldate[x].className = "future-time selDate active";
$('.asap').removeClass('active');
$('#schdl-collapser, #schdl-collapsed').addClass('show');
$('.date_select, .inner-date.modal-dates').addClass('scroll-enable');
$('ul.schld-ul').hide();
$('.time_hidden').attr('style', 'display:flex');
}

}
}
divitem = document.getElementById("schdl-collapser").children;
for (var i = 0; i < divitem.length; i++) {
insidediv = divitem[i].children;
    for (var j = 0; j < insidediv.length; j++) {
        if (insidediv[j].children.item(0) != null) {
insidetext = insidediv[j].children.item(0).text.split('-');
if (time == insidetext[0]) {
insidediv[j].children.item(0).className = "time-btn active"
return false;
}
        }
}
}
}

var area = [];
$(function () {

$.getJSON('/Index?handler=CartStoreDetail', function (data) {
if (data != "NoData") {
area = data.lstDeliveryGeoArea;
}

}).done(function (data) {
if (data != "NoData") {
var lat = data.latitude;

var lng = data.longitude;

// showMap(lat, lng);
initialize(lat, lng);
//initializeadd(lat, lng);
}

});
});

var map;

var polygon;
var bounds;

var PostalCode = "";
//var bounds;
var place;
let address = "";
let txt_address = '';
let autocompleteNew = '';
let autocompleteindex = '';
let txt_addessindex = '';
var latitude = '';
var longitude = '';
var geoarea = [];
var newlat = '';
var newlong = '';
// var place2;
function initialize(lat, lng) {

var center = new google.maps.LatLng(lat, lng);
//map = new google.maps.Map(document.getElementById('map'), {
//    center: center,
//    zoom: 17,
//    scaleControl: true
//});
//bounds = new google.maps.LatLngBounds();
//google.maps.event.addListenerOnce(map, 'tilesloaded', function (evt) {
//    bounds = map.getBounds();
//});

polygon = new google.maps.Polyline({
path: area,
geodesic: true,
strokeColor: '#FFd000',
strokeOpacity: 1.0,
strokeWeight: 4,
fillColor: '#FFd000',
fillOpacity: 0.35
});

// polygon.setMap(map);

const input = document.getElementById('address');
//const types = document.getElementById('type-selector');
//map.controls[google.maps.ControlPosition.TOP_LEFT].push(input);
//  map.controls[google.maps.ControlPosition.TOP_LEFT].push(types);

const autocomplete = new google.maps.places.Autocomplete(input);
autocomplete.addListener('place_changed', function () {
EventListenerModified(center, autocomplete);

});


//const input1 = document.getElementById('adress');

//map.controls[google.maps.ControlPosition.TOP_LEFT].push(input);
//  map.controls[google.maps.ControlPosition.TOP_LEFT].push(types);

//const autocompleteA = new google.maps.places.Autocomplete(input1);
//autocompleteA.addListener('place_changed', function () {
//    EventListenerModified(center, autocompleteA);
//});

//const input2 = document.getElementById('pac-input');
txt_addessindex = document.getElementById('pac-input');
//txt_addessindex = input2;
autocompleteindex = new google.maps.places.Autocomplete(txt_addessindex);
//const autocompleteB = new google.maps.places.Autocomplete(input2);
autocompleteindex.addListener('place_changed', function () {
EventListenerModified(center, autocompleteindex);
});

//for check nearest store
txt_address = document.getElementById('address2');
autocompleteNew = new google.maps.places.Autocomplete(txt_address);

autocompleteNew.addListener('place_changed', function () {
EventListener(center, autocompleteNew, "address");

});
}

function EventListenerModified(center, autocomplete) {

$('#loader').show();
var marker;
marker = new google.maps.Marker({
position: center
});
// marker.setMap(null);
place = autocomplete.getPlace();
$('#loader').show();
// let address = "";
if (place.address_components) {
address = [
(place.address_components[0] &&
place.address_components[0].short_name) ||
"",
(place.address_components[1] &&
place.address_components[1].short_name) ||
"",
(place.address_components[2] &&
place.address_components[2].short_name) ||
"",
(place.address_components[3] &&
place.address_components[3].short_name) ||
"",
(place.address_components[4] &&
place.address_components[4].short_name) ||
"",
(place.address_components[5] &&
place.address_components[5].short_name) ||
"",
(place.address_components[6] &&
place.address_components[6].short_name) ||
"",
(place.address_components[7] &&
place.address_components[7].short_name) ||
"",
].join(" ");
    var PostalCode = "";
    var unit = "";
    var street = "";
    var city = "";
    var state = "";

for (var i = 0; i < place.address_components.length; i++) {
for (var j = 0; j < place.address_components[i].types.length; j++) {

if (place.address_components[i].types[j] == "postal_code") {
PostalCode = place.address_components[i].long_name;

    }
    if (place.address_components[i].types[j] == "floor") {
        unit = place.address_components[i].long_name;

    }
    if (place.address_components[i].types[j] == "street_number") {
        street = place.address_components[i].long_name;

    }
    if (place.address_components[i].types[j] == "route") {
        street += place.address_components[i].long_name;

    }
    if (place.address_components[i].types[j] == "locality,political") {
        city = place.address_components[i].long_name;

    }
    if (place.address_components[i].types[j] == "administrative_area_level_1") {
        state = place.address_components[i].long_name;

    }
}
}
    }
    //alert(unit + ',' + street + ',' + city+',' +state+','+PostalCode);
//var newBounds = new google.maps.LatLngBounds();
// newBounds = bounds;
if (!place.geometry) {
$('#loader').hide();
$('#promo-modal').modal('show');
$('#promo-modal #lblMessage').html("<h4>Please select from the address choices from the list</h4>");
//window.alert(" Please select from the address choices from the list.");


return;
};
//marker.setPosition(place.geometry.location);
//marker.setMap(map);
//newBounds.extend(place.geometry.location);
//map.fitBounds(newBounds);

//map.setCenter(place.geometry.location);
//map.setZoom(17);

if (google.maps.geometry.poly.containsLocation(place.geometry.location, polygon)) {

var geocoder = new google.maps.Geocoder();

geocoder.geocode({ 'address': place.name + ' ' + address }, function (results, status) {
if (status == google.maps.GeocoderStatus.OK) {
var latitude = results[0].geometry.location.lat();
var longitude = results[0].geometry.location.lng();
ulat = latitude;
ulng = longitude;

UserAddress(place.name, address, latitude, longitude, "Valid", PostalCode,true);
$('#preAdd').hide();
$('#postAdd').show();
$('#phonemodal').modal('hide');
$('#loader').hide();
$('.loction-set').hide();
$("#map").html('');
var embed = "<iframe width='100%' height='180'; frameborder='0' style='border:0;' src = 'https://maps.google.com/maps?q=" + encodeURIComponent(latitude) + "," + encodeURIComponent(longitude) + "&amp;output=embed'></iframe>";
$('#map').html(embed);
}
});
} else {
var geocoder = new google.maps.Geocoder();

geocoder.geocode({ 'address': place.name + ' ' + address }, function (results, status) {
if (status == google.maps.GeocoderStatus.OK) {
newlat = results[0].geometry.location.lat();
newlong = results[0].geometry.location.lng();
latitude = newlat;
longitude = newlong;
GetStoresOutsideTradezone(latitude, longitude);
//GetNeareststoresforDelivery(latitude, longitude);
//GetNeareststoresforDelivery(newlat, newlat);
}
});
//$('#deliveryPrompt-modal').modal('show');

};

$('#loader').hide();

}



function guest() {
$('#loader').show();
$('#loginModal').modal('hide');
$('#loader').hide();
// window.location.href = 'checkout';
};


function showCart() {
$('#wrapper').removeClass('toggled');
$(".content_box .col-md-9").removeClass("hiddden-cart", 1000);
$(".col-md-3.cart").removeClass("none-d", 1000);
}

function hideCart() {
$('#wrapper').addClass('toggled');
$(".content_box .col-md-9").addClass("hiddden-cart", 1000);
$(".col-md-3.cart").addClass("none-d", 1000);
}

function showMap(ulat, ulng) {
//var center = new google.maps.LatLng(ulat, ulng);
//const map = new google.maps.Map(document.getElementById("map"), {
//    center: center,
//    zoom: 17,
//});


//bounds = new google.maps.LatLngBounds();
//google.maps.event.addListenerOnce(map, 'tilesloaded', function (evt) {
//    bounds = map.getBounds();
//});
polygon = new google.maps.Polygon({
path: area,
geodesic: true,
strokeColor: '#FFd000',
strokeOpacity: 1.0,
strokeWeight: 4,
fillColor: '#FFd000',
fillOpacity: 0.35
});

// polygon.setMap(map);


const card = document.getElementById("pac-card");
const input = document.getElementById("pac-input");
map.controls[google.maps.ControlPosition.TOP_RIGHT].push(card);
const autocomplete = new google.maps.places.Autocomplete(input); // Bind the map's bounds (viewport) property to the autocomplete object,
// so that the autocomplete requests use the current map bounds for the
// bounds option in the request.

autocomplete.bindTo("bounds", map); // Set the data fields to return when the user selects a place.


autocomplete.setFields(["address_components", "geometry", "icon", "name"]);
const infowindow = new google.maps.InfoWindow();
const infowindowContent = document.getElementById("infowindow-content");
infowindow.setContent(infowindowContent);
const marker = new google.maps.Marker({
map,
anchorPoint: new google.maps.Point(0, -29),
});
autocomplete.addListener("place_changed", () => {
//  ;
$('#loader').show();
infowindow.close();
marker.setVisible(true);
const place = autocomplete.getPlace();
var newBounds = new google.maps.LatLngBounds();
newBounds = bounds;
if (!place.geometry) {
// User entered the name of a Place that was not suggested and
// pressed the Enter key, or the Place Details request failed.
$('#promo-modal').modal('show');
$('#promo-modal #lblMessage').html('<h4>No details available for input: ' + place.name + '</h4>');
//window.alert("No details available for input: '" + place.name + "'");
return;
} // If the place has a geometry, then present it on a map.
marker.setPosition(place.geometry.location);
marker.setMap(map);
newBounds.extend(place.geometry.location);
map.fitBounds(newBounds);
if (google.maps.geometry.poly.containsLocation(place.geometry.location, polygon)) {
$("#LocationDetail").val("Valid");

} else {
$("#LocationDetail").val("NotValid");
$('#promo-modal').modal('show');
$('#promo-modal #lblMessage').html('<h4>Sorry! No store delivers to this location</h4>');
$('.add').val("");
// return;
};
if (place.geometry.viewport) {
map.fitBounds(place.geometry.viewport);
} else {
map.setCenter(place.geometry.location);
map.setZoom(12); // Why 17? Because it looks good.
}

marker.setPosition(place.geometry.location);
marker.setVisible(true);
let address = "";
if (place!=null&&place.address_components) {
address = [
(place.address_components[0] &&
place.address_components[0].short_name) ||
"",
(place.address_components[1] &&
place.address_components[1].short_name) ||
"",
(place.address_components[2] &&
place.address_components[2].short_name) ||
"",
(place.address_components[3] &&
place.address_components[3].short_name) ||
"",
(place.address_components[4] &&
place.address_components[4].short_name) ||
"",
(place.address_components[5] &&
place.address_components[5].short_name) ||
"",
(place.address_components[6] &&
place.address_components[6].short_name) ||
"",
(place.address_components[7] &&
place.address_components[7].short_name) ||
"",
].join(" ");
}

infowindowContent.children["place-icon"].src = place.icon;
infowindowContent.children["place-name"].textContent = place.name;
infowindowContent.children["place-address"].textContent = address;
infowindow.open(map, marker);
if (google.maps.geometry.poly.containsLocation(place.geometry.location, polygon)) {
var geocoder = new google.maps.Geocoder();

geocoder.geocode({ 'address': place.name + ' ' + address }, function (results, status) {


if (status == google.maps.GeocoderStatus.OK) {
var latitude = results[0].geometry.location.lat();
var longitude = results[0].geometry.location.lng();
ulat = latitude;
ulng = longitude;

UserAddress(place.name, address, latitude, longitude, "Valid");
$('#preAdd').hide();
$('#postAdd').show();
$('#loader').hide();
$('.loction-set').hide();
}
});
} else {
$('#loader').hide();
// alert('Sorry! No store delivers to this location');
$('.add').val("");
};

$('#loader').hide();

}); // Sets a listener on a radio button to change the filter type on Places
// Autocomplete.



}

$('#Apartmentnumber').on("change paste", function () {
$('#Apartmentnumber').append('<span style="color:red">Only 10 characters allowed for Apartment no.</span>');

});

function UserAddressData(Name, Address, latitude, longitude) {
var lat = latitude;
var lng = longitude;
var Apartmentnumber = "";
var DropOff = "";
var Dropopt = "";
$('#loader').show();
$.ajax({
type: 'get',
url: '/Index?handler=UserAddress&Name=' + Name + '&Address=' + Address + '&latitude=' + lat + '&longitude=' + lng + '&Apartmentnumber=' + Apartmentnumber + '&comment=' + DropOff + '&DropOff=' + Dropopt+'&PostalCode='+PostalCode,
data: null,
contentType: 'application/json;charset=utf-8',
dataType: 'json',

success: function (data) {
$('#loader').hide();
var URL = "index?OrderType=5";
location.href = URL

}
,
error: function (jqXHR, textStatus, errorThrown) {
$('#loader').hide();
if (jqXHR.status == 404 || errorThrown == 'Not Found') {
$('#promo-modal').modal('show');
$('#promo-modal #lblMessage').html('<h4>Oops something happened , please contact store directly</h4>');

setTimeout(function () {
$('#promo-modal').modal('hide');
location.href = "/WelcomePage";
}, 3000);

}
}
});
}
$("#btnupdateAddress").click(function () {
var name = $(".strname").html();
var address = $("#eidtUserAddress").html();
var latitude = $('#latitude').val();
var longitude = $('#longitude').val();
var Apartmentnumber = $('#Apartmentnumber').val();
var DropOff = $("#additional_drop_info").val();
var Dropopt = $("input[name='drop-option']:checked").val();
if (Apartmentnumber.length > 10) {
$("#spanapartmenterror").css('color', 'red');
return false;
}
else {
$("#spanapartmenterror").css('color', 'black');
}

if (DropOff.length > 32) {
$("#spandroperror").css('color', 'red');
return false;
}
else {
$("#spandroperror").css('color', 'black');
}
$.ajax({
type: 'get',
url: '/Index?handler=UserAddress',
data: { "Name": name, "Address": address, "latitude": latitude, "longitude": longitude, "Apartmentnumber": Apartmentnumber, "comment": DropOff, "DropOff": Dropopt},
contentType: 'application/json;charset=utf-8',
dataType: 'json',

success: function (data) {
    $("#location_trigger").html('');
    if (data.apartmentnumber != null) {
        $("#location_trigger").html(data.apartmentnumber + ' ' + data.name);
    }
    else {
        $("#location_trigger").html(data.name);
    }
$('.map-box').hide();
$('.loction-set .loction-inner').show();
$('.loction-set').hide();
$('#Apartmentnumber').val(data.apartmentnumber);
$("#additional_drop_info").val(DropOff);
    $('.loc-icon').attr('data-comment', DropOff);
    $('.loc-icon').attr('data-dropoff', Dropopt);
$('.loc-icon').attr('data-apartmentnumber', data.apartmentnumber);
//var URL = "index?OrderType=5";
//location.href = URL;
//location.reload();
},
error: function (jqXHR, textStatus, errorThrown) {
if (jqXHR.status == 404 || errorThrown == 'Not Found') {
$('#promo-modal').modal('show');
$('#promo-modal #lblMessage').html('<h4>Oops something happened , please contact store directly</h4>');

setTimeout(function () {
$('#promo-modal').modal('hide');
location.href = "/WelcomePage";
}, 3000);
}
}


});
});

    function CheckDelivery(modal, modalprice) {

        $(":checkbox").attr("checked", false);
        $('.dropdown_item').removeClass('open');
        $('.dropdown_items').hide();
        $(":checkbox").attr("disabled", false);
        var productmodalid = modal.split('-')[1];

        $('.loction-set').hide();
        if (3 == 5 || 3 == 5) {

            $(function () {
                $.getJSON('/Index?handler=LatLong', function (data) {

                    if (data == "") {
                        $('#deliveryaddressmodal').modal({ backdrop: 'static', keyboard: false });
                        $('#deliveryaddressmodal').modal('show');
                    }
                    else {

                        $('#' + modal).modal('show');
                        $('.ChangePrice-' + productmodalid).html(modalprice);
                    }
                });
            });

        }
        else if (3 == 0 && 3 == 0 && 'False' == 'False' && 'False'=='True') {
            $('#loader').show();
            $(function () {
                $.getJSON('/Index?handler=StoreOnlinestatus', function (data) {
                    $('#loader').hide();
                    if (data == "Success") {
                        $(function () {
                            $.getJSON('/Index?handler=DineInGuestdetail', function (data) {

                                if (data == "") {
                                    $('#DineInGuestmodal').modal('show');
                                }
                                else {

                                    $('#' + modal).modal('show');
                                    $('.ChangePrice-' + productmodalid).html(modalprice);
                                }
                            });
                        });
                    }
                    else {
                        $('#pay-modal').modal('show');
                        $('#pay-modal #lblPayMessage').html('<h4>Store is closed</h4>');

                    }
                });
            });

        }
        else if (3 == 0 && 3 == 0 && 'False'== 'False') {
            $('#loader').show();
            $(function () {
                $.getJSON('/Index?handler=StoreOnlinestatus', function (data) {
                    $('#loader').hide();
                    if (data != "Success") {
                        $('#pay-modal').modal('show');
                        $('#pay-modal #lblPayMessage').html('<h4>Store is closed</h4>');
                    }
                    else {
                        $('#' + modal).modal('show');
                        $('.ChangePrice-' + productmodalid).html(modalprice);
                    }
                });
            });

        }
        else {
            $('#' + modal).modal('show');
            $('.ChangePrice-' + productmodalid).html(modalprice);
        }
    }

            function Checkout() {

                $.ajax({
                    type: 'get',
                    url: '/Index?handler=CheckForUpsell',
                    data: null,
                    async: false,
                    contentType: 'application/json;charset=utf-8',
                    dataType: 'json',
                    success: function (data) {

                        if (data == 0 || data.html == 0) {
                            if ($('#date_trigger').text().trim() == 'Schedule Order') {
                                $('#selectdate').modal('show');
                                $("#CheckConditions").val("selectdateModel");
                                return;
                            }

$(function () {
$.getJSON('/Index?handler=CheckStoretiming', function (data) {
if (data == "false") {
location.reload();
 }
else {
Logincheckout()
}
 });
 });
                        }
                        else {
                            $('#loader').hide();
                            $('#upsellbody').html('');
                            $('#upsellname').html(data.name);
                            $('#upsellbody').append(data.html);
                            $('#Upsellmodal').modal('show');
                        }
                    }
                });


            }

    function LoginDineincheckout() {
        $('#loader').show();
                $.ajax({
                    type: 'get',
                    url: '/Index?handler=UserLogin',
                    data: null,
                    contentType: 'application/json;charset=utf-8',
                    dataType: 'json',

                    success: function (data) {
                        // ;
                        if (data == '0') {
                            $('#loader').hide();
                            $('#CheckoutloginModal').modal('show');
                        }
                        //location.href = "/SignIn";
                        else {
                            window.top.location = "checkout";
                        }



                    },
                    error: function (jqXHR, textStatus, errorThrown) {
                        $('#loader').hide();
                        if (jqXHR.status == 404 || errorThrown == 'Not Found') {
                            $('#promo-modal').modal('show');
                            $('#promo-modal #lblMessage').html('<h4>Oops something happened , please contact store directly</h4>');

                            setTimeout(function () {
                                $('#promo-modal').modal('hide');
                                location.href = "/WelcomePage";
                            }, 3000);
                        }
                    }

                });

            }
            function Logincheckout() {
                $.ajax({
                    type: 'get',
                    url: '/Index?handler=UserLogin',
                    data: null,
                    contentType: 'application/json;charset=utf-8',
                    dataType: 'json',

                    success: function (data) {
                        // ;
                        if (data == '0') {

                            $('#CheckoutloginModal').modal('show');
                        }
                            else if(data!='1' &&  data.split('-').length == 2 &&  data.split('-')[0]=='2')
                        {
                            SubmitGroupOrder(data.split('-')[1]);
                        }
                        else
                            window.top.location = "checkout";

                        $('#loader').hide();

                    },
                    error: function (jqXHR, textStatus, errorThrown) {
                        if (jqXHR.status == 404 || errorThrown == 'Not Found') {
                            $('#promo-modal').modal('show');
                            $('#promo-modal #lblMessage').html('<h4>Oops something happened , please contact store directly</h4>');

                            setTimeout(function () {
                                $('#promo-modal').modal('hide');
                                location.href = "/WelcomePage";
                            }, 3000);
                        }
                    }

                });

            }

function Login() {
$.ajax({
type: 'get',
url: '/Index?handler=UserLogin',
data: null,
contentType: 'application/json;charset=utf-8',
dataType: 'json',

success: function (data) {
// ;
if (data == '0')
$('#loginModal').modal('show');
//location.href = "/SignIn";
else
window.top.location = "checkout";

$('#loader').hide();

},
error: function (jqXHR, textStatus, errorThrown) {
if (jqXHR.status == 404 || errorThrown == 'Not Found') {
$('#promo-modal').modal('show');
$('#promo-modal #lblMessage').html('<h4>Oops something happened , please contact store directly</h4>');

setTimeout(function () {
$('#promo-modal').modal('hide');
location.href = "/WelcomePage";
}, 3000);
}
}

});

}
</script>
<script>
    function CalcUpsellPlus(itemId,price) {
        var qtyId = '#upsellqty_' + itemId;
        var checkboxid = "#AddUpsell_" + itemId;
        var priceid = ".item_price" + itemId;
        //$(checkboxid).prop('checked', true);
        var qty = parseInt($(qtyId).val());

        qty = qty + 1;
        var count = 0;
        var totalCount = 0;
        if ($('#RequiredUpsellQuantity').length > 0) {
            totalCount = parseInt($('#RequiredUpsellQuantity').text());
        }

        if (qty < 0) {
            price = parseFloat(price).toFixed(2);
            $(priceid).html('$' + price);
            $(qtyId).val(0);
        }

       else if (qty == 0) {
            price = parseFloat(price).toFixed(2);
            $(priceid).html('$' + price);
            $(qtyId).val(0);
        } else if (qty != 99) {

            $(qtyId).val(qty);
            price = parseFloat(price * qty).toFixed(2);
            $(priceid).html('$' + price);
        }
        $.each($('[id^="upsellqty_"]'), function () {
            if (parseInt($(this).val()) > 0) {
                count++;
            }
        });
        if (count >= totalCount && totalCount!=0) {
            $.each($('[id^="upsellqty_"]'), function () {
                if (parseInt($(this).val()) == 0) {
                    $(this).parent().parent().addClass('div-disabled');
                }
            });
        }
        else if (count > 0) {
            $('#UpsellAddToCart').removeClass('disable');
            $('.div_qty').removeClass('div-disabled');
        }
        else {
            $('.ProductRow').removeClass('div-disabled');
        }
    }

    function CalcUpsellMinus(itemId, price) {

        var qtyId = '#upsellqty_' + itemId;
        var checkboxid = "#AddUpsell_" + itemId;
        //$(checkboxid).prop('checked', true);
        var priceid = ".item_price" + itemId;
        var qty = parseInt($(qtyId).val()) == 0 ? 1 : parseInt($(qtyId).val());
        qty = qty - 1;
        var count = 0;
        //var totalCount = parseInt($('#RequiredUpsellQuantity').text());
        var totalCount = 0;
        if ($('#RequiredUpsellQuantity').length > 0) {
            totalCount = parseInt($('#RequiredUpsellQuantity').text());
        }
        if (qty > 0) {

            $(qtyId).val(qty);
            price = parseFloat(price * qty).toFixed(2);
            $(priceid).html('$' + price);
        }

        else if (qty <= 0 || qty=='' || qty=='undefined') {
            $(qtyId).val(0);
            price = parseFloat(price).toFixed(2);
            $(priceid).html('$' + price);
        }
        else {

        }
        $.each($('[id^="upsellqty_"]'), function () {
            if (parseInt($(this).val()) > 0) {
                count++;
            }
        });
        if (count >= totalCount && totalCount != 0) {
            $.each($('[id^="upsellqty_"]'), function () {
                if (parseInt($(this).val()) == 0) {
                    $(this).parent().parent().addClass('div-disabled');
                }
            });
        }
        else if (count > 0) {
            $('#UpsellAddToCart').removeClass('disable');
            $('.div_qty').removeClass('div-disabled');
        }
        else {
            //$('#UpsellAddToCart').addClass('disable');//Jira : QOVER2- 2243 removed disable class
            $('.div_qty').removeClass('div-disabled');
        }
    }

    $(document).on('blur', '[id^="upsellqty_"]', function () {
        //var qtyId = $(this).attr('id');
        var itemId = $(this).attr('id').split('_')[1];
        var qtyId = '#upsellqty_' + itemId;
        var checkboxid = "#AddUpsell_" + itemId;
        var priceid = ".item_price" + itemId;
        //$(checkboxid).prop('checked', true);
        var qty = parseInt($(qtyId).val());
        var price = $(this).parent().parent().parent().find('.item_price' + itemId).attr('default-price');
        //qty = qty + 1;
        var count = 0;
        //var totalCount = parseInt($('#RequiredUpsellQuantity').text());
        var totalCount = 0;
        if ($('#RequiredUpsellQuantity').length > 0) {
            totalCount = parseInt($('#RequiredUpsellQuantity').text());
        }
        if (qty < 0) {
            price = parseFloat(price).toFixed(2);
            $(priceid).html('$' + price);
            $(qtyId).val(0);
        }

       else if (qty == 0) {
            price = parseFloat(price).toFixed(2);
            $(priceid).html('$' + price);
            $(qtyId).val(0);
        } else if (qty != 99) {

            $(qtyId).val(qty);
            price = parseFloat(price * qty).toFixed(2);
            $(priceid).html('$' + price);
        }
        $.each($('[id^="upsellqty_"]'), function () {
            if (parseInt($(this).val()) > 0) {
                count++;
            }
        });
        if (count >= totalCount && totalCount!=0) {
            $.each($('[id^="upsellqty_"]'), function () {
                if (parseInt($(this).val()) == 0) {
                    $(this).parent().parent().addClass('div-disabled');
                }
            });
        }
        else if (count > 0) {
            $('#UpsellAddToCart').removeClass('disable');
            $('.div_qty').removeClass('div-disabled');
        }
        else {
             //$('#UpsellAddToCart').addClass('disable'); //Jira : QOVER2- 2243 removed disable class
            $('.ProductRow').removeClass('div-disabled');
        }
    });

    function SendOrderCheckoutUpsell() {

        var ItemId = '';
        var count = 0;
        var totalCount = parseInt($('#RequiredUpsellQuantity').text());
        $('#loader').show();
        $.each($('[id^="upsellqty_"]'), function () {
            if (parseInt($(this).val()) > 0) {
                count++;
            }

        });
        if (count == 0) {
            $('#loader').hide();
            $('#CheckoutErrorMsgUpsell').html('Please select minimum 1 product.');
            return false;
        }
        else if (count > totalCount) {
            $('#loader').hide();
            $('#CheckoutErrorMsgUpsell').html('Please do not select required products more than maximum choices');
            return false;
        }
        else {
            $('#CheckoutErrorMsgUpsell').html('');
            $.when(AddUpsellCheckout()).done(function () {
                $('#loader').hide();
                //$('#Upsellmodal').modal('hide');
                //location.reload();
            });
        }
    }
    function AddUpsellCheckout() {
        var IdList = [];
        var NameList = [];
        var ItemQtyList = [];
        var PriceList = [];
        $.each($('[id^="upsellqty_"]'), function () {
            if (parseInt($(this).val()) > 0) {

                var id = $(this).attr('id').split('_')[1];
                IdList.push(($(this).attr('id').split('_'))[1]);
                NameList.push($('#product-name' + id).html());
                var itemqtyid = '#upsellqty_' + id;
                ItemQtyList.push($(itemqtyid).val());
                var priceid = ".item_price" + id;
                PriceList.push($(priceid).attr('default-Price'));
            }

        });
            $('#CheckoutErrorMsgUpsell').html('');
            $.ajax({
                type: 'get',
                url: '/Index?handler=TakeoutAddUpsellProduct&ItemId=' + IdList + '&ItemName=' + NameList + '&Itemqty=' + ItemQtyList + '&Itemprice=' + PriceList,
                data: null,
                dataType: 'html',
                async: false,
                success: function (data) {
                    $('#Upsellmodal').modal('hide');
                    if (JSON.parse(data).msg == 1 && JSON.parse(data).cart != null) {
                        $('#loader').show();
                        var cart = JSON.parse(data).cart;
                        AddUpsellItemstocart(JSON.parse(cart));
                        // location.reload();
                        return true;

                    }
                    else {
                        $('#loader').show();
                        location.reload();
                        return true;
                    }
                   // if (data == 1) { $('#Upsellmodal').modal('hide'); location.reload(); }

                }
            });

 }

            function AddUpsellItemstocart(cart) {
                var cart = cart;
                $('.cart_items').remove();
                var currency='$';
                var CartItems = cart.cartItems;
                var qty = 0;
                var html = '';
                for (var j = 0; j < CartItems.length; j++) {
                    var allmodifierPrice = 0;
                    qty += CartItems[j].qty;
                    if (CartItems[j].isSent == false) {
                        flag = true;
                        html += "<tr class='cart_items' id='row_" + CartItems[j].cartItemId + "'><td class='cart_qty'>" + CartItems[j].qty + " ×</td><td class='cart_name'><span class='cart_title'>" + CartItems[j].itemName + "</span>";
                    }
                    else {
                        _issent = true;
                        html += "<tr class='cart_items oldrow' id='row_" + CartItems[j].cartItemId + "'><td class='cart_qty'>" + CartItems[j].qty + " ×</td><td class='cart_name'><span class='cart_title'>" + CartItems[j].itemName + "</span>";
                    }
                    html += "<span class='cart_info'>";
                    if (CartItems[j].modifiers != null && CartItems[j].modifiers.length > 0) {
                        html += "<br />";
                        for (var k = 0; k < CartItems[j].modifiers.length; k++) {
                            html += "<label> •" + CartItems[j].modifiers[k]._modName + "</label >";
                            allmodifierPrice = allmodifierPrice + CartItems[j].modifiers[k].price;

                            if (CartItems[j].modifiers[k].subMOD != null && CartItems[j].modifiers[k].subMOD.length > 0) {
                                var submodifiersList = CartItems[j].modifiers[k].subMOD;
                                for (var p = 0; p < submodifiersList.length; p++) {
                                    html += "<label> •" + submodifiersList[p]._modName + "</label >";
                                    allmodifierPrice = allmodifierPrice + submodifiersList[p].price;
                                }
                            }
                        }
                        if (CartItems[j].specialInst != "" && CartItems[j].specialInst != null) {
                            html += "<br /><label><i> •" + CartItems[j].specialInst + "</i></label>";
                        }

                    }
                    else {
                        if (CartItems[j].specialInst != "" && CartItems[j].specialInst != null) {
                            html += "<br /><label><i> •" + CartItems[j].specialInst + "</i></label>";
                        }
                    }
                    html += "</span>";
                    if (CartItems[j].isSent == false) {
                        html += "<br /> <a id='" + CartItems[j].cartItemId + "' href='javascript:Remove(\"" + CartItems[j].cartItemId + "\")' class='remove_item'>Remove</a>";
                    }
                    if (CartItems[j].modifiers == null || CartItems[j].modifiers.length == 0) {
                        html += " </td > <td class='cart_price'>" + currency + "" + (CartItems[j].itemPrice * CartItems[j].qty).toFixed(2) + "</td></tr> ";
                    }
                    else {
                        html += " </td > <td class='cart_price'>" + currency + "" + (parseFloat(CartItems[j].itemPrice * CartItems[j].qty) + parseFloat(allmodifierPrice * CartItems[j].qty)).toFixed(2) + "</td></tr> ";
                    }
                }
                $('.qty').text(qty);
                $('#tblCart').append(html);
                $('#loader').hide();
    }

    $(document).on('click', '#SkipUpsell', function () {
        var type = $(this).attr('methodfor');
        $.ajax({
            type: 'get',
            url: '/Checkout?handler=SkipUtensils&Type=' + type,
            data: null,
            dataType: 'json',
            success: function (data) {
                $('#Upsellmodal').modal('hide');
                //$('#div-Utensil').html('');
                //$('#div-Utensil').show();
                //var html = '';
                //html += '<label class="col-sm-2 col-form-label"><strong>UTENSILS</strong></label>';
                //html += '<div class="col-sm-10  div-Customoffer" onclick="ShowUtensilModal()">';
                //html += '<p class="offerlabel pt-2"><span style="color:red;cursor:pointer">Wants to add utensils?</span></p>';
                //html += '</div>';
                //$('#div-Utensil').append(html);
            }
        });
    });
</script>
<script>

    $(document).ready(function () {


var statusStore = 'No Menu found for this time';
    if (statusStore != 'Success' && statusStore != '') {
        if (statusStore == 'No Connection With Pos') {
            $('#promo-modal').modal('show');
            $('#promo-modal #lblMessage').html('<h4>Please Contact Staff!</h4>');
            $('body').css('z-index', 999999);

        }
        else {
            $('#promo-modal').modal('show');
            $('#promo-modal #lblMessage').html('<h4>' + statusStore + '</h4>');
            $('body').css('z-index', 999999);
        }

}

});

</script>
<script>
    $("#btn_getcheckDetails").on('click', function () {
        var phnum = $("#txt_phn").val();
        var _numericpattern = /^\d*$/;
        $(".error").remove();
        if (phnum == "") {
            $('#txt_phn').after('<span class="error">Enter Phone number</span>');
            $('#txt_phn').addClass('invalid');
            return false;
        }
        else if (!_numericpattern.test(phnum)) {
            $('#txt_phn').after('<span class="error">Enter valid Phone number</span>');
            $('#txt_phn').addClass('invalid');
            return false;
        }
        else if (phnum.length != "10") {
            $('#txt_phn').after('<span class="error">Enter 10 digit Phone number</span>');
            $('#txt_phn').addClass('invalid');
            return false;
        }
        else {
            $('#txt_phn').removeClass('invalid');
            $('#loader').show();
            $.ajax({
                type: 'get',
                url: '/Index?handler=OpenCheckSummaryDetail&Phonenumber=' + phnum,
                data: null,
                contentType: 'application/json;charset=utf-8',
                dataType: 'json',
                success: function (data) {

                    if (data == "No Check") {
                        alert(data);
                        $('#loader').hide();
                       // $('#Phonenumber_Modal').modal('hide');
                       $('#DineInGuestmodal').modal('show');
                        $('#Phonenumber_Modal #lbl_error').html('Order not found, please try another phone number. (gcd index)');

                    }
                    else if (data == "Partial Payment") {
                        $('#loader').hide();
                        $('#btn_getcheckDetails').hide();
                        $('#btn_SavePhoneNumber').hide();
                        $('#btn_RedirectQRCode').show();
                        $('#Phonenumber_Modal #lbl_error').html('Check is already tendered, Please contact staff!');
                    }
                    else if (data == "Pos OFF") {
                        $('#loader').hide();
                        $('#Phonenumber_Modal #lbl_error').html('Please contact staff!');
                    }
                    else if (data != "") {
                        $('#loader').show();
                        $('#Phonenumber_Modal').modal('hide');
                        var ordertype = '0';
                        window.location = '/index?OrderType=' + ordertype;

                }
                else {
            $('#loader').hide();
            $('#Phonenumber_Modal').modal('hide');
            $('#promo-modal').modal('show');
            $('#promo-modal #lblMessage').html('<h4>Oops! Something happend, Contact Store Directly</h4>');
        }
            }
        });

    }


     });
    var isAllGuestItemAdded = false;
    var isOrderSend = false;
    function CheckAllGuestItems() {
        isAllGuestItemAdded = false;
        if (isOrderSend == false) {
            $.ajax({
                type: 'get',
                url: '/Index?handler=IsAllGuestItemsAdded',
                data: null,
                async: false,
                contentType: 'application/json;charset=utf-8',
                dataType: 'json',
                success: function (data) {



                    if (data.status == 'false') {

                        isAllGuestItemAdded = true;
                        $('#MessagePopUp-modal').modal('show');
                        $('#MessagePopUp-modal #lbl_message').html('No items added for ' + data.name + ', Do you want to proceed!');
                        return false;
                    }
                    else {
                        isAllGuestItemAdded = false;
                        return true;
                    }

                }
            });
        }
        else {
            return true;
        }
    }

    var IsPreAuthEnabled = false;
    function SendOrder() {
        $('#MessagePopUp-modal').modal('hide');
        $('#loader').show();

        $.when(CheckAllGuestItems()).done(
            function () { });

        if ( isAllGuestItemAdded==true) {
            return false;
        }
        else {
            $.ajax({
                type: 'get',
                url: '/Index?handler=CheckForUpsell',
                data: null,
                async: false,
                contentType: 'application/json;charset=utf-8',
                dataType: 'json',
                success: function (data) {

                    if (data == 0 || data.html == 0) {
                        if ($('#date_trigger').text().trim() == 'Schedule Order') {
                            $('#loader').hide();
                            $('#selectdate').modal('show');
                            $("#CheckConditions").val("selectdateModel");
                            return;
                        }

                        else {

                            $.when(isPreauthoriseEnabled()).done(
                                function () {

                                    if (IsPreAuthEnabled == true) {
                                        PreauthLogin(data);
                                    }
                                    else {

                                        $(function () {
                                            $.ajax({
                                                type: 'get',
                                                url: '/Index?handler=SendOrder&isOrderSent=1',
                                                data: null,
                                                contentType: 'application/json;charset=utf-8',
                                                dataType: 'json',
                                                success: function (data) {
                                                    var html = '';
                                                    if (data == "Pos OFF") {
                                                        $('#promo-modal').modal('show');
                                                        $('#pay-modal .Dinein-close').hide();
                                                        $('#promo-modal #lblMessage').html('<h4>Please Contact Staff!</h4>');
                                                        $('body').css('z-index', 999999);
                                                    }
                                                    else if (data == "Check Open") {
                                                        $('#pay-modal').modal('show');
                                                        $('#pay-modal .Dinein-close').hide();
                                                        $('#pay-modal #lblPayMessage').html('<h4>Check open on POS</h4>');
                                                        $('body').css('z-index', 999999);
                                                    }
                                                    else if (data == "Check is closed") {
                                                        $('#Checkclose-modal').modal('show');
                                                        $('#pay-modal .Dinein-close').hide();
                                                        $('body').css('z-index', 999999);
                                                    }
                                                    else if (data == "") {
                                                        $('#OrderfailedModal').modal('show');
                                                        $('#OrderfailedModal #Modelordersummary').html('');
                                                        $('#pay-modal .Dinein-close').hide();
                                                        $('#OrderfailedModal #labelMessage').html('<h4>Order Sending failed</h4>');
                                                    }
                                                    else {
                                                        var cart = JSON.parse(data);
                                                        if (cart.OrderNo != null) {
                                                            $('#pay-modal').modal('show');
                                                            $('#pay-modal .Dinein-close').show();
                                                            if (cart.orderstatus == "Update") {
                                                                $('#lblPayMessage').html('<h4>' + cart.DineInOrderMessage + '</h4>');
                                                                 $('#payModalheader').html('Order Confirmation');
                                                                // $('#lblPayMessage').html('<h4>Order Updated on POS , Order #' + cart.OrderNo + '</h4>');

                                                            }
                                                            else {
                                                                $('#lblPayMessage').html('<h4>' + cart.DineInOrderMessage + '</h4>');
                                                                 $('#payModalheader').html('Order Confirmation');
                                                                // $('#lblPayMessage').html('<h4>Order created on POS , Order #' + cart.OrderNo + '</h4>');
                                                            }

                                                        }
                                                        else {
                                                            var ordermessage = "";
                                                            var successflag = true;
                                                            if (cart.SplitCheck.Guestusers.length > 0) {
                                                                for (var i = 0; i < cart.SplitCheck.Guestusers.length; i++) {
                                                                    if (cart.SplitCheck.Guestusers[i].orderstatus == "Success") {
                                                                        ordermessage = "Success";
                                                                        if (cart.SplitCheck.Guestusers[i].OrderNo != null || cart.SplitCheck.Guestusers[i].OrderNo != '') {
                                                                            html += '<p>' + cart.SplitCheck.Guestusers[i].DineInOrderMessage + '</p>';

                                                                        }
                                                                        if (cart.SplitCheck.Guestusers.length == 1) {
                                                                            //$('#pay-modal').modal('show');
                                                                            $('#pay-modal .Dinein-close').hide();
                                                                            $('#pay-modal').modal({ backdrop: 'static', keyboard: false }, { backdrop: 'static', keyboard: false });
                                                                            $('#pay-modal #ordersummary').html(html);
                                                                        }
                                                                        else {
                                                                            // $('#pay-modal').modal('show');
                                                                            $('#pay-modal .Dinein-close').hide();
                                                                            $('#pay-modal').modal({ backdrop: 'static', keyboard: false }, { backdrop: 'static', keyboard: false });
                                                                            $('#pay-modal #ordersummary').html(html);
                                                                        }
                                                                    }
                                                                    else if (cart.SplitCheck.Guestusers[i].orderstatus == "Update") {
                                                                        successflag = false;
                                                                        ordermessage = "Success";
                                                                        if (cart.SplitCheck.Guestusers[i].OrderNo != null || cart.SplitCheck.Guestusers[i].OrderNo != '') {
                                                                            html += '<p>' + cart.SplitCheck.Guestusers[i].DineInOrderMessage + '</p>';

                                                                        }
                                                                        //$('#pay-modal').modal('show');
                                                                        $('#pay-modal .Dinein-close').hide();
                                                                        $('#btn_qrcode').hide();

                                                                        $('#pay-modal #ordersummary').html(html);


                                                                    }
                                                                    else {

                                                                        if (cart.SplitCheck.Guestusers[i].guestcartItems.length != 0) {
                                                                            html += '<p>Order Sending failed for ' + cart.SplitCheck.Guestusers[i].Name + '</p>';
                                                                        }
                                                                        // $('#pay-modal').modal('show');
                                                                        $('#pay-modal .Dinein-close').hide();
                                                                        if (cart.SplitCheck.Guestusers.length == 1) {
                                                                            successflag = false;
                                                                            $('#btn_qrcode').hide();
                                                                        }

                                                                        $('#pay-modal #ordersummary').html(html);

                                                                    }

                                                                }
                                                            }
                                                            if (ordermessage == "") {
                                                                $('#OrderfailedModal').modal('show');
                                                                $('#OrderfailedModal #Modelordersummary').html(html);
                                                                $('#pay-modal #ordersummary').html('');
                                                            }
                                                            else {
                                                                $('#pay-modal').modal('show');

                                                                if (successflag == false) {
                                                                    $('#p_scanQRCode').hide();

                                                                    $('#pay-modal').modal({ keyboard: true });
                                                                    $('#pay-modal .Dinein-close').hide();
                                                                    $('#btn_qrcode').hide();

                                                                }
                                                                else {
                                                                    $('#p_scanQRCode').show();
                                                                    $('#pay-modal').modal({ backdrop: 'static', keyboard: false });
                                                                    $('#pay-modal .Dinein-close').hide();
                                                                    $('#btn_qrcode').show();
                                                                    $('#btn_closephonemodal').hide();

                                                                }
                                                            }

                                                        }
                                                    }
                                                    $('#loader').hide();
                                                }
                                            });
                                        });
                                    }
                                });
                        }

                    }
                    else {
                        $('#loader').hide();
                        $('#upsellbody').html('');
                        $('#upsellname').html(data.name);
                        $('#upsellbody').append(data.html);
                        $('#Upsellmodal').modal('show');
                    }
                }
            });
        }

    }

    function SendOrderUpsell() {

        $.when(AddUpsell()).done(function () {
            $('#loader').show();
            $.ajax({
                type: 'get',
                url: '/Index?handler=CheckForUpsell',
                data: null,
                async: false,
                contentType: 'application/json;charset=utf-8',
                dataType: 'json',
                success: function (data) {

                    if (data == 0 || data.html == 0) {
                        if ($('#date_trigger').text().trim() == 'Schedule Order') {
                            $('#loader').hide();
                            $('#selectdate').modal('show');
                            $("#CheckConditions").val("selectdateModel");
                            return;
                        }

                        else {
                            $(function () {
                                $('#Upsellmodal').modal('hide');
                                $('#loader').show();
                                $.ajax({
                                    type: 'get',
                                    url: '/Index?handler=SendOrder&isOrderSent=1',
                                    data: null,
                                    contentType: 'application/json;charset=utf-8',
                                    dataType: 'json',
                                    success: function (data) {
                                        var html = '';

                                        if (data == "Pos OFF") {


                                            $('#promo-modal').modal('show');
                                            $('#promo-modal #lblMessage').html('<h4>Please Contact Staff!</h4>');
                                            $('body').css('z-index', 999999);
                                        }
                                        else if (data == "Check Open") {
                                            $('#pay-modal .Dinein-close').hide();
                                            $('#pay-modal').modal('show');
                                            $('#pay-modal #lblPayMessage').html('<h4>Check open on POS</h4>');
                                            $('body').css('z-index', 999999);
                                        }
                                        else if (data == "Check is closed") {
                                            $('#Checkclose-modal').modal('show');
                                            $('#pay-modal .Dinein-close').hide();
                                            $('body').css('z-index', 999999);
                                        }
                                        else if (data == "") {
                                            $('#OrderfailedModal').modal('show');
                                            $('#OrderfailedModal #Modelordersummary').html('');
                                            $('#pay-modal .Dinein-close').hide();
                                            $('#OrderfailedModal #labelMessage').html('<h4>Order Sending failed</h4>');
                                        }
                                        else {

                                            var cart = JSON.parse(data);
                                            if (cart.OrderNo != null) {
                                                $('#pay-modal').modal('show');
                                                $('#pay-modal .Dinein-close').show();
                                                if (cart.orderstatus == "Success") {
                                                    $('#lblPayMessage').html('<h4>' + cart.DineInOrderMessage + '</h4>');
                                                     $('#payModalheader').html('Order Confirmation');
                                                    // $('#lblPayMessage').html('<h4>Order created on POS , Order #' + cart.OrderNo + '</h4>');
                                                }
                                                else {
                                                    $('#lblPayMessage').html('<h4>' + cart.DineInOrderMessage + '</h4>');
                                                    $('#payModalheader').html('Order Confirmation');
                                                    // $('#lblPayMessage').html('<h4>Order Updated on POS , Order #' + cart.OrderNo + '</h4>');
                                                }


                                            }
                                            else {

                                                if (cart.SplitCheck.Guestusers.length > 0) {
                                                    for (var i = 0; i < cart.SplitCheck.Guestusers.length; i++) {
                                                        if (cart.SplitCheck.Guestusers[i].orderstatus == "Success") {
                                                            if (cart.SplitCheck.Guestusers[i].OrderNo != null || cart.SplitCheck.Guestusers[i].OrderNo != '') {
                                                                html += '<p>' + cart.SplitCheck.Guestusers[i].DineInOrderMessage + '</p>';
                                                                //html += '<p>Order created on POS for guest ' + parseInt(i + 1) + ', Order no #' + cart.SplitCheck.Guestusers[i].OrderNo + '</p>';
                                                            }
                                                        }
                                                        else if (cart.SplitCheck.Guestusers[i].orderstatus == "Update") {
                                                            if (cart.SplitCheck.Guestusers[i].OrderNo != null || cart.SplitCheck.Guestusers[i].OrderNo != '') {
                                                                html += '<p>' + cart.SplitCheck.Guestusers[i].DineInOrderMessage + '</p>';
                                                                //html += '<p>Order updated on POS for guest ' + parseInt(i + 1) + ', Order no #' + cart.SplitCheck.Guestusers[i].OrderNo + '</p>';
                                                            }
                                                        }
                                                        else {
                                                            if (cart.SplitCheck.Guestusers[i].guestcartItems.length != 0) {
                                                                html += '<p>Order Sending failed for guest ' + parseInt(i + 1) + '</p>';
                                                            }
                                                            //else{
                                                            //    html += '<p>Order Sending failed for guest ' + parseInt(i + 1) + '</p>';
                                                            //}
                                                        }

                                                    }
                                                }
                                                $('#pay-modal').modal('show');
                                                $('#pay-modal #ordersummary').html(html);
                                                $('#pay-modal .Dinein-close').hide();
                                                //setTimeout(function () {
                                                //    $('#pay-modal').modal('hide');

                                                //    location.reload();
                                                //}, 3000);
                                            }
                                        }
                                        $('#loader').hide();
                                    }
                                });
                            });
                        }

                    }
                    else {
                        $('#loader').hide();
                        $('#upsellbody').html('');
                        $('#upsellname').html(data.name);
                        $('#upsellbody').append(data.html);
                        $('#Upsellmodal').modal('show');
                    }
                }
            });
        });

    }

    $("#btn_closephonemodal,.Dinein-close").on('click', function () {
        location.reload();
    });
    $("#btn_closephonemodalenabledine,#btn_closephonemodalenable").on('click', function () {
        $('#OrderfailedModal').modal('hide');
    });
</script>
<script>
    function isPreauthoriseEnabled() {
        return $.get(
            '/Index?handler=CheckForPreauth',
            function (data) {

                if (data == '0') {
                    IsPreAuthEnabled = false;
                    return IsPreAuthEnabled;
                }
                else {
                    IsPreAuthEnabled = true;
                    return IsPreAuthEnabled;
                }

            }
        );
    }
    function Login2() {
        $.ajax({
            type: 'get',
            url: '/Index?handler=UserLogin',
            data: null,
            contentType: 'application/json;charset=utf-8',
            dataType: 'json',

            success: function (data) {
                // ;
                if (data == '0')
                    $('#loginModal').modal('show');
                //location.href = "/SignIn";
                else {
                    $(function () {
                        $.ajax({
                            type: 'get',
                            url: '/Index?handler=SendOrder&isOrderSent=1',
                            data: null,
                            contentType: 'application/json;charset=utf-8',
                            dataType: 'json',
                            success: function (data) { if (data != 'Failed') location.reload(); }
                        });
                    });
                }

                $('#loader').hide();

            }
        });

    }
    function PreauthLogin() {
        $.ajax({
            type: 'get',
            url: '/Index?handler=PreAuthUserLogin',
            data: null,
            contentType: 'application/json;charset=utf-8',
            dataType: 'json',

            success: function (data1) {

                if (data1 == '0') {
                    $(function () {
                        $(function () {

                            $.ajax({
                                type: 'get',
                                url: '/Index?handler=SendOrder&isOrderSent=1',
                                data: null,
                                contentType: 'application/json;charset=utf-8',
                                dataType: 'json',
                                success: function (data) {
                                    var html = '';
                                    if (data == "Pos OFF") {
                                        $('#promo-modal').modal('show');
                                        $('#pay-modal .Dinein-close').hide();
                                        $('#promo-modal #lblMessage').html('<h4>Please Contact Staff!</h4>');
                                        $('body').css('z-index', 999999);
                                    }
                                    else if (data == "Check Open") {
                                        $('#pay-modal').modal('show');
                                        $('#pay-modal .Dinein-close').hide();
                                        $('#pay-modal #lblPayMessage').html('<h4>Check open on POS</h4>');
                                        $('body').css('z-index', 999999);
                                    }
                                    else if (data == "Check is closed") {
                                        $('#Checkclose-modal').modal('show');
                                        $('#pay-modal .Dinein-close').hide();
                                        $('body').css('z-index', 999999);
                                    }
                                    else if (data == "") {
                                        $('#OrderfailedModal').modal('show');
                                        $('#OrderfailedModal #Modelordersummary').html('');
                                        $('#pay-modal .Dinein-close').hide();
                                        $('#OrderfailedModal #labelMessage').html('<h4>Order Sending failed</h4>');
                                    }
                                    else {
                                        var cart = JSON.parse(data);
                                        if (cart.OrderNo != null) {
                                            $('#ErrorMsgmodel').modal('hide');
                                            $('#pay-modal').modal('show');
                                            $('#pay-modal .Dinein-close').show();
                                            if (cart.orderstatus == "Update") {
                                                $('#lblPayMessage').html('<h4>' + cart.DineInOrderMessage + '</h4>');
                                                $('#payModalheader').html('Order Confirmation');
                                                // $('#lblPayMessage').html('<h4>Order Updated on POS , Order #' + cart.OrderNo + '</h4>');

                                            }
                                            else {
                                                $('#lblPayMessage').html('<h4>' + cart.DineInOrderMessage + '</h4>');
                                                  $('#payModalheader').html('Order Confirmation');
                                                // $('#lblPayMessage').html('<h4>Order created on POS , Order #' + cart.OrderNo + '</h4>');
                                            }
                                            $('#ErrorMsgmodel').modal('hide');
                                            //setTimeout(function () {
                                            //    $('#pay-modal').modal('hide');

                                            //    $('#loader').show();
                                            //    location.reload();
                                            //}, 3000);
                                        }
                                        else {
                                            var ordermessage = "";
                                            var successflag = true;
                                            if (cart.SplitCheck.Guestusers.length > 0) {
                                                for (var i = 0; i < cart.SplitCheck.Guestusers.length; i++) {
                                                    if (cart.SplitCheck.Guestusers[i].orderstatus == "Success") {
                                                        ordermessage = "Success";
                                                        if (cart.SplitCheck.Guestusers[i].OrderNo != null || cart.SplitCheck.Guestusers[i].OrderNo != '') {
                                                            html += '<p>' + cart.SplitCheck.Guestusers[i].DineInOrderMessage + '</p>';

                                                        }
                                                        if (cart.SplitCheck.Guestusers.length == 1) {
                                                            //$('#pay-modal').modal('show');
                                                            $('#pay-modal .Dinein-close').hide();
                                                            $('#pay-modal').modal({ backdrop: 'static', keyboard: false }, { backdrop: 'static', keyboard: false });
                                                            $('#pay-modal #ordersummary').html(html);
                                                        }
                                                        else {
                                                            // $('#pay-modal').modal('show');
                                                            $('#pay-modal .Dinein-close').hide();
                                                            $('#pay-modal').modal({ backdrop: 'static', keyboard: false }, { backdrop: 'static', keyboard: false });
                                                            $('#pay-modal #ordersummary').html(html);
                                                        }
                                                    }
                                                    else if (cart.SplitCheck.Guestusers[i].orderstatus == "Update") {
                                                        successflag = false;
                                                        ordermessage = "Success";
                                                        if (cart.SplitCheck.Guestusers[i].OrderNo != null || cart.SplitCheck.Guestusers[i].OrderNo != '') {
                                                            html += '<p>' + cart.SplitCheck.Guestusers[i].DineInOrderMessage + '</p>';

                                                        }
                                                        //$('#pay-modal').modal('show');
                                                        $('#pay-modal .Dinein-close').hide();
                                                        $('#btn_qrcode').hide();

                                                        $('#pay-modal #ordersummary').html(html);


                                                    }
                                                    else {

                                                        if (cart.SplitCheck.Guestusers[i].guestcartItems.length != 0) {
                                                            html += '<p>Order Sending failed for ' + cart.SplitCheck.Guestusers[i].Name + '</p>';
                                                        }
                                                        // $('#pay-modal').modal('show');
                                                        $('#pay-modal .Dinein-close').hide();
                                                        if (cart.SplitCheck.Guestusers.length == 1) {
                                                            successflag = false;
                                                            $('#btn_qrcode').hide();
                                                        }

                                                        $('#pay-modal #ordersummary').html(html);

                                                    }

                                                }
                                            }
                                            if (ordermessage == "") {
                                                $('#OrderfailedModal').modal('show');
                                                $('#OrderfailedModal #Modelordersummary').html(html);
                                                $('#pay-modal #ordersummary').html('');
                                            }
                                            else {
                                                $('#pay-modal').modal('show');

                                                if (successflag == false) {
                                                    $('#p_scanQRCode').hide();

                                                    $('#pay-modal').modal({ keyboard: true });
                                                    $('#pay-modal .Dinein-close').hide();
                                                    $('#btn_qrcode').hide();

                                                }
                                                else {
                                                    $('#p_scanQRCode').show();
                                                    $('#pay-modal').modal({ backdrop: 'static', keyboard: false });
                                                    $('#pay-modal .Dinein-close').hide();
                                                    $('#btn_qrcode').show();
                                                    $('#btn_closephonemodal').hide();

                                                }
                                            }

                                        }
                                    }
                                    $('#ErrorMsgmodel').modal('hide');
                                    $('#loader').hide();
                                }
                            });
                        });
                    });
                }
                else if (data1 != '2') {

                    $('#TotalDuePreAuth').val(data1);
                    $('#preAuthAmount').val(parseFloat(data1).toFixed(2))
                    $('#PreAuthErrorMsg').html('');
                    $('#preAuthModal').modal('show');
                    $('#ErrorMsgmodel').modal('hide');
                }
                else {
                    $('#loginModal').modal('show');
                }
                $('#loader').hide();

            }
        });

    }</script>
<form>
    <input name="__RequestVerificationToken" type="hidden" value="CfDJ8IFQ0KpvQgRItZznM2MwCV5OEdIghmVd-q5rByLbtP-QSkcc_AVLtYMnm6dxGrsqNxHQuCjJlMIMRZQtd9T8A6xhBf0-khFYQg-mc5d_dt7aZ63_xQHZ7Z_y_Gqznp7TOaOvXZayKEesYRHRdJEcwYU" />
    <input id="TotalDuePreAuth" name="TotalDuePreAuth" type="hidden" value="0" />
</form>
<div class="modal fade" id="ErrorMsgmodel" tabindex="-1" role="dialog" aria-labelledby="success-modal" aria-hidden="true" data-keyboard="false" data-backdrop="static">
    <div class="modal-dialog modal-dialog-centered" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" id="closeButton" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body">
                <form action="#" class="promo-form form-inline">
                    <img src="/img/processing.gif" id="modalimg" class="imgstyle" />
                    <h4><label for="country-code" id="lblMessage1"></label></h4>

                    <br>

                    <hr />
                </form>

            </div>
            <div class="modal-footer" id="div_closemodal" style="display:none">
                <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
            </div>
        </div>
    </div>
</div>


    <link rel="stylesheet" type="text/css" href="https://i4m.i4go.com/css/wallets.css">
    <script src="https://i4m.i4go.com/js/wallets.js" type="text/javascript"></script>
    <script src="https://pay.google.com/gp/p/js/pay.js" type="text/javascript"></script>

    <!-- the following two scripts are required -->
    <script src="https://i4m.shift4test.com/js/jquery.i4goTrueToken.js?_v=FBC89B85-B8E2-A2EC-07641C255CB19C10" type="text/javascript"></script>

    <!-- optional: for swipe support when focus is anywhere on the page; otherwise focus must be within iframe for swiping -->
    <script src="https://i4m.shift4test.com/js/jquery.cardswipe.js?_v=FBC89B85-B8E2-A2EC-07641C255CB19C10" type="text/javascript"></script>
    <script>

        var Shift4HitFrequency = 0;

        //InitializeShift4();
        function InitializeShift4()
        {
        
             var i4goTrueTokenObj = $("#form-main").i4goTrueToken({
                debug: false,		// Parent side
                remoteDebug: false,		// Adds width indicators within the iframe contents to help with frame sizing
                url: "https://i4m.i4go.com",
                server: "",
                accessBlock: "",
                self: document.location,
                template: "bootstrap2",
                language: "en",
                streetAddress: { classes: "", label: "", placeholder: "", message: "", visible: true, required: true },
                // Can be visible or not; if visible, can be required or not. Default setting is not which means required setting is ignored.

                postalCode: { classes: "", label: "", placeholder: "", message: "", visible: true, required: true },

                /* *** begin options *** */
                /* *** end options *** */
                encryptedOnlySwipe: false,
                submitButton: {
                    label: "Add card",
                    visible: true
                },
                onSuccess: function (form, data) {
                    console.log("i4goTrueToken- onSuccess()", data);
                    var response = data;

                    $('#credit-card').modal('hide');
                    var _res = { 'response': response };
                    var LoginSource = '';
                    if (LoginSource == 'Google' || LoginSource == 'Facebook' || LoginSource == 'OLO'|| LoginSource=='') {
                        $.ajax({
                            type: 'post',
                            url: '/Checkout?handler=i4GoIFrame',
                            data: _res,
                            beforeSend: function (xhr) {
                                xhr.setRequestHeader('XSRF-TOKEN', $('input:hidden[name="__RequestVerificationToken"]').val());
                            },
                            success: function (data) {
                                if (data == "CardExist") {
                                    $('#promo-modal').modal('show');
                                    $('#promo-modal #lblMessage').html('<h4>Card already exists.</h4>');

                                    setTimeout(function () {
                                        $('#promo-modal').modal('hide');
                                        location.reload();
                                    }, 3000);
                                }
                                else {
                                    $(".payment_btn").removeClass("paymentSelected");
                                    $('#CardPostalCode').val();
                                    $('#CardaddressLine').val();
                                    $('#SavedCard').append('<button id="Token-0" class="payment_btn paymentSelected form-control" onclick="PaymentEnable(this)" value="' + response.i4go_uniqueid + '"><i class="fa fa-credit-card"></i> Card Ending ' + response.otn.cardnumber + '<i class="fa fa-angle-right"></i></button>');
                                    var amount = $('#preAuthAmount').val();
                                    var token = response.i4go_uniqueid;
                                    var postalCode = response.i4go_postalcode;
                                    var address = response.i4go_streetaddress;
                                    $('#loader').show();
                                    $.get('Index?handler=PreAuthAmount&amount=' + amount + '&token=' + token + '&postalCode=' + postalCode + '&addressLine=' + address, function (data) {
                                        if (data == "0") {
                                            $('#preAuthModal').modal('hide');
                                            $('#preAuthlabel').html(amount);
                                            $('#preAuthModal').modal('hide');
                                            $('#PreAuthErrorMsg').html('');
                                            $('#preAuthlabel').html(amount);
                                            $('#div_closemodal').hide();
                                            $('#modalimg').show();
                                            $('#ErrorMsgmodel').modal({ backdrop: 'static', keyboard: false });
                                            $('#closeButton').hide();
                                            $('#ErrorMsgmodel #lblMessage1').html('<h4>Amount approved and now processing order to restaurant</h4>');
                                            SendOrder();
                                        }
                                        else {
                                            $('#loader').hide();
                                            $('#PreAuthErrorMsg').html('');
                                            $('#PreAuthErrorMsg').html(data);
                                        }
                                    });

                                }
                                $('#preAuthModal').modal('show');
                            }
                        });
                    } //endif

                },
                onFailure: function (form, data) {
                    console.warn("MY onFailure called!", form, data);
                    var res = data.i4go_responsecode.split(',');
                    if (res[0] = '105') {
                        $('#error-dialog').html('AMEX card type is not supported');
                    }
                    else {
                        Retry++;
                        RetryShift4();
                    }
                    WriteLog(data);
                },
                onWalletInit: function (wallet, enabled, reason) {
                    console.log("i4goTrueToken - onWalletInit()", wallet);
                }
             });
        }

            function ReInitializeShift4() {

                if (Shift4HitFrequency > 0) {
                    $('#promo-modal').modal('show');
                    $('#promo-modal #lblMessage').html('<h4>Please wait</h4>');
                    $('#loader').show();
                    location.reload();
                } else {
                    $('#credit-card').modal('show');
                    Shift4HitFrequency++;
                }


            }



        $(document).on('click', '#btn_preAuthAmount', function () {
        //$('#btn_preAuthAmount').click(function () {
            var amount = $('#preAuthAmount').val();
            var token = $('.paymentSelected').val();
            var postalCode = $('#CardPostalCode').val();
            var address = $('#CardaddressLine').val();
            $('#loader').show();
            //$('#preAuthModal').modal('hide');
            //$('#div_closemodal').hide();
            //$('#modalimg').show();
            //$('#ErrorMsgmodel').modal({ backdrop: 'static', keyboard: false });
            //$('#closeButton').hide();
            //$('#ErrorMsgmodel #lblMessage1').html('<h4>Please wait while we pre-authorize the amount</h4>');

            $.get('Index?handler=PreAuthAmount&amount=' + amount + '&token=' + token + '&postalCode=' + postalCode + '&addressLine=' + address, function (data)
            {

                if (data == "0") {
                    $('#preAuthModal').modal('hide');
                    $('#PreAuthErrorMsg').html('');
                    $('#preAuthlabel').html(amount);
                    $('#div_closemodal').hide();
                    $('#closeButton').hide();
                    $('#ErrorMsgmodel').modal({ backdrop: 'static', keyboard: false });
                    $('#ErrorMsgmodel #lblMessage1').html('<h4>Amount approved and now processing order to restaurant</h4>');
                    SendOrder();
                }
                else {
                    $('#loader').hide();
                    $('#preAuthModal').modal('show');
                    $('#PreAuthErrorMsg').html('');
                    $('#PreAuthErrorMsg').html(data);
                }
            });
        });
        $('#preAuthAmount').on('keyup',function () {
            var decimalregex = /^\d+(?:\.\d\d?)?$/;
            var intregex = /^\d?$/;
            var amt = $(this).val();
            var preAmt = parseFloat($('#TotalDuePreAuth').val());

            if (amt.trim() != '') {
                if (!isNumeric(amt) ) {
                    $(this).val(preAmt.toFixed(2));
                    $('#PreAuthErrorMsg').html('Amount should be $' + preAmt.toFixed(2) + ' or greater than $' + preAmt.toFixed(2) );
                }
                else {
                    var amt = $(this).val();
                    var decimalAmt = amt.split(".");
                    if (decimalAmt.length > 1 &&decimalAmt[1].length > 2) {
                        $(this).val(decimalAmt[0] + '.' + decimalAmt[1].substring(0, 2));
                    }
                    $('#PreAuthErrorMsg').html('');
                }
            }
        });
        function isNumeric(n) {
              return !isNaN(parseFloat(n)) && isFinite(n);
            }

        $('#preAuthAmount').blur(function () {
            var decimalregex = /^\d+(?:\.\d\d?)?$/;
            var intregex = /^\d?$/;
            var amt = $(this).val();
            var preAmt = parseFloat($('#TotalDuePreAuth').val());
            //if (0.0>0) {
            //    preAmt =0.0;
           // }
            //else {
           //     preAmt =0;
           // }

                if (!isNumeric(amt) || parseFloat(preAmt) > parseFloat(amt)) {
                    $(this).val(preAmt.toFixed(2));
                    $('#PreAuthErrorMsg').html('Amount should be $' + preAmt.toFixed(2) + ' or greater than $' + preAmt.toFixed(2));
                }
                else {
                    var amt = $(this).val();
                    var decimalAmt = amt.split(".");
                    if (decimalAmt.length>1&&decimalAmt[1].length>2) {
                        $(this).val(decimalAmt[0] + '.' + decimalAmt[1].substring(0, 2));
                    }

                    $('#PreAuthErrorMsg').html('');
                }

        });

    </script>

<script>
    $(document).ready(function () {
        //Increment the idle time counter every minute.
        var idleInterval = setInterval(timerIncrement, 60000); // 1 minute
        idleTime = 0;
    });
    $(this).keypress(function (e) {
        idleTime = 0;
    });</script>
<script>


    function CheckDineInGuestPhonenumber() {
        $('#loader').show();
        $.ajax({
            type: 'get',
            url: '/Index?handler=CheckUserPhoneNumberExist',
            data: null,
            contentType: 'application/json;charset=utf-8',
            dataType: 'json',
            success: function (data) {
                if (data == "Pos OFF") {
                    $('#tblCart .total_price').hide();
                    $('.Guestuser ').hide()
                    $('#tblCart #noItems').show();
                    $('.qty').html('0');
                    $('.cart_items').remove();
                    $('#loader').hide();
                }
               else if (data == "Session Out") {
                    $('#tblCart .total_price').hide();
                    $('.Guestuser ').hide()
                    $('#tblCart #noItems').show();
                    $('.qty').html('0');
                    $('.cart_items').remove();
                    $('#loader').hide();
                    $('#Phonenumber_Modal').modal('show');
                    $("#btn_getcheckDetails").show();
                    $("#btn_SavePhoneNumber").hide();
                }
                else if (data == "CheckName Session Out") {
                    GetDineInChecks();
                }
                else if (data == "false") {
                    $('#tblCart .total_price').hide();
                    $('#tblCart .Guestuser').hide();
                    $('#tblCart #noItems').show();
                    $('.cart_items').remove();
                    $('.qty').html('0');
                    $('#loader').hide();
                    $('#Phonenumber_Modal').modal('show');
                    $("#btn_getcheckDetails").hide();
                    $("#btn_SavePhoneNumber").show();
                }

            }
        });
    }

    function CheckSplitcheckGuestPhonenumber() {
        $.ajax({
            type: 'get',
            url: '/Index?handler=CheckSplitUserPhoneNumberExist',
            data: null,
            contentType: 'application/json;charset=utf-8',
            dataType: 'json',
            success: function (data) {
                if (data == "Pos OFF") {
                    $('#tblCart .total_price').hide();
                    $('#tblCart #noItems').show();
                    $('.qty').html('0');
                    $('.cart_items').remove();
                    $('#loader').hide();
                }
               else  if (data == "true") {
                    $('#orderSendDummy').hide();
                    $('#checkouthide').hide();
                    $('#tblCart .total_price').hide();
                    //$('#tblCart #noItems').show();
                    $('#noItems').show();
                    $('.Guestuser').hide();
                    $('.cart_items').hide();
                    $('#Phonenumber_Modal').modal('show');
                    $("#btn_getcheckDetails").show();
                    $("#btn_SavePhoneNumber").hide();
                }

            }
        });
    }



$(document).on('click', '#tblCart tr.Guestuser', function () {
$(this).parent().find('.guestactive').removeClass('guestactive');
$(this).addClass('guestactive');
var guestid = $(this).attr('id');
$.ajax({
type: 'get',
url: '/Index?handler=Selectguest&guestid=' + guestid,
data: null,
contentType: 'application/json;charset=utf-8',
dataType: 'json',
success: function (data) {
if (data != "") {

}

}
});
});

$(document).on('click', '.menu_items_grid', function () {
$('.loction-set').hide();
});

$('#btn_Welcomereset').click(function () {
// function resetCart(id) {
$('#loader').show();
var id = $('#btn_Welcomereset').attr('name');
$.ajax({
type: 'get',
url: '/WelcomePage?handler=ResetcartItems&order_id=' + id,
data: null,
contentType: 'application/json;charset=utf-8',
dataType: 'json',
success: function (data) {
$('#loader').hide();
    var html = '<tr class="total_price" style="display:none">       <td colspan="3"><a href="javascript:Checkout()" id="btn_checkout">Checkout <span class="pull-right cart_total" id="cartTotalDue"></span></a></td>                    </tr>         <tr class="total_price">                        <td colspan="3">  <a href="javascript:void()" data-toggle="modal" data-target="#paypal-modal">  Start Over! </a></td>                    </tr>                    <tr id="noItems">                        <td colspan="3"><i>No Items in Cart</i></td>                    </tr>';

$('#tblCart').html(html);
$('.total_price').hide();
$('.qty').text('');
if (data == "Pickuporder") {
//if (id ==6) {
locationcheck(id);
}
else if (data == "Deliveryorder") {
$('#resetcart-modal').modal('hide');
    $.when(getAllStores()).done(function () {
        //  alert("getAllstores")
        $.getJSON('/Index?handler=UserStoreDetails', function (data) {

            if (data != "NoData") {
                area = data.lstDeliveryGeoArea;
            }

        }).done(function (data) {

            if (data != "NoData") {
                var lat = data.latitude;

                var lng = data.longitude;


                initialize(lat, lng);
                CheckUserDeliveryAddress();

            }

        });
    });

}
else {
window.location = '/Index?OrderType=' + id;

}
},
error: function (jqXHR, textStatus, errorThrown) {
if (jqXHR.status == 404 || errorThrown == 'Not Found') {

location.href = "/WelcomePage";
}
}
});


});

$('#btn_Welcomeresetcancl').click(function () {
$('#loader').show();
$.ajax({
type: 'get',
url: '/WelcomePage?handler=LandingOrdertype',
data: null,
contentType: 'application/json;charset=utf-8',
dataType: 'json',
success: function (data) {
$('#loader').hide();
if (data == "false") {
window.location = '/WelcomePage';
}
else {

var ordertype = data.split("=")[1];
location.href = data;
if (ordertype == '6') {
if ($('.sec_type .delivery').hasClass('active')) {
$('.sec_type .delivery').removeClass('active');
$('.sec_type .pickup').addClass('active');
}
}
else if(ordertype == '5'){
if ($('.sec_type .pickup').hasClass('active')) {
$('.sec_type .pickup').removeClass('active');
$('.sec_type .delivery').addClass('active');
}
}
    $('#resetcart-modal').modal('hide');

// if ($('.sec_type .pickup').hasClass('active')) {
//     $('.sec_type .pickup').removeClass('active');
// }
//// window.location = data;
// $('.cart').removeClass('mobile_hidden');
}
},
error: function (jqXHR, textStatus, errorThrown) {
$('#loader').hide();
if (jqXHR.status == 404 || errorThrown == 'Not Found') {

location.href = "/WelcomePage";
}
}
});
//var id = $('#btn_Welcomereset').attr('name');
//window.location = '/Index?OrderType=' + id;
});
            $('#resetcart-modal .close').click(function () {
                $('#btn_Welcomeresetcancl').click();
            });


//$('#btn_EditNo').click(function () {
//$('#editPromt').hide();
//$('#btn_showguestdetail').show();

//});


$(document).on('click', '#location_trigger', function () {
$('.date_select').css('display', 'block');
$('.date_select .inner-date').hide();
$('.loction-set').show();
return false;
});

    $(document).ready(function () {

//if ($('.asap').length > 0) {

//    $('#schdl-collapser').hide();
//}
});

$(document).click(function () {
$('.map-box').hide();
$('.loction-set .loction-inner').show();
$('.loction-set').hide();
// $('.loction-set').hide();
});

$(".loction-set").click(function (e) {
e.stopPropagation();
return;

});



$('.close').click(function () {

$('[id^="instr_"]').val('');
$('#charNum').text('32');
});



$('#mob_2').click(function () {
$('#menu_link_1').hide();
$('#menu_link_0').show();
});

$('#mob_3').click(function () {
$('#menu_link_1').show();
$('#menu_link_0').hide();
});

                function GetPosOpencheck() {
                    $('#loader').show();
                    $.ajax({
                        type: 'get',
                        url: '/index?handler=AllCartItems',
                        data: null,
                        contentType: 'application/json;charset=utf-8',
                        dataType: 'json',
                        success: function (data) {
                            var qty = 0;
                            //debugger
                            if (data == "Pos OFF") {
                                $('#promo-modal').modal('show');
                                $('#promo-modal #lblMessage').html('<h4>Please Contact Staff!</h4>');
                                $('body').css('z-index', 999999);
                            }
                            else if (data != "" && data != "false") {
                                //debugger
                                var cart = JSON.parse(data);
                                var DineinSplitCheck = cart.enableEnhancedDinein;
                                var cartitems = cart.cartItems;

                                if (DineinSplitCheck && cart.OrderNo == null) {
                                    var showchkout = false;
                                    $('.guestname').remove();
                                    $('#tblCart .cart_items').remove();
                                    var tr = '';
                                    $('#loader').hide();
                                    if (cart.SplitCheck != null && cart.SplitCheck.GuestCount > 0) {

                                        for (var i = 0; i < cart.SplitCheck.Guestusers.length; i++) {
                                            if (cart.SplitCheck.Guestusers[i].Name != null) {
                                                if (cart.SplitCheck.Guestusers[i].gitemtotal != null && cart.SplitCheck.Guestusers[i].gitemtotal.subTotal != '0') {
                                                    if (cart.SplitCheck.Guestusers[i].isactive == true) {
                                                        tr += "<tr style='background-color: aliceblue' class='guestname Guestuser guestactive' id='" + cart.SplitCheck.Guestusers[i].guestid + "'><td colspan='3'><h5>" + cart.SplitCheck.Guestusers[i].Name + "<span class='pull-right cart_total' id='bound_" + cart.SplitCheck.Guestusers[i].guestid + "'>$" + parseFloat(cart.SplitCheck.Guestusers[i].gitemtotal.subTotal).toFixed(2) + "</span></h5></td></tr>";
                                                    }
                                                    else {
                                                        tr += "<tr style='background-color: aliceblue' class='guestname Guestuser' id='" + cart.SplitCheck.Guestusers[i].guestid + "'><td colspan='3'><h5>" + cart.SplitCheck.Guestusers[i].Name + "<span class='pull-right cart_total' id='bound_" + cart.SplitCheck.Guestusers[i].guestid + "'>$" + parseFloat(cart.SplitCheck.Guestusers[i].gitemtotal.subTotal).toFixed(2) + "</span></h5></td></tr>";
                                                    }
                                                }
                                                else {
                                                    if (cart.SplitCheck.Guestusers[i].isactive == true) {
                                                        tr += "<tr style='background-color: aliceblue' class='guestname Guestuser guestactive' id='" + cart.SplitCheck.Guestusers[i].guestid + "'><td colspan='3'><h5>" + cart.SplitCheck.Guestusers[i].Name + "<span class='pull-right cart_total' id='bound_" + cart.SplitCheck.Guestusers[i].guestid + "'></span></h5></td></tr>";
                                                    }
                                                    else {
                                                        tr += "<tr style='background-color: aliceblue' class='guestname Guestuser' id='" + cart.SplitCheck.Guestusers[i].guestid + "'><td colspan='3'><h5>" + cart.SplitCheck.Guestusers[i].Name + "<span class='pull-right cart_total' id='bound_" + cart.SplitCheck.Guestusers[i].guestid + "'></span></h5></td></tr>";
                                                    }
                                                }
                                                //html += "<tr style='background-color: aliceblue' class='guestname'><td colspan='3'><h5>" + cart.SplitCheck.Guestusers[i].Name + "<span class='pull-right cart_total' id='bound_" + cart.SplitCheck.Guestusers[i].guestid + "'>" + cart.SplitCheck.Guestusers[i].gitemtotal.subTotal + " (excluded all tax)</span></h5></td></tr>";
                                            }
                                            else {
                                                if (cart.SplitCheck.Guestusers[i].gitemtotal != null && cart.SplitCheck.Guestusers[i].gitemtotal.subTotal != '0') {
                                                    if (cart.SplitCheck.Guestusers[i].isactive == true) {
                                                        tr += "<tr style='background-color: aliceblue' class='guestname Guestuser guestactive' id='" + cart.SplitCheck.Guestusers[i].guestid + "'><td colspan='3'><h5>Guest" + parseInt(i + 1) + "<span class='pull-right cart_total' id='bound_" + cart.SplitCheck.Guestusers[i].guestid + "'>$" + parseFloat(cart.SplitCheck.Guestusers[i].gitemtotal.subTotal).toFixed(2) + "</span></h5></td></tr>";
                                                    }
                                                    else {
                                                        tr += "<tr style='background-color: aliceblue' class='guestname Guestuser' id='" + cart.SplitCheck.Guestusers[i].guestid + "'><td colspan='3'><h5>Guest" + parseInt(i + 1) + "<span class='pull-right cart_total' id='bound_" + cart.SplitCheck.Guestusers[i].guestid + "'>$" + parseFloat(cart.SplitCheck.Guestusers[i].gitemtotal.subTotal).toFixed(2) + "</span></h5></td></tr>";
                                                    }
                                                }
                                                else {
                                                    if (cart.SplitCheck.Guestusers[i].isactive == true) {
                                                        tr += "<tr style='background-color: aliceblue' class='guestname Guestuser guestactive' id='" + cart.SplitCheck.Guestusers[i].guestid + "'><td colspan='3'><h5>Guest" + parseInt(i + 1) + "<span class='pull-right cart_total' id='bound_" + cart.SplitCheck.Guestusers[i].guestid + "'></span></h5></td></tr>";
                                                    }
                                                    else {
                                                        tr += "<tr style='background-color: aliceblue' class='guestname Guestuser' id='" + cart.SplitCheck.Guestusers[i].guestid + "'><td colspan='3'><h5>Guest" + parseInt(i + 1) + "<span class='pull-right cart_total' id='bound_" + cart.SplitCheck.Guestusers[i].guestid + "'></span></h5></td></tr>";
                                                    }
                                                }
                                            }
                                            if (cart.SplitCheck.Guestusers[i].guestcartItems.length > 0) {

                                                for (var j = 0; j < cart.SplitCheck.Guestusers[i].guestcartItems.length; j++) {
                                                    qty = qty + cart.SplitCheck.Guestusers[i].guestcartItems[j].qty;
                                                    var allmodifierPrice = 0;
                                                    if (cart.SplitCheck.Guestusers[i].guestcartItems[j].isSent == false) {
                                                        showchkout = true;
                                                        tr += "<tr class='cart_items' id='row_" + cart.SplitCheck.Guestusers[i].guestcartItems[j].cartItemId + "' boundguest='bound_" + cart.SplitCheck.Guestusers[i].guestid + "'><td class='cart_qty'>" + cart.SplitCheck.Guestusers[i].guestcartItems[j].qty + " ×</td><td class='cart_name'><span class='cart_title'>" + cart.SplitCheck.Guestusers[i].guestcartItems[j].itemName + "</span>";
                                                    }
                                                    else {
                                                        tr += "<tr class='cart_items oldrow' id='row_" + cart.SplitCheck.Guestusers[i].guestcartItems[j].cartItemId + "'><td class='cart_qty'>" + cart.SplitCheck.Guestusers[i].guestcartItems[j].qty + " ×</td><td class='cart_name'><span class='cart_title'>" + cart.SplitCheck.Guestusers[i].guestcartItems[j].itemName + "</span>";
                                                    }
                                                    html += "<span class='cart_info'>";
                                                    if (cart.SplitCheck.Guestusers[i].guestcartItems[j].modifiers != null && cart.SplitCheck.Guestusers[i].guestcartItems[j].modifiers.length > 0) {
                                                        html += "<br />";
                                                        for (var k = 0; k < cart.SplitCheck.Guestusers[i].guestcartItems[j].modifiers.length; k++) {
                                                            tr += "<label> •" + cart.SplitCheck.Guestusers[i].guestcartItems[j].modifiers[k]._modName + "</label >";
                                                            allmodifierPrice = allmodifierPrice + cart.SplitCheck.Guestusers[i].guestcartItems[j].modifiers[k].price;
                                                        }
                                                        if (cart.SplitCheck.Guestusers[i].guestcartItems[j].specialInst != "" && cart.SplitCheck.Guestusers[i].guestcartItems[j].specialInst != null) {
                                                            tr += "<br /><label><i> •" + cart.SplitCheck.Guestusers[i].guestcartItems[j].specialInst + "</i></label>";
                                                        }

                                                    }
                                                    else {
                                                        if (cart.SplitCheck.Guestusers[i].guestcartItems[j].specialInst != "" && cart.SplitCheck.Guestusers[i].guestcartItems[j].specialInst != null) {
                                                            tr += "<br /><label><i> •" + cart.SplitCheck.Guestusers[i].guestcartItems[j].specialInst + "</i></label>";
                                                        }
                                                    }
                                                    tr += "</span>";
                                                    if (cart.SplitCheck.Guestusers[i].guestcartItems[j].isSent == false) {
                                                        tr += "<br /> <a id='" + cart.SplitCheck.Guestusers[i].guestcartItems[j].cartItemId + "' href='javascript:Remove(\"" + cart.SplitCheck.Guestusers[i].guestcartItems[j].cartItemId + "\")' class='remove_item'>Remove</a>";
                                                    }
                                                    if (cart.SplitCheck.Guestusers[i].guestcartItems[j].modifiers == null || cart.SplitCheck.Guestusers[i].guestcartItems[j].modifiers.length == 0) {
                                                        tr += " </td > <td class='cart_price'>$" + (cart.SplitCheck.Guestusers[i].guestcartItems[j].itemPrice * cart.SplitCheck.Guestusers[i].guestcartItems[j].qty).toFixed(2) + "</td></tr> ";
                                                    }
                                                    else {
                                                        tr += " </td > <td class='cart_price'>$" + (parseFloat(cart.SplitCheck.Guestusers[i].guestcartItems[j].itemPrice * cart.SplitCheck.Guestusers[i].guestcartItems[j].qty) + parseFloat(allmodifierPrice * cart.SplitCheck.Guestusers[i].guestcartItems[j].qty)).toFixed(2) + "</td></tr> ";
                                                    }
                                                }
                                            }

                                        }
                                        $('#tblCart').append(tr);

                                        $('.qty').html(qty);
                                        if (showchkout == true) {
                                            $('.tr_checkout').hide();
                                        }
                                        else {
                                            $('.tr_checkout').show();
                                        }

                                        $('#orderSend2Dummy #cartTotalDue').html('$' + cart.total.subTotal.toFixed(2));
                                        $('.total_price #cartTotalDue').html('$' + cart.total.subTotal.toFixed(2));
                                        // html += "<tr class='cart_items' id='row_" + result._cartItemId + "'><td class='cart_qty'>" + qty + " ×</td><td class='cart_name'><span class='cart_title'>" + itemname + "</span>";
                                    }
                                    else {
                                        var tr = '';
                                        $('#tblCart .cart_items').remove();
                                        $('#tblCart .total_price').css('display', 'none');
                                        if ($("#tblCart #noItems").length == 0) {
                                            tr += '<tr id="noItems">';
                                            tr += '<td colspan="3"><i>No Items in Cart</i></td>';
                                            tr += '</tr>';
                                            $('#tblCart').append(tr);
                                        }
                                        $('.qty').html(qty);
                                    }
                                }
                                else {
                                    $('#tblCart .cart_items').remove();

                                     $('#tblCart .Guestuser').remove();
                                    var tr = '';
                        if (DineinSplitCheck && cart.orderType ==0) {
                            if (cart.PosUserDetails != null && cart.PosUserDetails.Name != null) {
                                tr += "<tr style='background-color: aliceblue' class='guestname Guestuser guestactive'><td colspan='3'><h5>" + cart.PosUserDetails.Name + "<span class='pull-right cart_total' >$" + parseFloat(cart.total.subTotal).toFixed(2) + "</span></h5></td></tr>";
                            }
                        }
                                    var showchkout = false;
                                    if (cartitems != null && cartitems.length > 0) {
                                        for (var i = 0; i < cartitems.length; i++) {
                                            if (cartitems[i].isSent == false) {
                                                showchkout = true;
                                                tr += '<tr class="cart_items" id="row_' + cartitems[i].cartItemId + '">';
                                            }
                                            else {
                                                tr += '<tr class="cart_items oldrow" id="row_' + cartitems[i].cartItemId + '">';
                                            }
                                            qty = qty + cartitems[i].qty;
                                            tr += '<td class="cart_qty">' + cartitems[i].qty + '</td>';
                                            tr += '<td class="cart_name">';
                                            tr += '<span class="cart_title">' + cartitems[i].itemName + '</span><br />';

                                            tr += '<span class="cart_info">';
                                            var modifierprice = 0;
                                            if (cartitems[i].modifiers.length > 0) {
                                                for (var j = 0; j < cartitems[i].modifiers.length; j++) {
                                                    tr += '<label> •' + cartitems[i].modifiers[j]._modName + ' </label>';
                                                    modifierprice += cartitems[i].modifiers[j].price;
                                                }

                                            }

                                            if (cartitems[i].specialInst != null) {
                                                if (cartitems[i].modifiers.length > 0) {
                                                    tr += '<br /><label><i> •' + cartitems[i].specialInst + '</i></label><br />';
                                                }
                                                else {
                                                    tr += '<label><i> •' + cartitems[i].specialInst + '</i></label><br />';
                                                }

                                            }
                                            else {
                                                tr += '<br />';
                                            }
                                            tr += '</span>';
                                            if (cartitems[i].isSent == false) {
                                                tr += "<a id='" + cartitems[i].cartItemId + "' href='javascript:Remove(\"" + cartitems[i].cartItemId + "\")' class='remove_item'>Remove</a> </td > ";
                                                //tr += '<a href="javascript:void(0)" id="' + cartitems[i].cartItemId + '" val="' + cartitems[i].qty + '"  class="remove_item RI">Remove</a>';
                                            }

                                            tr += '</td>';
                                            if (cartitems[i].modifiers.length > 0) {
                                                tr += '<td class="cart_price">$' + parseFloat((cartitems[i].itemPrice * cartitems[i].qty) + (modifierprice * cartitems[i].qty)).toFixed(2) + '</td>';

                                            }
                                            else {
                                                tr += '<td class="cart_price">$' + parseFloat(cartitems[i].itemPrice * cartitems[i].qty).toFixed(2) + '</td>';
                                            }
                                        }
                                        if (showchkout == true) {
                                            $('.tr_checkout').hide();
                                        }
                                        else {
                                            $('.tr_checkout').show();
                                        }
                                        $('#tblCart').append(tr);
                                        $('.qty').html(qty);
                                        $('#orderSend2Dummy #cartTotalDue').html('$' + cart.total.subTotal.toFixed(2));
                                        $('.total_price #cartTotalDue').html('$' + cart.total.subTotal.toFixed(2));
                                    }
                                    else {
                                        var tr = '';
                                        if (DineinSplitCheck && cart.orderType ==0) {
                                            if (cart.PosUserDetails != null && cart.PosUserDetails.Name != null) {
                                                tr += "<tr style='background-color: aliceblue' class='guestname Guestuser guestactive'><td colspan='3'><h5>" + cart.PosUserDetails.Name + "<span class='pull-right cart_total' ></span></h5></td></tr>";
                                            }
                                        }
                                        $('#tblCart .total_price').css('display', 'none');
                                        $('#tblCart #noItems').remove();
                                            tr += '<tr id="noItems">';
                                            tr += '<td colspan="3"><i>No Items in Cart</i></td>';
                                            tr += '</tr>';
                                        $('#tblCart').append(tr);
                                        $('.qty').html(qty);

                                    }
                                    $('#loader').hide();

                                }
                            }
                            else {
                                if (data == "false") {
                                    var tr = '';
                                    $('#tblCart .cart_items').remove();
                                    $('#tblCart .total_price').css('display', 'none');
                                    if ($("#tblCart #noItems").length == 0) {
                                        tr += '<tr id="noItems">';
                                        tr += '<td colspan="3"><i>No Items in Cart</i></td>';
                                        tr += '</tr>';
                                        $('#tblCart').append(tr);
                                    }
                                    $('.qty').html(qty);
                                    $('#loader').hide();
                                }
                            }
                        }
                    });
                }

</script>
<script>
    function countChar(val, itemId) {
        ;
        var len = val.value.length;
        if (len > 16) {
            val.value = val.value.substring(0, 16);
        } else {
            var id = '#charNum_' + itemId
            var remain = parseInt(16 - parseInt(len))
            $(id).text(remain);
        }
        return true;
    };</script>
<script>
$(document).ready(function () {
    if ('3' == '5') {
       // getAllStores();
    }

    $(document).on('show.bs.modal', '.modal', function () {
        $('.bottom_fixed_mob').hide();
        $('.menu_nav.fixed_navigation').css('z-index', '0');
    });
    $(document).on('hidden.bs.modal', '.modal', function () {
        $('.menu_nav.fixed_navigation').css('z-index', '99');
    });
});


function getAllStores() {

$.ajax({
type: 'get',
url: '/Index?handler=AllStores',
data: null,
async:false,
contentType: 'application/json;charset=utf-8',
dataType: 'json',

success: function (data) {

var storedt = JSON.parse(data);

storeconfig = storedt.storeConfigDetails;

//initialize();

}
});
}

var closest;
function GetStoresOutsideTradezone(ulat, ulng) {

$('#loader').show();
$.ajax({
type: 'get',
url: '/WelcomePage?handler=FindNearestStoreOutsideTradezone&userlat=' + ulat + '&userlong=' + ulng,
data: null,
contentType: 'application/json;charset=utf-8',
dataType: 'json',

success: function (data) {
$('#loader').hide();
if (data == "Found") {
$('#deliveryPrompt-modal').modal('show');

}
else if (data == "Outside tradezone") {

$('#deliveryaddressmodal').modal('hide');
$('#PickupromptModal').modal('show');

}
else {
$('#delivery-modal').modal('show');
}
}
});


}
function GetNeareststoresforDelivery(ulat, ulng,methodname) {

$('#loader').show();
$.ajax({
type: 'get',
url: '/WelcomePage?handler=FindNearestStoreUsingGeoArea&userlat=' + ulat + '&userlong=' + ulng,
data: null,
contentType: 'application/json;charset=utf-8',
dataType: 'json',

success: function (data) {
$('#loader').hide();
if (methodname == "deliverypopup") {
if (data == "Found") {
var order_id =5;
showAddressdetail(place.name, address, latitude, longitude, "Valid", PostalCode);
//UserSaveDeliveryAddress(place.name, address, latitude, longitude, "Valid", PostalCode);
//UserSaveAddressDelivery(place.name, address, latitude, longitude, "Valid", PostalCode, order_id);
}
else if (data == "Outside tradezone") {
$('#div_editaddr').hide();
$('#div_storeoffline').hide();
$('#div_notfound').show();
//$('#deliveryaddressmodal').modal('hide');
// $('#PickupromptModal').modal('show');

}
else {
$('#div_editaddr').hide();
$('#div_notfound').hide();
$('#div_storeoffline').show();

//$('#deliveryaddressmodal').modal('hide');
// $('#delivery-modal').modal('show');
}
}

else {
if (data == "Found") {
var order_id =5;
UserSaveAddressDelivery(place.name, address, latitude, longitude, "Valid", PostalCode, order_id);
}
else if (data == "Outside tradezone") {

//$('#deliveryaddressmodal').modal('hide');
$('#PickupromptModal').modal('show');

}
else {
//$('#deliveryaddressmodal').modal('hide');
$('#delivery-modal').modal('show');
}
}

}
});

}


 function EventListener(center, autocomplete, status) {

        place = autocomplete.getPlace();
       //alert(JSON.stringify(place.address_components));
            $('#loader').show();

            if (place!=null&&place.address_components) {
                address = [
                    (place.address_components[0] &&
                        place.address_components[0].short_name) ||
                    "",
                    (place.address_components[1] &&
                        place.address_components[1].short_name) ||
                    "",
                    (place.address_components[2] &&
                        place.address_components[2].short_name) ||
                    "",
                    (place.address_components[3] &&
                        place.address_components[3].short_name) ||
                    "",
                    (place.address_components[4] &&
                        place.address_components[4].short_name) ||
                    "",
                    (place.address_components[5] &&
                        place.address_components[5].short_name) ||
                    "",
                    (place.address_components[6] &&
                        place.address_components[6].short_name) ||
                    "",
                    (place.address_components[7] &&
                        place.address_components[7].short_name) ||
                    "",
                ].join(" ");
                var PostalCode = "";
                var unit = "";
                var street = "";
                var city = "";
                var state = "";
                for (var i = 0; i < place.address_components.length; i++) {
                    for (var j = 0; j < place.address_components[i].types.length; j++) {


                        if (place.address_components[i].types[j] == "postal_code") {
                            PostalCode = place.address_components[i].long_name;

                        }
                        if (place.address_components[i].types[j] == "floor") {
                            unit = place.address_components[i].long_name;

                        }

                           if (place.address_components[i].types[j] == "subpremises") {
                            unit+= place.address_components[i].long_name;
                           }
                        if (place.address_components[i].types[j] == "street_number") {
                            street = place.address_components[i].long_name+" ";

                        }
                        if (place.address_components[i].types[j] == "route") {
                            street += place.address_components[i].long_name +" ";

                        }
                         if (place.address_components[i].types[j] == "neighborhood") {
                            street += place.address_components[i].long_name;

                        }
                        if (place.address_components[i].types[j] == "administrative_area_level_2") {
                            city = place.address_components[i].long_name;

                        }

                        if ((place.address_components[i].types[j] == "locality") && (place.address_components[i].long_name!=null )) {
                            city = place.address_components[i].long_name;

                        }


                        if (place.address_components[i].types[j] == "administrative_area_level_1") {
                            state = place.address_components[i].long_name;

                        }
                    }
                }
                $.get('/welcomepage?handler=SaveFullAddress&street=' + street + '&city=' + city + '&state=' + state + '&zip=' + PostalCode, function (data) { });
               // alert(unit + ',' + street + ',' + city + ',' + state + ',' + PostalCode);
            }
            
            if (!place.geometry) {
                $('#loader').hide();
                $('#promo-modal').modal('show');
                $('#promo-modal #lblMessage').html("<h4>Please select from the address choices from the list.</h4>");
                return;
            };


            //if (google.maps.geometry.poly.containsLocation(place.geometry.location, polygon)) {
            var geocoder = new google.maps.Geocoder();
         if(!address.includes(place.name))
         {
             address = place.name + ' ' + address;
         }
            geocoder.geocode({ 'address':  address }, function (results, status) {
                   
                if (status == google.maps.GeocoderStatus.OK) {
                    $("#ErrorMessageAddress").text('');
                    latitude = results[0].geometry.location.lat();
                    longitude = results[0].geometry.location.lng();
                    ulat = latitude;
                    ulng = longitude;

                    GetNeareststoresforDelivery(ulat, ulng);

                }
                else {
                    $('#address').val('');
                    $("#ErrorMessageAddress").text('Please search with Street name or with complete address!');
                }
            });
            $('#loader').hide();

    }

/*
function EventListenerOld(center, autocomplete, methodname, status) {

$('#loader').show();
if (methodname != "valid") {

place = autocomplete.getPlace();
$('#loader').show();

if (place!=null&&place.address_components) {
address = [
(place.address_components[0] &&
place.address_components[0].short_name) ||
"",
(place.address_components[1] &&
place.address_components[1].short_name) ||
"",
(place.address_components[2] &&
place.address_components[2].short_name) ||
"",
(place.address_components[3] &&
place.address_components[3].short_name) ||
"",
(place.address_components[4] &&
place.address_components[4].short_name) ||
"",
(place.address_components[5] &&
place.address_components[5].short_name) ||
"",
(place.address_components[6] &&
place.address_components[6].short_name) ||
"",
(place.address_components[7] &&
place.address_components[7].short_name) ||
"",
].join(" ");

for (var i = 0; i < place.address_components.length; i++) {
for (var j = 0; j < place.address_components[i].types.length; j++) {

if (place.address_components[i].types[j] == "postal_code") {
PostalCode = place.address_components[i].long_name;

}
}
}
}

if (!place.geometry) {
$('#loader').hide();
$('#promo-modal').modal('show');
$('#promo-modal #lblMessage').html("<h4> Please select from the address choices from the list.</h4>");
return;
};


//if (google.maps.geometry.poly.containsLocation(place.geometry.location, polygon)) {
var geocoder = new google.maps.Geocoder();

geocoder.geocode({ 'address': place.name + ' ' + address }, function (results, status) {


if (status == google.maps.GeocoderStatus.OK) {
latitude = results[0].geometry.location.lat();
longitude = results[0].geometry.location.lng();
ulat = latitude;
ulng = longitude;
GetNeareststoresforDelivery(ulat, ulng,"deliverypopup");

}
});
//} else {
//    $('#promo-modal').modal('show');
//    $('#promo-modal #lblMessage').html('<h4>Sorry! No store delivers to this location</h4>');
//    $('.add').val("");
//};

$('#loader').hide();
}
else {

place = autocomplete.getPlace();
$('#loader').show();

if (place!=null&&place.address_components) {
address = [
(place.address_components[0] &&
place.address_components[0].short_name) ||
"",
(place.address_components[1] &&
place.address_components[1].short_name) ||
"",
(place.address_components[2] &&
place.address_components[2].short_name) ||
"",
(place.address_components[3] &&
place.address_components[3].short_name) ||
"",
(place.address_components[4] &&
place.address_components[4].short_name) ||
"",
(place.address_components[5] &&
place.address_components[5].short_name) ||
"",
(place.address_components[6] &&
place.address_components[6].short_name) ||
"",
(place.address_components[7] &&
place.address_components[7].short_name) ||
"",
].join(" ");


}

if (storeconfig[closest].lstDeliveryGeoArea.length > 0) {
if (google.maps.geometry.poly.containsLocation(place.geometry.location, polygon)) {
var geocoder = new google.maps.Geocoder();

geocoder.geocode({ 'address': place.name + ' ' + address }, function (results, status) {
if (status == google.maps.GeocoderStatus.OK) {
latitude = results[0].geometry.location.lat();
longitude = results[0].geometry.location.lng();
ulat = latitude;
ulng = longitude;
// var ordertype =5;
SaveDeliveryNearestStore(storeconfig[closest].storeId);
//UserSaveAddressDelivery(place.name, address, latitude, longitude, "Valid", PostalCode, ordertype);

// $('#deliveryaddressmodal').modal('hide');
// $('#loader').hide();

}
});
}
else {
$('#delivery-modal').modal('show');
//$('#promo-modal').modal('show');
//$('#promo-modal #lblMessage').html('<h4>Sorry! No store delivers to this location</h4>');
$('#address').val("");
};
}
else {
SaveDeliveryNearestStore(storeconfig[closest].storeId);
}

$('#loader').hide();
}

$('#loader').hide();

}
*/
function SaveDeliveryNearestStore(store_id) {
$('#loader').show();
$.ajax({
type: 'get',
url: '/Index?handler=SaveDeliverystore&storeId=' + store_id,
data: null,
contentType: 'application/json;charset=utf-8',
dataType: 'json',

success: function (data) {
$('#loader').hide();
if (data == "Online") {
var ordertype=5;
UserSaveAddressDelivery(place.name, address, latitude, longitude, "Valid", PostalCode, ordertype);

//window.location.href = "/Index?OrderType=" + order_id;
//$('#loader').hide();
}
else if (data == "Offline") {
$('#loader').hide();
$('#delivery-modal').modal('show');

}

}
});
}

function SetTakeAwayOrder()
{
$('#deliveryPrompt-modal').modal('hide');
$('#delivery-modal').modal('hide');
var order_id =6;
checkcart(order_id);
// window.location.href = "/Index?OrderType=" + order_id;
}

$('#btn_Canceldeliveryaddress').click(function () {
$('#deliveryPrompt-modal').modal('hide');

});

function ChangeIndexDeliveryAddress() {

if (newlat!=0 && newlong!=0) {
GetNeareststoresforDeliveryIndex(newlat, newlong);
}
//else {
//    alert('No address found');
//}

}
var nears;
function GetNeareststoresforDeliveryIndex(ulat, ulng) {
$('#loader').show();
$.ajax({
type: 'get',
url: '/WelcomePage?handler=FindNearestStoreUsingGeoArea&userlat=' + ulat + '&userlong=' + ulng,
data: null,
contentType: 'application/json;charset=utf-8',
dataType: 'json',

success: function (data) {
$('#loader').hide();
// alert("found Index");
if (data != "Not Found") {
var order_id =5;
UserSaveAddressDelivery(place.name, address, latitude, longitude, "Valid", PostalCode, order_id);
}
else {

$('#delivery-modal').modal('show');
}
}
});


}


$("#popupbtn_updateAddress").click(function () {
var order_id = $(this).attr('name');
var name = $("#hd_mainaddr").val();
var address = $("#hd_secondaryaddr").val();
var latitude = $('#hd_lat').val();
var longitude = $('#hd_long').val();
var Apartmentnumber = $('#txt_Apartmentnumber').val();
var DropOff = $("#txt_additional_drop_info").val();
var Dropopt = $("input[name='rd_drop-option']:checked").val();
var postalcode = $('#hd_postalcode').val();
if (Apartmentnumber.length > 10) {
$("#spanapartmenterror").css('color', 'red');
return false;
}
else {
$("#spanapartmenterror").css('color', 'black');
}

if (DropOff.length > 32) {
$("#spandroperror").css('color', 'red');
return false;
}
else {
$("#spandroperror").css('color', 'black');
}
$.ajax({
type: 'get',
url: '/Index?handler=UserAddress',
data: { "Name": name, "Address": address, "latitude": latitude, "longitude": longitude, "Apartmentnumber": Apartmentnumber, "comment": DropOff, "DropOff": Dropopt, "PostalCode": postalcode},
contentType: 'application/json;charset=utf-8',
dataType: 'json',

success: function (data) {
$('#deliveryaddressmodal').modal('hide');
//$("#location_trigger").html('');
//$("#location_trigger").html(data.apartmentnumber + ' ' + data.name);
//$('.map-box').hide();
//$('.loction-set .loction-inner').show();
//$('.loction-set').hide();
//$('#Apartmentnumber').val(data.apartmentnumber);
//$("#additional_drop_info").val(Dropopt);
///var URL = "index?OrderType=5";
var URL ="index?OrderType="+order_id;
location.href = URL;
//location.reload();
},
error: function (jqXHR, textStatus, errorThrown) {
if (jqXHR.status == 404 || errorThrown == 'Not Found') {
$('#promo-modal').modal('show');
$('#promo-modal #lblMessage').html('<h4>Oops something happened , please contact store directly</h4>');

setTimeout(function () {
$('#promo-modal').modal('hide');
location.href = "/WelcomePage";
}, 3000);
}
}


});
});

$('#btn_cancelUpdateaddr').click(function () {
var order_id = $(this).attr('name');
$('#address').val("");
$('.div_editaddr').hide();
$('.strname').html('');
$('#deliveryaddressmodal').modal('hide');
$('#div_inputaddress').show();
$('#txt_Apartmentnumber').val('');
$('#txt_additional_drop_info').val('');
$('#rd_hand').prop('checked', true);
location.href = '/index?Ordertype=' + order_id;
});
$('#btn_qrcode').click(function () {
$('#loader').show();
$.ajax({
type: 'get',
url: '/Index?handler=ScanQRCode',
data: null,
contentType: 'application/json;charset=utf-8',
dataType: 'json',
success: function (data) {
$('#loader').hide();
location.href = '/QRCodeScan';
}

});
});

    $('#deliveryaddressmodal').on('hidden.bs.modal', function () {
      
        let text = document.getElementById('address2').text;
        
        if (text == '' || text==undefined ) {
         
            $('#btn_Welcomeresetcancl').click();
        }
        else {
          
            var modalordertype = '3';
            if (modalordertype != '5') {
                var order_id = '5';
                location.href = '/index?Ordertype=' + order_id;
            }
        }
    });



$('[id^="product_modal-"]').on('hidden.bs.modal', function () {
$('[id^="charNum_"]').text('32');
$('[id^="instr_"]').val('');
$('[id^="qty_"]').val('1');
$('.product_modal input[type=checkbox]').prop('checked', false);
$('.product_modal input[type=radio]').prop('checked', false);
    $('.product_modal input[type=checkbox]').prop('disabled', false);
    $('.product_modal .form-check .dropdown_items .form-check input[type=radio]').prop('required', false);
    $('.product_modal .form-check .dropdown_items .form-check input[type=radio]').prop('checked', false);
    $('.product_modal .form-check .dropdown_items .form-check input[type=checkbox]').prop('checked', false);
    $('.product_modal .form-check .dropdown_items .form-check input[type=checkbox]').prop('disabled', false);
    var productVideotag = "#" + $(this).attr('id') + " video";
    $(productVideotag).trigger('pause');

});

$('.changestore').click(function () {
$('#ChangeStore-Modal').modal('show');
});

    $('[id^="product_modal-"]').on('shown.bs.modal', function () {
        var productVideotag = "#"+ $(this).attr('id') + " video";
        $(productVideotag).one("play", function () {
            this.currentTime = 0;
        });
        $(productVideotag).trigger('play');
    });
//function initializeaddress(slat, slng) {
//    alert("initializeaddress");
//    var center = new google.maps.LatLng(slat, slng);


//    polygon = new google.maps.Polyline({
//        path: geoarea,
//        geodesic: true,
//        strokeColor: '#FFd000',
//        strokeOpacity: 1.0,
//        strokeWeight: 4,
//        fillColor: '#FFd000',
//        fillOpacity: 0.35
//    });
//    //const inputD = document.getElementById('pac-input');

//    //const autocompleteD = new google.maps.places.Autocomplete(inputD);
//    //autocompleteD.addListener('place_changed', function () {
//    //
//    EventListenerIndex(center, autocompleteindex, "valid", "true");
//    //});
//}

//function EventListenerIndex(center, autocomplete, methodname, status) {
//    alert("EventListenerIndex");
//    $('#loader').show();
//    place = autocomplete.getPlace();
//    $('#loader').show();
//    if (place.address_components) {
//        address = [
//            (place.address_components[0] &&
//                place.address_components[0].short_name) ||
//            "",
//            (place.address_components[1] &&
//                place.address_components[1].short_name) ||
//            "",
//            (place.address_components[2] &&
//                place.address_components[2].short_name) ||
//            "",
//            (place.address_components[3] &&
//                place.address_components[3].short_name) ||
//            "",
//            (place.address_components[4] &&
//                place.address_components[4].short_name) ||
//            "",
//            (place.address_components[5] &&
//                place.address_components[5].short_name) ||
//            "",
//            (place.address_components[6] &&
//                place.address_components[6].short_name) ||
//            "",
//            (place.address_components[7] &&
//                place.address_components[7].short_name) ||
//            "",
//        ].join(" ");
//    }

//    if (storeconfig[closest].lstDeliveryGeoArea.length > 0) {
//        if (google.maps.geometry.poly.containsLocation(place.geometry.location, polygon)) {
//            var geocoder = new google.maps.Geocoder();

//            geocoder.geocode({ 'address': place.name + ' ' + address }, function (results, status) {
//                if (status == google.maps.GeocoderStatus.OK) {
//                    latitude = results[0].geometry.location.lat();
//                    longitude = results[0].geometry.location.lng();
//                    //alert(latitude + ',' + longitude);
//                    ulat = latitude;
//                    ulng = longitude;

//                    SaveDeliveryNearestStore(storeconfig[closest].storeId);

//                }
//            });
//        }
//        else {
//            $('#delivery-modal').modal('show');
//            $('#deliveryPrompt-modal').modal('show');
//            //$('#promo-modal').modal('show');
//            //$('#promo-modal #lblMessage').html('<h4>Sorry! No store delivers to this location</h4>');
//            $('#address').val("");
//        };
//    }
//    else {
//        var geocoder = new google.maps.Geocoder();
//        geocoder.geocode({ 'address': place.name + ' ' + address }, function (results, status) {
//            if (status == google.maps.GeocoderStatus.OK) {
//                latitude = results[0].geometry.location.lat();
//                longitude = results[0].geometry.location.lng();


//                SaveDeliveryNearestStore(storeconfig[closest].storeId);

//            }
//        });

//    }

//    $('#loader').hide();
//    $('#delivery-modal').modal('hide');
//}


</script>
<script>
    var SessionInterval = 0;
    $(document).ready(function () {
      //  setInterval(IncSession, 60000);

        function IncSession() {


            $.get("/Index?handler=CheckTime&Time=" + SessionInterval, function (data) {
                if (data == "-1") {
                    SessionInterval = 0;
                    $('#reset-modal').modal('show');
                    $('#reset-modal #lblMessage').html('<h4>Time slot you have selected is no longer valid, Your cart has been reset.</h4>');
                    //setTimeout(function () {
                    //    location.href = "/index";
                    //}, 5000);
                }
                else if (data == "-2") {
                    SessionInterval = 0;
                    $('#reset-modal').modal('show');
                    $('#reset-modal #lblMessage').html('<h4>Time slot you have selected is no longer valid, Your time slot has been reset.</h4>');
                    //setTimeout(function () {
                    //    location.href = "/index";
                    //}, 5000);
                }
                else {
                    SessionInterval++;
                }
            });


        }
    });</script>
<script>
    $(document).ready(function () {
        $('[id^="btn-"]').click(function () {

            $('[id^="charNum_"]').text('32');
        });
        //$('.close').click(function () {

        //    $('[id^="charNum_"]').text('32');
        //    $('.product_modal input[type=checkbox]').prop('checked', false);
        //    $('.product_modal input[type=radio]').prop('checked', false);
        //});
    });</script>
<script>
    function Check(ob) {
        debugger


        var child = $(ob).find('input');
        var hasClass = $(ob).hasClass('subMod');
        if (hasClass) {
            if (child.is(':checked')) {
                child.prop('checked', false);
            }
            else {
                child.prop('checked', true);
            }


        }

    }
    function Check(ob, scroll) {

        var child = $(ob).find('input');
        var hasClass = $(ob).hasClass('subMod');
        if (hasClass) {
            if (child.is(':checked')) {
                child.prop('checked', false);
            }
            else {
                child.prop('checked', true);
            }


        }
        debugger
        if(scroll== true){
            $('.product_modal .modal-body').animate({
               scrollTop: $(ob).offset().top + 5
            },1000);
            //$('.product_modal .modal-body').scrollTop($(ob).offset().top + 5);
        }

    }
    </script>
<script>
    function AddUpsell() {
        var IdList = [];
        var NameList = [];
        var ItemId = '';
        var count = 0;
        var totalCount = parseInt($('#RequiredUpsellQuantity').text());
        $('#loader').show();
        $.each($('[id^="AddUpsell_"]'), function () {
            if ($(this).is(':checked')) {
                IdList.push(($(this).attr('id').split('_'))[1]);
                NameList.push($(this).val());
                count++;
            }

        });
        if (count < totalCount) {

            $('#ErrorMsgUpsell').html('Please select required products.');
        }
        else if (count > totalCount) {

            $('#ErrorMsgUpsell').html('Please select required products not more than that.');
        }
        else {
            $('#ErrorMsgUpsell').html('');
            $.ajax({
                type: 'get',
                url: '/Index?handler=AddUpsellProduct&ItemId=' + IdList + '&ItemName=' + NameList,
                data: null,
                dataType: 'html',
                async: false,
                success: function (data) {

                    if (data == 1) { $('#Upsellmodal').modal('hide'); location.reload(); }

                }
            });
        }

        return true;
    }</script>

<style>
    .dropdown_items {
        display: none;
    }

        .dropdown_items .form-check {
            border: 0;
        }

    .dropdown_item {
        /*    display: inline-block;
            width: 20px;
            margin-left: 10px;
            cursor: pointer;
            text-align: center;
            position: absolute;
            right: 0;
            top: 8px;*/
        display: inline-block;
        margin-left: 10px;
        cursor: pointer;
        position: absolute;
        top: 8px;
        left: 15px;
        width: 94%;
        /* background: red; */
        text-align: right;
    }

    .p_form .form-check label {
        padding-right: 25px;
    }

    .p_form h4 {
        padding-right: 24px;
    }

    .dropdown_item.open .fa-angle-down:before {
        content: "\f106";
    }

    .changedropdown {
    }
</style>
<script>
    $(".dropdown_item").click(function () {
        $(this).toggleClass('open');
        //$(this).prev('.form-check-label').find('input').prop("checked", true);
        $(this).parents('.form-check').find('.dropdown_items').slideToggle();
        $(this).parents('.form-check').find('.form-check-label').click();
    });</script>
<script>
                 function AddToCartLimited(itemId, itemname, price, ltdQty) {
                     disableSyncCart=true;
                    //itemname = itemname.replace("\'", "'").replace('_','"');
                    var submodifiercheckflag = true;
                   //$('#loader').show();
                    $('#btn-' + itemId).addClass('processing-cart button.btn.btn-primary.add_to_cart');

                    var qty = $('#qty_' + itemId).val();
                    if (qty == 0) {
                        return false;
                    }
                    //var instr = $('#instr_' + itemId).val();
                    var instr = $('[id^="instr_' + itemId + '"]').val();
                    if (instr == 'undefined') instr = '';
                    if (qty > ltdQty) {

                        $('#promo-modal').modal('show');
                        $('#promo-modal #lblMessage').html('Only ' + ltdQty + ' available . Cannot add more than that!');
                        $('#btn_checkout').removeClass('disable');
                        $('.btn_dineCheckout').removeClass('disable');
                        $('.btn_sendorder').removeClass('disable');
                        $('#btn_checkout').removeClass('disable');
                        $('#loader').hide();

                        return false;
                    }
                    var ModifigrpId = $('.ModifiyGrpId-' + itemId).map(function () {
                        return this.value;
                    }).get();

                    if (ModifigrpId.length > 0) {
                        $('#product_modal-' + itemId + ' .ModifierParent').each(function (index) {

                            //var obj = $(this).parent();
                            var CheckRequired = $(this).parent().children(".CheckType").val();
                            var ModifiGrpName = $(this).parent().children(".ModifierParent").val();
                            if (ModifigrpId.includes(ModifiGrpName)) {
                                if (CheckRequired == "Requird") {
                                    var minval = $(this).parent().children(".ModifierMinQty").val();
                                    var numberOfChecked = $('.CheckbocCheckVal-' + itemId + '-' + ModifiGrpName + ':checkbox:checked').length;
                                    if (parseInt(numberOfChecked) < parseInt(minval)) {
                                        $('#promo-modal').modal('show');
                                        $('#promo-modal #lblMessage').html('Please select atleast ' + minval + '&nbsp; <b> ' + ModifiGrpName.replaceAll('_', ' ')+ '</b>');
                                        $('#loader').hide();
                                        submodifiercheckflag = false;
                                        return false;
                                    }
                                }
                            }
                        });

                        if (submodifiercheckflag) {
                            $(".Checkrequired").each(function (index) {

                                //var obj = $(this).parent();
                                var CheckRequired = $(this).parent().children(".Checkrequired").val();
                                var ModifiGrpName = $(this).parent().children(".GroupName").val();
                                if ($(this).parent().parent().parent().parent().children('.form-check-label').children('input').prop('checked')) {
                                    if (CheckRequired == "Requird") {
                                        var submodifierid = $(this).parent().children(".Checkrequired").attr('submodifierId');
                                        //alert(submodifierid);
                                        var minval = $(this).parent().children(".minQty").val();
                                        var numberOfChecked = $('.CheckbocCheckVal-' + submodifierid + '-' + ModifiGrpName + ':checkbox:checked').length;
                                        if (parseInt(numberOfChecked) < parseInt(minval)) {
                                            $('#promo-modal').modal('show');
                                            $('#promo-modal #lblMessage').html('Please select atleast ' + minval + '&nbsp; <b> ' + ModifiGrpName.replaceAll('_', ' ')+'</b>');
                                            $('#loader').hide();
                                            submodifiercheckflag = false;
                                            return false;
                                        }
                                    }
                                }
                            });
                        }
                    }
                    else {
                        var minval = $(".minOrderval1-" + itemId).val();
                        var numberOfChecked = $('.' + itemId + ':checked').length;
                        // alert(numberOfChecked);
                        if (parseInt(numberOfChecked) < parseInt(minval)) {
                            $('#promo-modal').modal('show');
                            $('#promo-modal #lblMessage').html('Please select atleast ' + minval);
                            $('#loader').hide();
                            return false;
                        }
                    }
                    if (submodifiercheckflag) {
                        $('#product_modal-' + itemId).modal('hide');
                        $('#btn_checkout').addClass('disable');
                        $('.btn_dineCheckout').addClass('disable');
                        $('.btn_sendorder').removeClass('disable');

                        var itemTotalprice = $('.ChangePrice-' + itemId).html();
                        var checkedVals = $('.' + itemId + ':checkbox:checked').map(function () {
                            return this.value;
                        }).get();
                        checkedVals.join("•");
                        var checkedbutton = $('.' + itemId + ':radio:checked').map(function () {
                            return this.value;
                        }).get();
                        checkedbutton.join("•");


                        var checkedNames = $('.' + itemId + ':checkbox:checked').map(function () {
                            return '{"Id":"' + this.id + '", "_modName": "' + this.value.replaceAll('"','(*dq)') + '","price":"' + this.attributes[2].value + '"}';
                        }).get();

                        checkedNames.join(",");

                        var checkedNamebutton = $('.' + itemId + ':radio:checked').map(function () {
                            return '{"id":"' + this.id + '", "_modName": "' + this.value.replaceAll('"', '(*dq)') + '","price":"' + this.attributes[5].value + '"}';
                        }).get();

                        checkedNamebutton.join(",");
                        var Extras = '[' + checkedNamebutton + ', ' + checkedNames + ']';

                        $.ajax({
                            type: 'get',
                            url: '/Index?handler=AddToCartLtd',
                            data: { "itemId": itemId, "qtyD": qty, "price": price, "Name": itemname, "Extras": Extras, "Instr": instr, "ltdQty": ltdQty },

                            contentType: 'application/json;charset=utf-8',
                            dataType: 'json',

                            success: function (data) {

                                $('#loader').hide();
                                var result = JSON.parse(data);
                                if (JSON.parse(data).responseMessage == "" || JSON.parse(data).responseMessage == null) {
                                    $('#loader').hide();
                                    var currency = '$';
                                    //var currency = result._cart._storeResponse.storeConfigDetails[0].Currency;
                                    if (result.ordertype == "Dinein") {
                                        var _issent = false;
                                        var flag = false;
                                        $('.guestname').remove();
                                        $('.cart_items').remove();
                                        $('.btn_checkout').hide();
                                        if (result._cart.SplitCheck.GuestCount > 0) {
                                            var html = '';
                                            for (var i = 0; i < result._cart.SplitCheck.Guestusers.length; i++) {
                                                if (result._cart.SplitCheck.Guestusers[i].Name != null) {

                                                    if (result._cart.SplitCheck.Guestusers[i].gitemtotal != null && result._cart.SplitCheck.Guestusers[i].gitemtotal.subTotal != '0') {
                                                        if (result._cart.SplitCheck.Guestusers[i].isactive == true) {
                                                            html += "<tr style='background-color: aliceblue' class='guestname Guestuser guestactive' id='" + result._cart.SplitCheck.Guestusers[i].guestid + "'><td colspan='3'><h5>" + result._cart.SplitCheck.Guestusers[i].Name + "<span class='pull-right cart_total' id='bound_" + result._cart.SplitCheck.Guestusers[i].guestid + "'>" + currency+"" + parseFloat(result._cart.SplitCheck.Guestusers[i].gitemtotal.subTotal).toFixed(2) + "</span></h5></td></tr>";
                                                        }
                                                        else {
                                                            html += "<tr style='background-color: aliceblue' class='guestname Guestuser' id='" + result._cart.SplitCheck.Guestusers[i].guestid + "'><td colspan='3'><h5>" + result._cart.SplitCheck.Guestusers[i].Name + "<span class='pull-right cart_total' id='bound_" + result._cart.SplitCheck.Guestusers[i].guestid + "'>" + currency +"" + parseFloat(result._cart.SplitCheck.Guestusers[i].gitemtotal.subTotal).toFixed(2) + "</span></h5></td></tr>";
                                                        }
                                                    }
                                                    else {
                                                        if (result._cart.SplitCheck.Guestusers[i].isactive == true) {
                                                            html += "<tr style='background-color: aliceblue' class='guestname Guestuser guestactive' id='" + result._cart.SplitCheck.Guestusers[i].guestid + "'><td colspan='3'><h5>" + result._cart.SplitCheck.Guestusers[i].Name + "<span class='pull-right cart_total' id='bound_" + result._cart.SplitCheck.Guestusers[i].guestid + "'></span></h5></td></tr>";
                                                        }
                                                        else {
                                                            html += "<tr style='background-color: aliceblue' class='guestname Guestuser' id='" + result._cart.SplitCheck.Guestusers[i].guestid + "'><td colspan='3'><h5>" + result._cart.SplitCheck.Guestusers[i].Name + "<span class='pull-right cart_total' id='bound_" + result._cart.SplitCheck.Guestusers[i].guestid + "'></span></h5></td></tr>";
                                                        }
                                                    }
                                                    //html += "<tr style='background-color: aliceblue' class='guestname'><td colspan='3'><h5>" + result._cart.SplitCheck.Guestusers[i].Name + "<span class='pull-right cart_total' id='bound_" + result._cart.SplitCheck.Guestusers[i].guestid + "'>" + result._cart.SplitCheck.Guestusers[i].gitemtotal.subTotal + " (excluded all tax)</span></h5></td></tr>";
                                                }
                                                else {
                                                    if (result._cart.SplitCheck.Guestusers[i].gitemtotal != null && result._cart.SplitCheck.Guestusers[i].gitemtotal.subTotal != '0') {
                                                        if (result._cart.SplitCheck.Guestusers[i].isactive == true) {
                                                            html += "<tr style='background-color: aliceblue' class='guestname Guestuser guestactive' id='" + result._cart.SplitCheck.Guestusers[i].guestid + "'><td colspan='3'><h5>Guest" + parseInt(i + 1) + "<span class='pull-right cart_total' id='bound_" + result._cart.SplitCheck.Guestusers[i].guestid + "'>$" + parseFloat(result._cart.SplitCheck.Guestusers[i].gitemtotal.subTotal).toFixed(2) + "</span></h5></td></tr>";
                                                        }
                                                        else {
                                                            html += "<tr style='background-color: aliceblue' class='guestname Guestuser' id='" + result._cart.SplitCheck.Guestusers[i].guestid + "'><td colspan='3'><h5>Guest" + parseInt(i + 1) + "<span class='pull-right cart_total' id='bound_" + result._cart.SplitCheck.Guestusers[i].guestid + "'>$" + parseFloat(result._cart.SplitCheck.Guestusers[i].gitemtotal.subTotal).toFixed(2) + "</span></h5></td></tr>";
                                                        }
                                                    }
                                                    else {
                                                        if (result._cart.SplitCheck.Guestusers[i].isactive == true) {
                                                            html += "<tr style='background-color: aliceblue' class='guestname Guestuser guestactive' id='" + result._cart.SplitCheck.Guestusers[i].guestid + "'><td colspan='3'><h5>Guest" + parseInt(i + 1) + "<span class='pull-right cart_total' id='bound_" + result._cart.SplitCheck.Guestusers[i].guestid + "'></span></h5></td></tr>";
                                                        }
                                                        else {
                                                            html += "<tr style='background-color: aliceblue' class='guestname Guestuser' id='" + result._cart.SplitCheck.Guestusers[i].guestid + "'><td colspan='3'><h5>Guest" + parseInt(i + 1) + "<span class='pull-right cart_total' id='bound_" + result._cart.SplitCheck.Guestusers[i].guestid + "'></span></h5></td></tr>";
                                                        }
                                                    }
                                                }

                                                if (result._cart.SplitCheck.Guestusers[i].guestcartItems.length > 0) {
                                                    var allmodifierPrice = 0;
                                                    for (var j = 0; j < result._cart.SplitCheck.Guestusers[i].guestcartItems.length; j++) {
                                                        if (result._cart.SplitCheck.Guestusers[i].guestcartItems[j].isSent == false) {
                                                            flag = true;
                                                            html += "<tr class='cart_items' id='row_" + result._cart.SplitCheck.Guestusers[i].guestcartItems[j].cartItemId + "' boundguest='bound_" + result._cart.SplitCheck.Guestusers[i].guestid + "'><td class='cart_qty'>" + result._cart.SplitCheck.Guestusers[i].guestcartItems[j].qty + " ×</td><td class='cart_name'><span class='cart_title'>" + result._cart.SplitCheck.Guestusers[i].guestcartItems[j].itemName + "</span>";
                                                        }
                                                        else {
                                                            _issent = true;
                                                            html += "<tr class='cart_items oldrow' id='row_" + result._cart.SplitCheck.Guestusers[i].guestcartItems[j].cartItemId + "'><td class='cart_qty'>" + result._cart.SplitCheck.Guestusers[i].guestcartItems[j].qty + " ×</td><td class='cart_name'><span class='cart_title'>" + result._cart.SplitCheck.Guestusers[i].guestcartItems[j].itemName + "</span>";
                                                        }
                                                        html += "<span class='cart_info'>";
                                                        if (result._cart.SplitCheck.Guestusers[i].guestcartItems[j].modifiers != null && result._cart.SplitCheck.Guestusers[i].guestcartItems[j].modifiers.length > 0) {
                                                            html += "<br />";
                                                            for (var k = 0; k < result._cart.SplitCheck.Guestusers[i].guestcartItems[j].modifiers.length; k++) {
                                                                html += "<label> •" + result._cart.SplitCheck.Guestusers[i].guestcartItems[j].modifiers[k]._modName + "</label >";
                                                                allmodifierPrice = allmodifierPrice + result._cart.SplitCheck.Guestusers[i].guestcartItems[j].modifiers[k].price;
                                                                if (result._cart.SplitCheck.Guestusers[i].guestcartItems[j].modifiers[k].subMOD != null && result._cart.SplitCheck.Guestusers[i].guestcartItems[j].modifiers[k].subMOD.length > 0) {
                                                                    var submodifiersList = result._cart.SplitCheck.Guestusers[i].guestcartItems[j].modifiers[k].subMOD;
                                                                    for (var p = 0; p < submodifiersList.length; p++) {
                                                                        html += "<label> •" + submodifiersList[p]._modName + "</label >";
                                                                        allmodifierPrice = allmodifierPrice + submodifiersList[p].price;
                                                                    }
                                                                }
                                                            }
                                                            if (result._cart.SplitCheck.Guestusers[i].guestcartItems[j].specialInst != "" && result._cart.SplitCheck.Guestusers[i].guestcartItems[j].specialInst != null) {
                                                                html += "<br /><label><i> •" + result._cart.SplitCheck.Guestusers[i].guestcartItems[j].specialInst + "</i></label>";
                                                            }
                                                            html += "</span>";
                                                        }
                                                        if (result._cart.SplitCheck.Guestusers[i].guestcartItems[j].isSent == false) {
                                                            html += "<br /> <a id='" + result._cart.SplitCheck.Guestusers[i].guestcartItems[j].cartItemId + "' href='javascript:Remove(\"" + result._cart.SplitCheck.Guestusers[i].guestcartItems[j].cartItemId + "\")' class='remove_item'>Remove</a>";
                                                        }
                                                        if (result._cart.SplitCheck.Guestusers[i].guestcartItems[j].modifiers == null || result._cart.SplitCheck.Guestusers[i].guestcartItems[j].modifiers.length == 0) {
                                                            html += " </td > <td class='cart_price'>" + currency +"" + (result._cart.SplitCheck.Guestusers[i].guestcartItems[j].itemPrice * result._cart.SplitCheck.Guestusers[i].guestcartItems[j].qty).toFixed(2) + "</td></tr> ";
                                                        }
                                                        else {
                                                            html += " </td > <td class='cart_price'>" + currency + "" + (parseFloat(result._cart.SplitCheck.Guestusers[i].guestcartItems[j].itemPrice * result._cart.SplitCheck.Guestusers[i].guestcartItems[j].qty) + parseFloat(allmodifierPrice * result._cart.SplitCheck.Guestusers[i].guestcartItems[j].qty)).toFixed(2) + "</td></tr> ";
                                                        }
                                                        //html += " </td > <td class='cart_price'>$" + (result._cart.SplitCheck.Guestusers[i].guestcartItems[j].itemPrice * result._cart.SplitCheck.Guestusers[i].guestcartItems[j].qty).toFixed(2) + "</td></tr> ";
                                                    }
                                                }

                                            }

                                            // html += "<tr class='cart_items' id='row_" + result._cartItemId + "'><td class='cart_qty'>" + qty + " ×</td><td class='cart_name'><span class='cart_title'>" + itemname + "</span>";
                                        }
                                        if (_issent == true && flag == true) {

                                            $('#tblCart #tr_startover').css('display', 'none');

                                        }
                                        else if (_issent == false && flag == true) {

                                            $('#tblCart #tr_startover').show();
                                        }
                                        else {

                                            $('#tblCart #tr_startover').css('display', 'none');
                                        }
                                        $('#orderSend').show();
                                        $('#orderSend2').show();
                                        $('#checkouthide').hide();
                                        $('#orderSend2Dummy').hide();
                                        $('#orderSendDummy').hide();
                                        $('#orderSend2 a #guestcarttotal').html(currency + JSON.parse(data)._cart.total.subTotal.toFixed(2));
                                        $('#orderSend a #cartTotalDue').html(currency + JSON.parse(data)._cart.total.subTotal.toFixed(2));
                                        $('#guestcarttotal').html(currency + JSON.parse(data)._cart.total.subTotal.toFixed(2));
                                    }

                                    else {
                                        $('.cart_items').remove();
                                        $('.guestname').remove();
                                        if (result._cart.isGroupOrder == true)
                                         {
                                            //$('.proc').remove();
                                            $('.guestname').remove();
                                            $('[id^="row_"]').remove();
                                            if (result._cart.isHostUser) {
                                                if (result._cart.groupOrderUser != null) {
                                                   var  isPriceShow=false;

                                                    if (result._cart.groupOrderUser.Name != null) {

                                                        html += '<tr style="background-color: aliceblue" class="guestname collapsed" id="' + result._cart.groupOrderUser.summaryId + '">';
                                                        html += '<td colspan="3">';
                                                        html += '<h5>Your Cart';
                                                        if (result._cart.groupOrderUser.subTotal != '0') {
                                                            html += '<span class="pull-right cart_total" id = "bound_' + result._cart.groupOrderUser.summaryId + '" > ' + currency + "" + parseFloat(result._cart.groupOrderUser.subTotal).toFixed(2) + '</span >';
                                                        }
                                                        html += '</h5>';

                                                        html += '</td>';
                                                        html += '</tr>';
                                                    }
                                                    var CartItems = result._cart.groupOrderUser.LstCartItem;
                                                    for (var j = 0; j < CartItems.length; j++) {
                                                        var allmodifierPrice = 0;
                                                        isPriceShow=true;
                                                        flag = true;
                                                        html += "<tr class='cart_items' id='row_" + CartItems[j].GId + "'><td class='cart_qty'>" + CartItems[j].qty + " ×</td><td class='cart_name'><span class='cart_title'>" + CartItems[j].itemName + "</span>";
                                                        html += "<span class='cart_info'>";

                                                        if (CartItems[j].modifiers != null && CartItems[j].modifiers.length > 0) {
                                                            html += "<br />";
                                                            for (var k = 0; k < CartItems[j].modifiers.length; k++) {
                                                                html += "<label> •" + CartItems[j].modifiers[k]._modName + "</label >";
                                                                allmodifierPrice = allmodifierPrice + CartItems[j].modifiers[k].price;

                                                                if (CartItems[j].modifiers[k].subMOD != null && CartItems[j].modifiers[k].subMOD.length > 0) {
                                                                    var submodifiersList = CartItems[j].modifiers[k].subMOD;
                                                                    for (var p = 0; p < submodifiersList.length; p++) {
                                                                        html += "<label> •" + submodifiersList[p]._modName + "</label >";
                                                                        allmodifierPrice = allmodifierPrice + submodifiersList[p].price;
                                                                    }
                                                                }
                                                            }
                                                            if (CartItems[j].specialInst != "" && CartItems[j].specialInst != null) {
                                                                html += "<br /><label><i> •" + CartItems[j].specialInst + "</i></label>";
                                                            }

                                                        }
                                                        else {
                                                            if (CartItems[j].specialInst != "" && CartItems[j].specialInst != null) {
                                                                html += "<br /><label><i> •" + CartItems[j].specialInst + "</i></label>";
                                                            }
                                                        }
                                                        html += "</span>";
                                                        if (CartItems[j].isSent == false) {
                                                            html += "<br /> <a id='" + CartItems[j].GId + "' href='javascript:DeleteUserItem(\"" + CartItems[j].GId + "\")' class='remove_item'>Remove</a>";
                                                        }
                                                        if (CartItems[j].modifiers == null || CartItems[j].modifiers.length == 0) {
                                                            html += " </td > <td class='cart_price'>" + currency + "" + (CartItems[j].itemPrice * CartItems[j].qty).toFixed(2) + "</td></tr> ";
                                                        }
                                                        else {
                                                            html += " </td > <td class='cart_price'>" + currency + "" + (parseFloat(CartItems[j].itemPrice * CartItems[j].qty) + parseFloat(allmodifierPrice * CartItems[j].qty)).toFixed(2) + "</td></tr> ";
                                                        }
                                                    }

                                                    if (result._cart.groupOrderUser.LstGroupUsers != null && result._cart.groupOrderUser.LstGroupUsers.length > 0) {
                                                        for (var x = 0; x < result._cart.groupOrderUser.LstGroupUsers.length; x++) {

                                                            var GuestUser = result._cart.groupOrderUser.LstGroupUsers[x];

                                                            if (GuestUser.Name != null) {

                                                                html += '<tr style="background-color: aliceblue" class="guestname collapsed" id="' + GuestUser.summaryId + '">';
                                                                html += '<td colspan="3">';
                                                                html += '<h5>' + GuestUser.Name + '';
                                                                if (GuestUser.subTotal != '0') {
                                                                    html += '< span class="pull-right cart_total" id = "bound_' + GuestUser.summaryId + '" > ' + currency + "" + parseFloat(GuestUser.subTotal).toFixed(2) + '</span >';
                                                                }
                                                                     html += '</h5>';
                                                                html += '<i class="fa fa-trash ml-2" summaryId="' + GuestUser.summaryId + '" onclick="DeleteGroupOrder(\'' + GuestUser.summaryId + '\',\'' + GuestUser.Name +'\')" id="btn-DeleteGroupuser_' + GuestUser.summaryId + '"></i>';
                                                                html += '</td>';
                                                                html += '</tr>';
                                                            }
                                                            var GuestCartItems = GuestUser.LstCartItem;
                                                            if (GuestCartItems != null && GuestCartItems.length > 0) {
                                                                for (var j = 0; j < GuestCartItems.length; j++) {
                                                                    var allmodifierPrice = 0;

                                                                    flag = true;
                                                                    html += "<tr class='cart_items' id='row_" + GuestCartItems[j].GId + "'><td class='cart_qty'>" + GuestCartItems[j].qty + " ×</td><td class='cart_name'><span class='cart_title'>" + GuestCartItems[j].itemName + "</span>";
                                                                    html += "<span class='cart_info'>";

                                                                    if (GuestCartItems[j].modifiers != null && GuestCartItems[j].modifiers.length > 0) {
                                                                        html += "<br />";
                                                                        for (var k = 0; k < GuestCartItems[j].modifiers.length; k++) {
                                                                            html += "<label> •" + GuestCartItems[j].modifiers[k]._modName + "</label >";
                                                                            allmodifierPrice = allmodifierPrice + GuestCartItems[j].modifiers[k].price;

                                                                            if (GuestCartItems[j].modifiers[k].subMOD != null && GuestCartItems[j].modifiers[k].subMOD.length > 0) {
                                                                                var submodifiersList = GuestCartItems[j].modifiers[k].subMOD;
                                                                                for (var p = 0; p < submodifiersList.length; p++) {
                                                                                    html += "<label> •" + submodifiersList[p]._modName + "</label >";
                                                                                    allmodifierPrice = allmodifierPrice + submodifiersList[p].price;
                                                                                }
                                                                            }
                                                                        }
                                                                        if (GuestCartItems[j].specialInst != "" && GuestCartItems[j].specialInst != null) {
                                                                            html += "<br /><label><i> •" + GuestCartItems[j].specialInst + "</i></label>";
                                                                        }

                                                                    }
                                                                    else {
                                                                        if (GuestCartItems[j].specialInst != "" && GuestCartItems[j].specialInst != null) {
                                                                            html += "<br /><label><i> •" + GuestCartItems[j].specialInst + "</i></label>";
                                                                        }
                                                                    }
                                                                    html += "</span>";

                                                                    html += "<br /> <a id='" + GuestCartItems[j].GId + "' href='javascript:DeleteUserItem(\"" + GuestCartItems[j].GId + "\")' class='remove_item'>Remove</a>";

                                                                    if (GuestCartItems[j].modifiers == null || GuestCartItems[j].modifiers.length == 0) {
                                                                        html += " </td > <td class='cart_price'>" + currency + "" + (GuestCartItems[j].itemPrice * GuestCartItems[j].qty).toFixed(2) + "</td></tr> ";
                                                                    }
                                                                    else {
                                                                        html += " </td > <td class='cart_price'>" + currency + "" + (parseFloat(GuestCartItems[j].itemPrice * GuestCartItems[j].qty) + parseFloat(allmodifierPrice * GuestCartItems[j].qty)).toFixed(2) + "</td></tr> ";
                                                                    }
                                                                }
                                                            }

                                                        }
                                                    }
                                                }
                                                if(isPriceShow){
                                                     $('.total_price').show();
                                                     }
                                                     else
                                                     {
                                                          $('.total_price').hide();

                                                 }
                                            }
                                            else {
                                                if (result._cart.groupOrderUser != null) {
                                                    if (result._cart.groupOrderUser.LstGroupUsers != null && result._cart.groupOrderUser.LstGroupUsers.length > 0) {
                                                        for (var x = 0; x < result._cart.groupOrderUser.LstGroupUsers.length; x++) {

                                                            var GuestUser = result._cart.groupOrderUser.LstGroupUsers[x];

                                                            if (GuestUser.Name != null) {

                                                                html += '<tr style="background-color: aliceblue" class="guestname collapsed" id="' + GuestUser.summaryId + '">';
                                                                html += '<td colspan="3">';
                                                                html += '<h5>Your Cart';
                                                                if (GuestUser.subTotal != '0') {
                                                                    html += '<span class="pull-right cart_total" id="bound_' + GuestUser.summaryId + '">' + currency + "" + parseFloat(GuestUser.subTotal).toFixed(2) + '</span>';

                                                                }
                                                                html += '</h5>';

                                                                html += '</td>';
                                                                html += '</tr>';
                                                            }
                                                            var GuestCartItems = GuestUser.LstCartItem;
                                                            if (GuestCartItems != null && GuestCartItems.length > 0) {
                                                                for (var j = 0; j < GuestCartItems.length; j++) {
                                                                    var allmodifierPrice = 0;

                                                                    flag = true;
                                                                    html += "<tr class='cart_items' id='row_" + GuestCartItems[j].GId + "'><td class='cart_qty'>" + GuestCartItems[j].qty + " ×</td><td class='cart_name'><span class='cart_title'>" + GuestCartItems[j].itemName + "</span>";

                                                                    html += "<span class='cart_info'>";
                                                                    if (GuestCartItems[j].modifiers != null && GuestCartItems[j].modifiers.length > 0) {
                                                                        html += "<br />";
                                                                        for (var k = 0; k < GuestCartItems[j].modifiers.length; k++) {
                                                                            html += "<label> •" + GuestCartItems[j].modifiers[k]._modName + "</label >";
                                                                            allmodifierPrice = allmodifierPrice + GuestCartItems[j].modifiers[k].price;

                                                                            if (GuestCartItems[j].modifiers[k].subMOD != null && GuestCartItems[j].modifiers[k].subMOD.length > 0) {
                                                                                var submodifiersList = GuestCartItems[j].modifiers[k].subMOD;
                                                                                for (var p = 0; p < submodifiersList.length; p++) {
                                                                                    html += "<label> •" + submodifiersList[p]._modName + "</label >";
                                                                                    allmodifierPrice = allmodifierPrice + submodifiersList[p].price;
                                                                                }
                                                                            }
                                                                        }
                                                                        if (GuestCartItems[j].specialInst != "" && GuestCartItems[j].specialInst != null) {
                                                                            html += "<br /><label><i> •" + GuestCartItems[j].specialInst + "</i></label>";
                                                                        }

                                                                    }
                                                                    else {
                                                                        if (GuestCartItems[j].specialInst != "" && GuestCartItems[j].specialInst != null) {
                                                                            html += "<br /><label><i> •" + GuestCartItems[j].specialInst + "</i></label>";
                                                                        }
                                                                    }
                                                                    html += "</span>";

                                                                    html += "<br /> <a id='" + GuestCartItems[j].GId + "' href='javascript:DeleteUserItem(\"" + GuestCartItems[j].GId + "\")' class='remove_item'>Remove</a>";

                                                                    if (GuestCartItems[j].modifiers == null || GuestCartItems[j].modifiers.length == 0) {
                                                                        html += " </td > <td class='cart_price'>" + currency + "" + (GuestCartItems[j].itemPrice * GuestCartItems[j].qty).toFixed(2) + "</td></tr> ";
                                                                    }
                                                                    else {
                                                                        html += " </td > <td class='cart_price'>" + currency + "" + (parseFloat(GuestCartItems[j].itemPrice * GuestCartItems[j].qty) + parseFloat(allmodifierPrice * GuestCartItems[j].qty)).toFixed(2) + "</td></tr> ";
                                                                    }
                                                                }
                                                                html += '<tr  class="guestname" id="' + GuestUser.summaryId + '">';
                                                                html += '<td colspan="3">';
                                                                html += "<a id='" + GuestUser.summaryId + "' href='javascript: SubmitGroupOrder(\"" + GuestUser.summaryId + "\")' class='pull-left submitOrder'>Submit Your Order</a>";
                                                                html += "<a id='" + GuestUser.summaryId + "' href='javascript: DeleteGroupOrder(\"" + GuestUser.summaryId + "\")' class='pull-right leaveOrder'>Leave Group Order</a>";

                                                                html += '</td>';
                                                                html += '</tr>';
                                                            }

                                                        }
                                                    }
                                                }
                                            }
                                        }
                                        else {
                                        var CartItems = result._cart.cartItems;
                                        for (var j = 0; j < CartItems.length; j++) {
                                            var allmodifierPrice = 0;
                                            if (CartItems[j].isSent == false) {
                                                flag = true;
                                                html += "<tr class='cart_items' id='row_" + CartItems[j].cartItemId + "'><td class='cart_qty'>" + CartItems[j].qty + " ×</td><td class='cart_name'><span class='cart_title'>" + CartItems[j].itemName + "</span>";
                                            }
                                            else {
                                                _issent = true;
                                                html += "<tr class='cart_items oldrow' id='row_" + CartItems[j].cartItemId + "'><td class='cart_qty'>" + CartItems[j].qty + " ×</td><td class='cart_name'><span class='cart_title'>" + CartItems[j].itemName + "</span>";
                                            }
                                            html += "<span class='cart_info'>";
                                            if (CartItems[j].modifiers != null && CartItems[j].modifiers.length > 0) {
                                                html += "<br />";
                                                for (var k = 0; k < CartItems[j].modifiers.length; k++) {
                                                    html += "<label> •" + CartItems[j].modifiers[k]._modName + "</label >";
                                                    allmodifierPrice = allmodifierPrice + CartItems[j].modifiers[k].price;

                                                    if (CartItems[j].modifiers[k].subMOD != null && CartItems[j].modifiers[k].subMOD.length > 0) {
                                                        var submodifiersList = CartItems[j].modifiers[k].subMOD;
                                                        for (var p = 0; p < submodifiersList.length; p++) {
                                                            html += "<label> •" + submodifiersList[p]._modName + "</label >";
                                                            allmodifierPrice = allmodifierPrice + submodifiersList[p].price;
                                                        }
                                                    }
                                                }
                                                if (CartItems[j].specialInst != "" && CartItems[j].specialInst != null) {
                                                    html += "<br /><label><i> •" + CartItems[j].specialInst + "</i></label>";
                                                }

                                            }
                                            else {
                                                if (CartItems[j].specialInst != "" && CartItems[j].specialInst != null) {
                                                    html += "<br /><label><i> •" + CartItems[j].specialInst + "</i></label>";
                                                }
                                            }
                                            html += "</span>";
                                            if (CartItems[j].isSent == false) {
                                                html += "<br /> <a id='" + CartItems[j].cartItemId + "' href='javascript:Remove(\"" + CartItems[j].cartItemId + "\")' class='remove_item'>Remove</a>";
                                            }
                                            if (CartItems[j].modifiers == null || CartItems[j].modifiers.length == 0) {
                                                html += " </td > <td class='cart_price'>" + currency + "" + (CartItems[j].itemPrice * CartItems[j].qty).toFixed(2) + "</td></tr> ";
                                            }
                                            else {
                                                html += " </td > <td class='cart_price'>" + currency + "" + (parseFloat(CartItems[j].itemPrice * CartItems[j].qty) + parseFloat(allmodifierPrice * CartItems[j].qty)).toFixed(2) + "</td></tr> ";
                                            }
                                        }
                                      }
                                        $('#orderSend').show();
                                        $('#orderSend2').show();

                                        $('#orderSend2 a #orderSend').html(currency + JSON.parse(data)._cart.total.subTotal.toFixed(2));
                                        $('.total_price #cartTotalDue').html(currency + JSON.parse(data)._cart.total.subTotal.toFixed(2));
                                        $('#orderSend a #cartTotalDue').html(currency + JSON.parse(data)._cart.total.subTotal.toFixed(2));
                                        $('#orderSend2Dummy').hide();
                                        $('#orderSendDummy').hide();

                                    }

                                    $('#tblCart').append(html);
                                    if (JSON.parse(data)._cart.minValue < JSON.parse(data)._cart.total.subTotal.toFixed(2)) {

                                        $('.total_price>td #minVal').attr('href', 'javascript:Checkout()');
                                        $('.total_price>td #minVal').html('Checkout <span class="pull-right cart_total" id="cartTotalDue">' + currency+'' + JSON.parse(data)._cart.total.totalDue.toFixed(2) + '</span>');
                                        $('#cartTotalDue').html(currency + JSON.parse(data)._cart.total.subTotal.toFixed(2));

                                    }
                                    else if (JSON.parse(data)._cart.minValue > JSON.parse(data)._cart.total.subTotal.toFixed(2)) {

                                        if ($('#minVal').length > 0) {
                                            $('.total_price>td #minVal').attr('href', '#');
                                            $('.total_price>td #minVal').html('Minimum Order: <span class="pull-right cart_total" id="cartTotalDue">' + currency+'' + JSON.parse(data)._cart.minValue.toFixed(2) + '</span>');
                                        }
                                        else {
                                            $('a[href="javascript:Checkout()"]').attr('href', '#');
                                            $('a[href="javascript:Checkout()"]').html('Minimum Order: <span class="pull-right cart_total" id="cartTotalDue">' + currency+'' + JSON.parse(data)._cart.minValue.toFixed(2) + '</span>');
                                        }
                                        $('#cartTotalDue').html(currency + JSON.parse(data)._cart.minValue.toFixed(2));
                                    }
                                    if ($("#tblCart #checkouthide").is(":visible")) {
                                        $('#tblCart tr#checkouthide').css('display', 'none');
                                    }
                                    $('#checkouthide').css('display', 'none');

                                    $('#product_modal-' + itemId).modal('hide');
                                    $('#qty_' + itemId).val('1');
                                    $('#instr_' + itemId).val('');

                                    $('#cartTotalDue').html(currency + JSON.parse(data)._cart.total.subTotal.toFixed(2));

                                    $('.total_price').show();

                                    $('#noItems').hide();

                                    $('.qty').text(JSON.parse(data).qty);
                                    if ((result._cart.SplitCheck != null && result._cart.SplitCheck.GuestCount == 1) || result._cart.SplitCheck == null) {
                                        $('.Guestuser .cart_total').html(currency + JSON.parse(data)._cart.total.subTotal.toFixed(2));

                                    }
                                    if (JSON.parse(data)._cart.isGroupOrder == true && JSON.parse(data)._cart.isHostUser==false) {
                                        $('#orderSend').hide();
                                        $('#orderSend2').hide();
                                        $('#orderSend2 a #orderSend').hide();
                                        $('.total_price #cartTotalDue').hide();
                                        $('#orderSend a #cartTotalDue').hide();
                                        $('#orderSend2Dummy').hide();
                                        $('#orderSendDummy').hide();
                                        $('.Guestuser .cart_total').hide();
                                         $('.total_price').hide();
                                    }
                                    disableSyncCart=false;
                                }
                                else {
                                    $('#product_modal-' + itemId).modal('hide');
                                    $('#promo-modal').modal('show');
                                    $('#btn_checkout').removeClass('disable');
                                    $('.btn_dineCheckout').removeClass('disable');
                                    $('.btn_sendorder').removeClass('disable');
                                    $('#promo-modal #lblMessage').html(JSON.parse(data).responseMessage);
                                    $('#loader').hide();
                                    return false;
                                }
                                $('#btn_checkout').removeClass('disable');
                                $('.btn_dineCheckout').removeClass('disable');
                                $('.btn_sendorder').removeClass('disable');
                                //$('#orderSend').removeClass('disable');
                                //$('#orderSend2').removeClass('disable');
                            },
                            error: function (jqXHR, textStatus, errorThrown) {
                                $('#loader').hide();
                                $('#btn_checkout').removeClass('disable');
                                $('.btn_dineCheckout').removeClass('disable');
                                $('.btn_sendorder').removeClass('disable');
                                //$('#orderSend').removeClass('disable');
                                  //$('#orderSend2').removeClass('disable');
                                if (jqXHR.status == 404 || errorThrown == 'Not Found') {
                                    $('#promo-modal').modal('show');
                                    $('#promo-modal #lblMessage').html('<h4>Oops something happened , please contact store directly</h4>');

                                    setTimeout(function () {
                                        $('#promo-modal').modal('hide');
                                        location.href = "/WelcomePage";
                                    }, 3000);
                                }
                            }
                        });

                    }

                }


               function AddToCart(itemId, itemname, price) {
                   disableSyncCart=true;
                 var submodifiercheckflag = true;

                    $('#btn-' + itemId).addClass('processing-cart button.btn.btn-primary.add_to_cart');
                    var qty = $('#qty_' + itemId).val();
                    if (qty == 0) {
                        return false;
                    }

                    var instr = $('[id^="instr_' + itemId + '"]').val();
                    if (instr == 'undefined') instr = '';

                    var itemTotalprice = $('.ChangePrice-' + itemId).html();
                    var CheckRequired = $(".ConditioncheckStatus1-" + itemId).val();
                    var CheckRequired1 = $(".ConditioncheckStatus1-" + itemId).map(function () {
                        return this.value;
                    }).get();

                    var ModifigrpId = $('.ModifiyGrpId-' + itemId).map(function () {
                        return this.value;
                    }).get();

                    if (ModifigrpId.length > 0) {


                        $('#product_modal-' + itemId + ' .ModifierParent').each(function (index) {

                            //var obj = $(this).parent();
                            var CheckRequired = $(this).parent().children(".CheckType").val();
                            var ModifiGrpName = $(this).parent().children(".ModifierParent").val();
                            if (ModifigrpId.includes(ModifiGrpName)) {
                                if (CheckRequired == "Requird") {
                                    var minval = $(this).parent().children(".ModifierMinQty").val();
                                    var numberOfChecked = $('.CheckbocCheckVal-' + itemId + '-' + ModifiGrpName + ':checkbox:checked').length;
                                    if (parseInt(numberOfChecked) < parseInt(minval)) {
                                        $('#promo-modal').modal('show');
                                        $('#promo-modal #lblMessage').html('Please select atleast ' + minval + '&nbsp; <b> ' + ModifiGrpName.replaceAll('_', ' ') + '</b>');
                                        $('#loader').hide();
                                        submodifiercheckflag = false;
                                        return false;
                                    }
                                }
                            }
                        });
                        if (submodifiercheckflag) {
                            $(".Checkrequired").each(function (index) {

                                //var obj = $(this).parent();
                                var CheckRequired = $(this).parent().children(".Checkrequired").val();
                                var ModifiGrpName = $(this).parent().children(".GroupName").val();
                                if ($(this).parent().parent().parent().parent().children('.form-check-label').children('input').prop('checked')) {
                                    if (CheckRequired == "Requird") {
                                        var submodifierid = $(this).parent().children(".Checkrequired").attr('submodifierId');
                                        //alert(submodifierid);
                                        var minval = $(this).parent().children(".minQty").val();
                                        var numberOfChecked = $('.CheckbocCheckVal-' + submodifierid + '-' + ModifiGrpName + ':checkbox:checked').length;
                                        if (parseInt(numberOfChecked) < parseInt(minval)) {
                                            $('#promo-modal').modal('show');
                                            $('#promo-modal #lblMessage').html('Please select atleast ' + minval + ' &nbsp; <b> ' + ModifiGrpName.replaceAll('_',' ')+'</b>');
                                            $('#loader').hide();
                                            submodifiercheckflag = false;
                                            return false;
                                        }
                                    }
                                }
                            });
                        }

                    }
                    else {
                        var minval = $(".minOrderval1-" + itemId).val();
                        var numberOfChecked = $('.' + itemId + ':checked').length;
                        // alert(numberOfChecked);
                        if (parseInt(numberOfChecked) < parseInt(minval)) {
                            $('#promo-modal').modal('show');
                            $('#promo-modal #lblMessage').html('Please select atleast ' + minval);
                            $('#loader').hide();
                            return false;
                        }
                    }
                    if (submodifiercheckflag) {
                        var ItemPrice = price;
                        $('#btn_checkout').addClass('disable');
                        $('#product_modal-' + itemId).modal('hide');
                        $('.btn_sendorder').addClass('disable');

                        $('.btn_dineCheckout').addClass('disable');

                        price = $("#PriceTotalValue-" + itemId).val();
                        // price = $("#PriceTotalValue-" + itemId).val();

                        var checkedVals = $('.' + itemId + ':checkbox:checked').map(function () {
                            return this.value;
                        }).get();
                        checkedVals.join("•");
                        var checkedbutton = $('.' + itemId + ':radio:checked').map(function () {
                            return this.value;
                        }).get();
                        checkedbutton.join("•");


                        var checkedNames = $('.' + itemId + ':checkbox:checked').map(function () {
                            var ModId = '#' + itemId + '-' + this.id;

                            return '{"Id":"' + this.id + '", "_modName": "' + this.value.replaceAll('"','(*dq)') + '","price":"' + this.attributes[2].value + '"}';
                            //return '{"Id":"' + this.id + '", "_modName": "' + this.value + '","price":"' + GetModifierPrice(itemId)  +'"}';
                        }).get();

                        checkedNames.join(",");

                        var checkedNamebutton = $('.' + itemId + ':radio:checked').map(function () {
                            var ModId = '#' + itemId + '-' + this.id;

                            return '{"Id":"' + this.id + '", "_modName": "' + this.value.replaceAll('"', '(*dq)') + '","price":"' + this.attributes[5].value + '"}';
                            //return '{"id":"' + this.id + '", "_modName": "' + this.value + '","price":"' + GetModifierPrice(itemId) + '"}';
                        }).get();

                        checkedNamebutton.join(",");
                        $.each($("[id^='product_modal'] input"), function () {
                            $(this).prop('checked', false);
                        });
                        // $('.ChangePrice-' + itemId).text(currency + ItemPrice);

                        // $('.ChangePrice-' + itemId).text('$' + ItemPrice);
                        //alert('[' + checkedNamebutton + ', ' + checkedNames + ']');
                        var Extras = '[' + checkedNamebutton + ', ' + checkedNames + ']';

                        $.ajax({
                            type: 'get',
                            url: '/Index?handler=AddToCart',
                            //url: '/Index?handler=AddToCart&itemId=' + itemId + '&qty=' + qty + '&price=' + price + '&Name=' + itemname + '&Extras=[' + checkedNamebutton + ',' + checkedNames + ']&Instr=' + instr ,
                            data: { "itemId": itemId, "qtyD": qty, "price": price, "Name": itemname, "Extras": Extras, "Instr": instr },
                            contentType: 'application/json;charset=utf-8',
                            dataType: 'json',

                            success: function (data) {
                                //console.log(data);
                                var result = JSON.parse(data);

                                if (JSON.parse(data).responseMessage == "" || JSON.parse(data).responseMessage == null) {
                                    $('#loader').hide();
                                    var currency = '$';
                                    if (result.ordertype == "Dinein") {
                                        //alert(result.ordertype);

                                        var _issent = false;
                                        var flag = false;
                                        $('.guestname').remove();
                                        $('.cart_items').remove();
                                        $('.btn_checkout').hide();
                                        if (result._cart.SplitCheck.GuestCount > 0) {
                                            var html = '';
                                            for (var i = 0; i < result._cart.SplitCheck.Guestusers.length; i++) {

                                                if (result._cart.SplitCheck.Guestusers[i].Name != null) {

                                                    if (result._cart.SplitCheck.Guestusers[i].gitemtotal != null && result._cart.SplitCheck.Guestusers[i].gitemtotal.subTotal != '0') {
                                                        if (result._cart.SplitCheck.Guestusers[i].isactive == true) {
                                                            html += "<tr style='background-color: aliceblue' class='guestname Guestuser guestactive' id='" + result._cart.SplitCheck.Guestusers[i].guestid + "'><td colspan='3'><h5>" + result._cart.SplitCheck.Guestusers[i].Name + "<span class='pull-right cart_total' id='bound_" + result._cart.SplitCheck.Guestusers[i].guestid + "'>" + currency + "" + parseFloat(result._cart.SplitCheck.Guestusers[i].gitemtotal.subTotal).toFixed(2) + "</span></h5></td></tr>";
                                                        }
                                                        else {
                                                            html += "<tr style='background-color: aliceblue' class='guestname Guestuser' id='" + result._cart.SplitCheck.Guestusers[i].guestid + "'><td colspan='3'><h5>" + result._cart.SplitCheck.Guestusers[i].Name + "<span class='pull-right cart_total' id='bound_" + result._cart.SplitCheck.Guestusers[i].guestid + "'>" + currency + "" + parseFloat(result._cart.SplitCheck.Guestusers[i].gitemtotal.subTotal).toFixed(2) + "</span></h5></td></tr>";
                                                        }
                                                    }
                                                    else {
                                                        if (result._cart.SplitCheck.Guestusers[i].isactive == true) {
                                                            html += "<tr style='background-color: aliceblue' class='guestname Guestuser guestactive' id='" + result._cart.SplitCheck.Guestusers[i].guestid + "'><td colspan='3'><h5>" + result._cart.SplitCheck.Guestusers[i].Name + "<span class='pull-right cart_total' id='bound_" + result._cart.SplitCheck.Guestusers[i].guestid + "'></span></h5></td></tr>";
                                                        }
                                                        else {
                                                            html += "<tr style='background-color: aliceblue' class='guestname Guestuser' id='" + result._cart.SplitCheck.Guestusers[i].guestid + "'><td colspan='3'><h5>" + result._cart.SplitCheck.Guestusers[i].Name + "<span class='pull-right cart_total' id='bound_" + result._cart.SplitCheck.Guestusers[i].guestid + "'></span></h5></td></tr>";
                                                        }
                                                    }
                                                    //html += "<tr style='background-color: aliceblue' class='guestname'><td colspan='3'><h5>" + result._cart.SplitCheck.Guestusers[i].Name + "<span class='pull-right cart_total' id='bound_" + result._cart.SplitCheck.Guestusers[i].guestid + "'>" + result._cart.SplitCheck.Guestusers[i].gitemtotal.subTotal + " (excluded all tax)</span></h5></td></tr>";
                                                }
                                                else {
                                                    if (result._cart.SplitCheck.Guestusers[i].gitemtotal != null && result._cart.SplitCheck.Guestusers[i].gitemtotal.subTotal != '0') {
                                                        if (result._cart.SplitCheck.Guestusers[i].isactive == true) {
                                                            html += "<tr style='background-color: aliceblue' class='guestname Guestuser guestactive' id='" + result._cart.SplitCheck.Guestusers[i].guestid + "'><td colspan='3'><h5>Guest" + parseInt(i + 1) + "<span class='pull-right cart_total' id='bound_" + result._cart.SplitCheck.Guestusers[i].guestid + "'>" + currency + "" + parseFloat(result._cart.SplitCheck.Guestusers[i].gitemtotal.subTotal).toFixed(2) + "</span></h5></td></tr>";
                                                        }
                                                        else {
                                                            html += "<tr style='background-color: aliceblue' class='guestname Guestuser' id='" + result._cart.SplitCheck.Guestusers[i].guestid + "'><td colspan='3'><h5>Guest" + parseInt(i + 1) + "<span class='pull-right cart_total' id='bound_" + result._cart.SplitCheck.Guestusers[i].guestid + "'>" + currency + "" + parseFloat(result._cart.SplitCheck.Guestusers[i].gitemtotal.subTotal).toFixed(2) + "</span></h5></td></tr>";
                                                        }
                                                    }
                                                    else {
                                                        if (result._cart.SplitCheck.Guestusers[i].isactive == true) {
                                                            html += "<tr style='background-color: aliceblue' class='guestname Guestuser guestactive' id='" + result._cart.SplitCheck.Guestusers[i].guestid + "'><td colspan='3'><h5>Guest" + parseInt(i + 1) + "<span class='pull-right cart_total' id='bound_" + result._cart.SplitCheck.Guestusers[i].guestid + "'></span></h5></td></tr>";
                                                        }
                                                        else {
                                                            html += "<tr style='background-color: aliceblue' class='guestname Guestuser' id='OLOGuest" + result._cart.SplitCheck.Guestusers[i].guestid + "'><td colspan='3'><h5>Guest" + parseInt(i + 1) + "<span class='pull-right cart_total' id='bound_" + result._cart.SplitCheck.Guestusers[i].guestid + "'></span></h5></td></tr>";
                                                        }
                                                    }
                                                }
                                                if (result._cart.SplitCheck.Guestusers[i].guestcartItems.length > 0) {
                                                    //if (result._cart.SplitCheck.Guestusers[i].Name != null) {
                                                    //    html += "<tr style='background-color: aliceblue' class='guestname'><td colspan='3'><h5>" + result._cart.SplitCheck.Guestusers[i].Name + "<span class='pull-right cart_total' id='bound_" + result._cart.SplitCheck.Guestusers[i].guestid + "'>" + result._cart.SplitCheck.Guestusers[i].gitemtotal.subTotal + " (excluded all tax)</span></h5></td></tr>";
                                                    //}
                                                    //else {
                                                    //    html += "<tr style='background-color: aliceblue' class='guestname'><td colspan='3'><h5>Guest" + parseInt(i+1) + "<span class='pull-right cart_total' id='bound_" + result._cart.SplitCheck.Guestusers[i].guestid + "'>" + result._cart.SplitCheck.Guestusers[i].gitemtotal.subTotal + " (excluded all tax)</span></h5></td></tr>";
                                                    //}

                                                    for (var j = 0; j < result._cart.SplitCheck.Guestusers[i].guestcartItems.length; j++) {
                                                        var allmodifierPrice = 0;
                                                        if (result._cart.SplitCheck.Guestusers[i].guestcartItems[j].isSent == false) {
                                                            flag = true;
                                                            html += "<tr class='cart_items' id='row_" + result._cart.SplitCheck.Guestusers[i].guestcartItems[j].cartItemId + "' boundguest='bound_" + result._cart.SplitCheck.Guestusers[i].guestid + "'><td class='cart_qty'>" + result._cart.SplitCheck.Guestusers[i].guestcartItems[j].qty + " ×</td><td class='cart_name'><span class='cart_title'>" + result._cart.SplitCheck.Guestusers[i].guestcartItems[j].itemName + "</span>";
                                                        }
                                                        else {
                                                            _issent = true;
                                                            html += "<tr class='cart_items oldrow' id='row_" + result._cart.SplitCheck.Guestusers[i].guestcartItems[j].cartItemId + "'><td class='cart_qty'>" + result._cart.SplitCheck.Guestusers[i].guestcartItems[j].qty + " ×</td><td class='cart_name'><span class='cart_title'>" + result._cart.SplitCheck.Guestusers[i].guestcartItems[j].itemName + "</span>";
                                                        }
                                                        html += "<span class='cart_info'>";
                                                        if (result._cart.SplitCheck.Guestusers[i].guestcartItems[j].modifiers != null && result._cart.SplitCheck.Guestusers[i].guestcartItems[j].modifiers.length > 0) {
                                                            html += "<br />";
                                                            for (var k = 0; k < result._cart.SplitCheck.Guestusers[i].guestcartItems[j].modifiers.length; k++) {
                                                                html += "<label> •" + result._cart.SplitCheck.Guestusers[i].guestcartItems[j].modifiers[k]._modName + "</label >";
                                                                allmodifierPrice = allmodifierPrice + result._cart.SplitCheck.Guestusers[i].guestcartItems[j].modifiers[k].price;

                                                                if (result._cart.SplitCheck.Guestusers[i].guestcartItems[j].modifiers[k].subMOD != null && result._cart.SplitCheck.Guestusers[i].guestcartItems[j].modifiers[k].subMOD.length > 0) {
                                                                    var submodifiersList = result._cart.SplitCheck.Guestusers[i].guestcartItems[j].modifiers[k].subMOD;
                                                                    for (var p = 0; p < submodifiersList.length; p++) {
                                                                        html += "<label> •" + submodifiersList[p]._modName + "</label >";
                                                                        allmodifierPrice = allmodifierPrice + submodifiersList[p].price;
                                                                    }
                                                                }
                                                            }
                                                            if (result._cart.SplitCheck.Guestusers[i].guestcartItems[j].specialInst != "" && result._cart.SplitCheck.Guestusers[i].guestcartItems[j].specialInst != null) {
                                                                html += "<br /><label><i> •" + result._cart.SplitCheck.Guestusers[i].guestcartItems[j].specialInst + "</i></label>";
                                                            }

                                                        }
                                                        else {
                                                            if (result._cart.SplitCheck.Guestusers[i].guestcartItems[j].specialInst != "" && result._cart.SplitCheck.Guestusers[i].guestcartItems[j].specialInst != null) {
                                                                html += "<br /><label><i> •" + result._cart.SplitCheck.Guestusers[i].guestcartItems[j].specialInst + "</i></label>";
                                                            }
                                                        }
                                                        html += "</span>";
                                                        if (result._cart.SplitCheck.Guestusers[i].guestcartItems[j].isSent == false) {
                                                            html += "<br /> <a id='" + result._cart.SplitCheck.Guestusers[i].guestcartItems[j].cartItemId + "' href='javascript:Remove(\"" + result._cart.SplitCheck.Guestusers[i].guestcartItems[j].cartItemId + "\")' class='remove_item'>Remove</a>";
                                                        }
                                                        if (result._cart.SplitCheck.Guestusers[i].guestcartItems[j].modifiers == null || result._cart.SplitCheck.Guestusers[i].guestcartItems[j].modifiers.length == 0) {
                                                            html += " </td > <td class='cart_price'>" + currency + "" + (result._cart.SplitCheck.Guestusers[i].guestcartItems[j].itemPrice * result._cart.SplitCheck.Guestusers[i].guestcartItems[j].qty).toFixed(2) + "</td></tr> ";
                                                        }
                                                        else {
                                                            html += " </td > <td class='cart_price'>" + currency + "" + (parseFloat(result._cart.SplitCheck.Guestusers[i].guestcartItems[j].itemPrice * result._cart.SplitCheck.Guestusers[i].guestcartItems[j].qty) + parseFloat(allmodifierPrice * result._cart.SplitCheck.Guestusers[i].guestcartItems[j].qty)).toFixed(2) + "</td></tr> ";
                                                        }
                                                    }
                                                }

                                            }

                                            // html += "<tr class='cart_items' id='row_" + result._cartItemId + "'><td class='cart_qty'>" + qty + " ×</td><td class='cart_name'><span class='cart_title'>" + itemname + "</span>";
                                        }

                                        if (_issent == true && flag == true) {

                                            $('#tblCart #tr_startover').css('display', 'none');

                                        }
                                        else if (_issent == false && flag == true) {

                                            $('#tblCart #tr_startover').show();
                                        }
                                        else {

                                            $('#tblCart #tr_startover').css('display', 'none');
                                        }
                                        $('#orderSend').show();
                                        $('#orderSend2').show();
                                        $('#checkouthide').hide();
                                        $('#orderSend2Dummy').hide();
                                        $('#orderSendDummy').hide();
                                        $('.total_price #cartTotalDue').html(currency + JSON.parse(data)._cart.total.subTotal.toFixed(2));
                                        $('#orderSend2 a #guestcarttotal').html(currency + JSON.parse(data)._cart.total.subTotal.toFixed(2));
                                        $('#orderSend2 a #orderSend').html(currency + JSON.parse(data)._cart.total.subTotal.toFixed(2));
                                        $('#orderSend a #cartTotalDue').html(currency + JSON.parse(data)._cart.total.subTotal.toFixed(2));
                                        $('#guestcarttotal').html(currency + JSON.parse(data)._cart.total.subTotal.toFixed(2));
                                        //alert(_issent + ', ' + flag);

                                    }
                                    else {
                                            $('.cart_items').remove();
                                            $('.guestname').remove();
                                         if (result._cart.isGroupOrder == true)
                                         {
                                            //$('.proc').remove();
                                            $('.guestname').remove();
                                            $('[id^="row_"]').remove();
                                            if (result._cart.isHostUser) {
                                                if (result._cart.groupOrderUser != null) {
                                                    var isPriceShow=false;

                                                    if (result._cart.groupOrderUser.Name != null) {

                                                        html += '<tr style="background-color: aliceblue" class="guestname collapsed" id="' + result._cart.groupOrderUser.summaryId + '">';
                                                        html += '<td colspan="3">';
                                                        html += '<h5>Your Cart';
                                                        if (result._cart.groupOrderUser.subTotal != '0') {
                                                            html += '<span class="pull-right cart_total" id = "bound_' + result._cart.groupOrderUser.summaryId + '" > ' + currency + "" + parseFloat(result._cart.groupOrderUser.subTotal).toFixed(2) + '</span >';
                                                        }
                                                        html += '</h5>';
                                                        html += '</td>';
                                                        html += '</tr>';
                                                    }

                                                    var CartItems = result._cart.groupOrderUser.LstCartItem;
                                                    for (var j = 0; j < CartItems.length; j++) {
                                                        var allmodifierPrice = 0;
                                                        isPriceShow=true;
                                                        flag = true;
                                                        html += "<tr class='cart_items' id='row_" + CartItems[j].GId + "'><td class='cart_qty'>" + CartItems[j].qty + " ×</td><td class='cart_name'><span class='cart_title'>" + CartItems[j].itemName + "</span>";

                                                        html += "<span class='cart_info'>";
                                                        if (CartItems[j].modifiers != null && CartItems[j].modifiers.length > 0) {
                                                            html += "<br />";
                                                            for (var k = 0; k < CartItems[j].modifiers.length; k++) {
                                                                html += "<label> •" + CartItems[j].modifiers[k]._modName + "</label >";
                                                                allmodifierPrice = allmodifierPrice + CartItems[j].modifiers[k].price;

                                                                if (CartItems[j].modifiers[k].subMOD != null && CartItems[j].modifiers[k].subMOD.length > 0) {
                                                                    var submodifiersList = CartItems[j].modifiers[k].subMOD;
                                                                    for (var p = 0; p < submodifiersList.length; p++) {
                                                                        html += "<label> •" + submodifiersList[p]._modName + "</label >";
                                                                        allmodifierPrice = allmodifierPrice + submodifiersList[p].price;
                                                                    }
                                                                }
                                                            }
                                                            if (CartItems[j].specialInst != "" && CartItems[j].specialInst != null) {
                                                                html += "<br /><label><i> •" + CartItems[j].specialInst + "</i></label>";
                                                            }

                                                        }
                                                        else {
                                                            if (CartItems[j].specialInst != "" && CartItems[j].specialInst != null) {
                                                                html += "<br /><label><i> •" + CartItems[j].specialInst + "</i></label>";
                                                            }
                                                        }
                                                        html += "</span>";
                                                        if (CartItems[j].isSent == false) {
                                                            html += "<br /> <a id='" + CartItems[j].GId + "' href='javascript:DeleteUserItem(\"" + CartItems[j].GId + "\")' class='remove_item'>Remove</a>";
                                                        }
                                                        if (CartItems[j].modifiers == null || CartItems[j].modifiers.length == 0) {
                                                            html += " </td > <td class='cart_price'>" + currency + "" + (CartItems[j].itemPrice * CartItems[j].qty).toFixed(2) + "</td></tr> ";
                                                        }
                                                        else {
                                                            html += " </td > <td class='cart_price'>" + currency + "" + (parseFloat(CartItems[j].itemPrice * CartItems[j].qty) + parseFloat(allmodifierPrice * CartItems[j].qty)).toFixed(2) + "</td></tr> ";
                                                        }
                                                    }

                                                    if (result._cart.groupOrderUser.LstGroupUsers != null && result._cart.groupOrderUser.LstGroupUsers.length > 0) {
                                                        for (var x = 0; x < result._cart.groupOrderUser.LstGroupUsers.length; x++) {

                                                            var GuestUser = result._cart.groupOrderUser.LstGroupUsers[x];

                                                            if (GuestUser.Name != null) {

                                                                html += '<tr style="background-color: aliceblue" class="guestname collapsed" id="' + GuestUser.summaryId + '">';
                                                                html += '<td colspan="3">';
                                                                html += '<h5>' + GuestUser.Name + '';
                                                                if (GuestUser.subTotal != '0') {
                                                                    html += '<span class="pull-right cart_total" id="bound_' + GuestUser.summaryId + '">' + currency + "" + parseFloat(GuestUser.subTotal).toFixed(2) + '</span>';


                                                                }
                                                                html += '</h5>';
                                                                html += '<i class="fa fa-trash ml-2" summaryId="' + GuestUser.summaryId + '" onclick="DeleteGroupOrder(\'' + GuestUser.summaryId + '\',\'' + GuestUser.Name +'\')" id="btn-DeleteGroupuser_' + GuestUser.summaryId + '"></i>';
                                                                html += '</td>';
                                                                html += '</tr>';
                                                            }
                                                            var GuestCartItems = GuestUser.LstCartItem;
                                                            if (GuestCartItems != null && GuestCartItems.length > 0) {
                                                                for (var j = 0; j < GuestCartItems.length; j++) {
                                                                    var allmodifierPrice = 0;

                                                                    flag = true;
                                                                    html += "<tr class='cart_items' id='row_" + GuestCartItems[j].GId + "'><td class='cart_qty'>" + GuestCartItems[j].qty + " ×</td><td class='cart_name'><span class='cart_title'>" + GuestCartItems[j].itemName + "</span>";

                                                                    html += "<span class='cart_info'>";
                                                                    if (GuestCartItems[j].modifiers != null && GuestCartItems[j].modifiers.length > 0) {
                                                                        html += "<br />";
                                                                        for (var k = 0; k < GuestCartItems[j].modifiers.length; k++) {
                                                                            html += "<label> •" + GuestCartItems[j].modifiers[k]._modName + "</label >";
                                                                            allmodifierPrice = allmodifierPrice + GuestCartItems[j].modifiers[k].price;

                                                                            if (GuestCartItems[j].modifiers[k].subMOD != null && GuestCartItems[j].modifiers[k].subMOD.length > 0) {
                                                                                var submodifiersList = GuestCartItems[j].modifiers[k].subMOD;
                                                                                for (var p = 0; p < submodifiersList.length; p++) {
                                                                                    html += "<label> •" + submodifiersList[p]._modName + "</label >";
                                                                                    allmodifierPrice = allmodifierPrice + submodifiersList[p].price;
                                                                                }
                                                                            }
                                                                        }
                                                                        if (GuestCartItems[j].specialInst != "" && GuestCartItems[j].specialInst != null) {
                                                                            html += "<br /><label><i> •" + GuestCartItems[j].specialInst + "</i></label>";
                                                                        }

                                                                    }
                                                                    else {
                                                                        if (GuestCartItems[j].specialInst != "" && GuestCartItems[j].specialInst != null) {
                                                                            html += "<br /><label><i> •" + GuestCartItems[j].specialInst + "</i></label>";
                                                                        }
                                                                    }
                                                                    html += "</span>";

                                                                    html += "<br /> <a id='" + GuestCartItems[j].GId + "' href='javascript:DeleteUserItem(\"" + GuestCartItems[j].GId + "\")' class='remove_item'>Remove</a>";

                                                                    if (GuestCartItems[j].modifiers == null || GuestCartItems[j].modifiers.length == 0) {
                                                                        html += " </td > <td class='cart_price'>" + currency + "" + (GuestCartItems[j].itemPrice * GuestCartItems[j].qty).toFixed(2) + "</td></tr> ";
                                                                    }
                                                                    else {
                                                                        html += " </td > <td class='cart_price'>" + currency + "" + (parseFloat(GuestCartItems[j].itemPrice * GuestCartItems[j].qty) + parseFloat(allmodifierPrice * GuestCartItems[j].qty)).toFixed(2) + "</td></tr> ";
                                                                    }
                                                                }
                                                            }

                                                        }
                                                    }
                                                }
                                                if(isPriceShow){
                                                 $('.total_price').show();
                                                 }
                                                 else
                                                 {
                                                      $('.total_price').hide();

                                                 }
                                            }
                                            else {
                                                if (result._cart.groupOrderUser != null) {
                                                    if (result._cart.groupOrderUser.LstGroupUsers != null && result._cart.groupOrderUser.LstGroupUsers.length > 0) {
                                                        for (var x = 0; x < result._cart.groupOrderUser.LstGroupUsers.length; x++) {
                                                            if (x == 0) {

                                                                var GuestUser = result._cart.groupOrderUser.LstGroupUsers[x];

                                                                if (GuestUser.Name != null) {

                                                                    html += '<tr style="background-color: aliceblue" class="guestname collapsed" id="' + GuestUser.summaryId + '">';
                                                                    html += '<td colspan="3">';
                                                                    html += '<h5>Your Cart';
                                                                    if (GuestUser.subTotal != '0') {
                                                                        html += '<span class="pull-right cart_total" id="bound_' + GuestUser.summaryId + '">' + currency + "" + parseFloat(GuestUser.subTotal).toFixed(2) + '</span>';

                                                                    }
                                                                    html += '</h5>';
                                                                    html += '</td>';
                                                                    html += '</tr>';
                                                                }
                                                                var GuestCartItems = GuestUser.LstCartItem;
                                                                if (GuestCartItems != null && GuestCartItems.length > 0) {
                                                                    for (var j = 0; j < GuestCartItems.length; j++) {
                                                                        var allmodifierPrice = 0;

                                                                        flag = true;
                                                                        html += "<tr class='cart_items' id='row_" + GuestCartItems[j].GId + "'><td class='cart_qty'>" + GuestCartItems[j].qty + " ×</td><td class='cart_name'><span class='cart_title'>" + GuestCartItems[j].itemName + "</span>";

                                                                        html += "<span class='cart_info'>";
                                                                        if (GuestCartItems[j].modifiers != null && GuestCartItems[j].modifiers.length > 0) {
                                                                            html += "<br />";
                                                                            for (var k = 0; k < GuestCartItems[j].modifiers.length; k++) {
                                                                                html += "<label> •" + GuestCartItems[j].modifiers[k]._modName + "</label >";
                                                                                allmodifierPrice = allmodifierPrice + GuestCartItems[j].modifiers[k].price;

                                                                                if (GuestCartItems[j].modifiers[k].subMOD != null && GuestCartItems[j].modifiers[k].subMOD.length > 0) {
                                                                                    var submodifiersList = GuestCartItems[j].modifiers[k].subMOD;
                                                                                    for (var p = 0; p < submodifiersList.length; p++) {
                                                                                        html += "<label> •" + submodifiersList[p]._modName + "</label >";
                                                                                        allmodifierPrice = allmodifierPrice + submodifiersList[p].price;
                                                                                    }
                                                                                }
                                                                            }
                                                                            if (GuestCartItems[j].specialInst != "" && GuestCartItems[j].specialInst != null) {
                                                                                html += "<br /><label><i> •" + GuestCartItems[j].specialInst + "</i></label>";
                                                                            }

                                                                        }
                                                                        else {
                                                                            if (GuestCartItems[j].specialInst != "" && GuestCartItems[j].specialInst != null) {
                                                                                html += "<br /><label><i> •" + GuestCartItems[j].specialInst + "</i></label>";
                                                                            }
                                                                        }
                                                                        html += "</span>";

                                                                        html += "<br /> <a id='" + GuestCartItems[j].GId + "' href='javascript:DeleteUserItem(\"" + GuestCartItems[j].GId + "\")' class='remove_item'>Remove</a>";

                                                                        if (GuestCartItems[j].modifiers == null || GuestCartItems[j].modifiers.length == 0) {
                                                                            html += " </td > <td class='cart_price'>" + currency + "" + (GuestCartItems[j].itemPrice * GuestCartItems[j].qty).toFixed(2) + "</td></tr> ";
                                                                        }
                                                                        else {
                                                                            html += " </td > <td class='cart_price'>" + currency + "" + (parseFloat(GuestCartItems[j].itemPrice * GuestCartItems[j].qty) + parseFloat(allmodifierPrice * GuestCartItems[j].qty)).toFixed(2) + "</td></tr> ";
                                                                        }
                                                                    }
                                                                    html += '<tr  class="guestname" id="' + GuestUser.summaryId + '">';
                                                                    html += '<td colspan="3">';
                                                                    html += "<a id='" + GuestUser.summaryId + "' href='javascript: SubmitGroupOrder(\"" + GuestUser.summaryId + "\")' class='pull-left submitOrder'>Submit Your Order</a>";
                                                                    html += "<a id='" + GuestUser.summaryId + "' href='javascript: DeleteGroupOrder(\"" + GuestUser.summaryId + "\")' class='pull-right leaveOrder'>Leave Group Order</a>";

                                                                    html += '</td>';
                                                                    html += '</tr>';
                                                                }
                                                            }
                                                        }
                                                    }
                                                    if (result._cart.groupOrderUser != null) {

                                                        if (result._cart.groupOrderUser.Name != null) {

                                                            html += '<tr style="background-color: aliceblue" class="guestname collapsed" id="' + result._cart.groupOrderUser.summaryId + '">';
                                                            html += '<td colspan="3">';
                                                            html += '<h5>Host Cart';
                                                            if (result._cart.groupOrderUser.subTotal != '0') {
                                                                html += '<span class="pull-right cart_total" id = "bound_' + result._cart.groupOrderUser.summaryId + '" > ' + currency + "" + parseFloat(result._cart.groupOrderUser.subTotal).toFixed(2) + '</span >';
                                                            }
                                                            html += '</h5>';
                                                            html += '</td>';
                                                            html += '</tr>';
                                                        }

                                                        var CartItems = result._cart.groupOrderUser.LstCartItem;
                                                        if (CartItems != null && CartItems.length > 0) {
                                                            for (var j = 0; j < CartItems.length; j++) {
                                                                var allmodifierPrice = 0;
                                                                isPriceShow = true;
                                                                flag = true;
                                                                html += "<tr class='cart_items' id='row_" + CartItems[j].GId + "'><td class='cart_qty'>" + CartItems[j].qty + " ×</td><td class='cart_name'><span class='cart_title'>" + CartItems[j].itemName + "</span>";

                                                                html += "<span class='cart_info'>";
                                                                if (CartItems[j].modifiers != null && CartItems[j].modifiers.length > 0) {
                                                                    html += "<br />";
                                                                    for (var k = 0; k < CartItems[j].modifiers.length; k++) {
                                                                        html += "<label> •" + CartItems[j].modifiers[k]._modName + "</label >";
                                                                        allmodifierPrice = allmodifierPrice + CartItems[j].modifiers[k].price;

                                                                        if (CartItems[j].modifiers[k].subMOD != null && CartItems[j].modifiers[k].subMOD.length > 0) {
                                                                            var submodifiersList = CartItems[j].modifiers[k].subMOD;
                                                                            for (var p = 0; p < submodifiersList.length; p++) {
                                                                                html += "<label> •" + submodifiersList[p]._modName + "</label >";
                                                                                allmodifierPrice = allmodifierPrice + submodifiersList[p].price;
                                                                            }
                                                                        }
                                                                    }
                                                                    if (CartItems[j].specialInst != "" && CartItems[j].specialInst != null) {
                                                                        html += "<br /><label><i> •" + CartItems[j].specialInst + "</i></label>";
                                                                    }

                                                                }
                                                                else {
                                                                    if (CartItems[j].specialInst != "" && CartItems[j].specialInst != null) {
                                                                        html += "<br /><label><i> •" + CartItems[j].specialInst + "</i></label>";
                                                                    }
                                                                }
                                                                html += "</span>";

                                                                if (CartItems[j].modifiers == null || CartItems[j].modifiers.length == 0) {
                                                                    html += " </td > <td class='cart_price'>" + currency + "" + (CartItems[j].itemPrice * CartItems[j].qty).toFixed(2) + "</td></tr> ";
                                                                }
                                                                else {
                                                                    html += " </td > <td class='cart_price'>" + currency + "" + (parseFloat(CartItems[j].itemPrice * CartItems[j].qty) + parseFloat(allmodifierPrice * CartItems[j].qty)).toFixed(2) + "</td></tr> ";
                                                                }
                                                            }


                                                        }

                                                        if (result._cart.groupOrderUser.LstGroupUsers != null && result._cart.groupOrderUser.LstGroupUsers.length > 0) {
                                                            for (var x = 0; x < result._cart.groupOrderUser.LstGroupUsers.length; x++) {

                                                                if (x != 0) {

                                                                    var GuestUser = result._cart.groupOrderUser.LstGroupUsers[x];

                                                                    if (GuestUser.Name != null) {

                                                                        html += '<tr style="background-color: aliceblue" class="guestname collapsed" id="' + GuestUser.summaryId + '">';
                                                                        html += '<td colspan="3">';
                                                                        html += '<h5>' + GuestUser.Name + '';
                                                                        if (GuestUser.subTotal != '0') {
                                                                            html += '<span class="pull-right cart_total" id = "bound_' + GuestUser.summaryId + '" > ' + currency + "" + parseFloat(GuestUser.subTotal).toFixed(2) + '</span >';
                                                                        }
                                                                        html += '</h5>';
                                                                        html += '</td>';
                                                                        html += '</tr>';
                                                                    }
                                                                    var GuestCartItems = GuestUser.LstCartItem;
                                                                    if (GuestCartItems != null && GuestCartItems.length > 0) {
                                                                        for (var j = 0; j < GuestCartItems.length; j++) {
                                                                            var allmodifierPrice = 0;

                                                                            flag = true;
                                                                            html += "<tr class='cart_items' id='row_" + GuestCartItems[j].GId + "'><td class='cart_qty'>" + GuestCartItems[j].qty + " ×</td><td class='cart_name'><span class='cart_title'>" + GuestCartItems[j].itemName + "</span>";

                                                                            html += "<span class='cart_info'>";
                                                                            if (GuestCartItems[j].modifiers != null && GuestCartItems[j].modifiers.length > 0) {
                                                                                html += "<br />";
                                                                                for (var k = 0; k < GuestCartItems[j].modifiers.length; k++) {
                                                                                    html += "<label> •" + GuestCartItems[j].modifiers[k]._modName + "</label >";
                                                                                    allmodifierPrice = allmodifierPrice + GuestCartItems[j].modifiers[k].price;

                                                                                    if (GuestCartItems[j].modifiers[k].subMOD != null && GuestCartItems[j].modifiers[k].subMOD.length > 0) {
                                                                                        var submodifiersList = GuestCartItems[j].modifiers[k].subMOD;
                                                                                        for (var p = 0; p < submodifiersList.length; p++) {
                                                                                            html += "<label> •" + submodifiersList[p]._modName + "</label >";
                                                                                            allmodifierPrice = allmodifierPrice + submodifiersList[p].price;
                                                                                        }
                                                                                    }
                                                                                }
                                                                                if (GuestCartItems[j].specialInst != "" && GuestCartItems[j].specialInst != null) {
                                                                                    html += "<br /><label><i> •" + GuestCartItems[j].specialInst + "</i></label>";
                                                                                }

                                                                            }
                                                                            else {
                                                                                if (GuestCartItems[j].specialInst != "" && GuestCartItems[j].specialInst != null) {
                                                                                    html += "<br /><label><i> •" + GuestCartItems[j].specialInst + "</i></label>";
                                                                                }
                                                                            }
                                                                            html += "</span>";


                                                                            if (GuestCartItems[j].modifiers == null || GuestCartItems[j].modifiers.length == 0) {
                                                                                html += " </td > <td class='cart_price'>" + currency + "" + (GuestCartItems[j].itemPrice * GuestCartItems[j].qty).toFixed(2) + "</td></tr> ";
                                                                            }
                                                                            else {
                                                                                html += " </td > <td class='cart_price'>" + currency + "" + (parseFloat(GuestCartItems[j].itemPrice * GuestCartItems[j].qty) + parseFloat(allmodifierPrice * GuestCartItems[j].qty)).toFixed(2) + "</td></tr> ";
                                                                            }
                                                                        }
                                                                    }
                                                                }

                                                            }


                                                        }

                                                    }
                                                }
                                            }
                                        }
                                        else {
                                            var CartItems = result._cart.cartItems;
                                            for(var j = 0; j < CartItems.length; j++) {
                                                var allmodifierPrice = 0;
                                                if (CartItems[j].isSent == false) {
                                                    flag = true;
                                                    html += "<tr class='cart_items' id='row_" + CartItems[j].cartItemId + "'><td class='cart_qty'>" + CartItems[j].qty + " ×</td><td class='cart_name'><span class='cart_title'>" + CartItems[j].itemName + "</span>";
                                                }
                                                else {
                                                    _issent = true;
                                                    html += "<tr class='cart_items oldrow' id='row_" + CartItems[j].cartItemId + "'><td class='cart_qty'>" + CartItems[j].qty + " ×</td><td class='cart_name'><span class='cart_title'>" + CartItems[j].itemName + "</span>";
                                                }
                                                html += "<span class='cart_info'>";
                                                if (CartItems[j].modifiers != null && CartItems[j].modifiers.length > 0) {
                                                    html += "<br />";
                                                    for (var k = 0; k < CartItems[j].modifiers.length; k++) {
                                                        html += "<label> •" + CartItems[j].modifiers[k]._modName + "</label >";
                                                        allmodifierPrice = allmodifierPrice + CartItems[j].modifiers[k].price;

                                                        if (CartItems[j].modifiers[k].subMOD != null && CartItems[j].modifiers[k].subMOD.length > 0) {
                                                            var submodifiersList = CartItems[j].modifiers[k].subMOD;
                                                            for (var p = 0; p < submodifiersList.length; p++) {
                                                                html += "<label> •" + submodifiersList[p]._modName + "</label >";
                                                                allmodifierPrice = allmodifierPrice + submodifiersList[p].price;
                                                            }
                                                        }
                                                    }
                                                    if (CartItems[j].specialInst != "" && CartItems[j].specialInst != null) {
                                                        html += "<br /><label><i> •" + CartItems[j].specialInst + "</i></label>";
                                                    }

                                                }
                                                else {
                                                    if (CartItems[j].specialInst != "" && CartItems[j].specialInst != null) {
                                                        html += "<br /><label><i> •" + CartItems[j].specialInst + "</i></label>";
                                                    }
                                                }
                                                html += "</span>";
                                                if (CartItems[j].isSent == false) {
                                                    html += "<br /> <a id='" + CartItems[j].cartItemId + "' href='javascript:Remove(\"" + CartItems[j].cartItemId + "\")' class='remove_item'>Remove</a>";
                                                }
                                                if (CartItems[j].modifiers == null || CartItems[j].modifiers.length == 0) {
                                                    html += " </td > <td class='cart_price'>" + currency + "" + (CartItems[j].itemPrice * CartItems[j].qty).toFixed(2) + "</td></tr> ";
                                                }
                                                else {
                                                    html += " </td > <td class='cart_price'>" + currency + "" + (parseFloat(CartItems[j].itemPrice * CartItems[j].qty) + parseFloat(allmodifierPrice * CartItems[j].qty)).toFixed(2) + "</td></tr> ";
                                                }
                                            }
                                        }







                                        $('#orderSend').show();
                                        $('#orderSend2').show();
                                        $('#orderSend2 a #orderSend').html(currency + JSON.parse(data)._cart.total.subTotal.toFixed(2));
                                        $('.total_price #cartTotalDue').html(currency + JSON.parse(data)._cart.total.subTotal.toFixed(2));
                                        $('#orderSend a #cartTotalDue').html(currency + JSON.parse(data)._cart.total.subTotal.toFixed(2));
                                        $('#orderSend2Dummy').hide();
                                        $('#orderSendDummy').hide();
                                        $('.Guestuser .cart_total').html(currency + JSON.parse(data)._cart.total.subTotal.toFixed(2));
                                        //if (JSON.parse(data)._cart.minVal > JSON.parse(data)._cart.total.subTotal.toFixed(2)) {
                                        //    $('#minOrder').attr('href', 'javascript:ProcessOrder()');
                                        //    $('#placeOrder').attr('onClick', 'ProcessOrder()');
                                        //    $.each($('#cart_total'), function () {
                                        //        $(this).html("$"+_cart.total.totalDue.toFixed(2));
                                        //    });
                                        //}

                                    }
                                    //location.reload();
                                    $('#tblCart').append(html);

                                    if (JSON.parse(data)._cart.minValue <= JSON.parse(data)._cart.total.subTotal.toFixed(2) && JSON.parse(data)._cart.validateMin) {


                                        $('.total_price>td #minVal').attr('href', 'javascript:Checkout()');
                                        $('.total_price>td #minVal').html('Checkout <span class="pull-right cart_total" id="cartTotalDue">' + currency + '' + JSON.parse(data)._cart.total.totalDue.toFixed(2) + '</span>');
                                        $('#cartTotalDue').html(currency + JSON.parse(data)._cart.total.subTotal.toFixed(2));
                                        $("#minVal").removeAttr("style");

                                    }
                                    else if (JSON.parse(data)._cart.minValue > JSON.parse(data)._cart.total.subTotal.toFixed(2) && JSON.parse(data)._cart.validateMin) {

                                        if ($('#minVal').length > 0) {
                                            $('.total_price>td #minVal').attr('href', '#');
                                            $('.total_price>td #minVal').html('Minimum Order: <span class="pull-right cart_total" id="cartTotalDue">' + currency + '' + JSON.parse(data)._cart.minValue.toFixed(2) + '</span>');

                                            $('.total_price>td #minVal').removeAttr('href');
                                            $("#minVal").css("color", "white");

                                        }
                                        else {
                                            $('a[href="javascript:Checkout()"]').attr('href', '#');
                                            $('a[href="javascript:Checkout()"]').html('Minimum Order: <span class="pull-right cart_total" id="cartTotalDue">' + currency + '' + JSON.parse(data)._cart.minValue.toFixed(2) + '</span>');
                                            $('.total_price>td #minVal').removeAttr('href');
                                            $("#minVal").css("color", "white");
                                        }
                                        $('#cartTotalDue').html(currency + JSON.parse(data)._cart.minValue.toFixed(2));
                                    }
                                    else {

                                        $('.total_price>td #minVal').attr('href', 'javascript:Checkout()');
                                        $('.total_price>td #minVal').html('Checkout <span class="pull-right cart_total" id="cartTotalDue">' + currency + '' + JSON.parse(data)._cart.total.totalDue.toFixed(2) + '</span>');
                                        $('#cartTotalDue').html(currency + JSON.parse(data)._cart.total.subTotal.toFixed(2));
                                        $("#minVal").removeAttr("style");
                                    }

                                    if ($("#tblCart #checkouthide").is(":visible")) {
                                        //alert('hide');
                                        $('#tblCart tr #checkouthide').css('display', 'none');
                                        $('.tr_startover').hide();
                                    }

                                    $('#checkouthide').css('display', 'none');
                                    $('#product_modal-' + itemId).modal('hide');
                                    $('#qty_' + itemId).val('1');
                                    $('#instr_' + itemId).val('');



                                    $('.total_price').show();

                                    $('#noItems').hide();

                                    $('.qty').text(JSON.parse(data).qty);
                                    if (JSON.parse(data)._cart.isGroupOrder == true && JSON.parse(data)._cart.isHostUser == false) {
                                        $('#orderSend').hide();
                                        $('#orderSend2').hide();
                                        $('#orderSend2 a #orderSend').hide();
                                        $('.total_price #cartTotalDue').hide();
                                        $('#orderSend a #cartTotalDue').hide();
                                        $('#orderSend2Dummy').hide();
                                        $('#orderSendDummy').hide();
                                        $('.Guestuser .cart_total').hide();
                                         $('.total_price').hide();
                                    }
                                    disableSyncCart=false;

                                }
                                else {
                                    $('#promo-modal').modal('show');
                                    $('#promo-modal #lblMessage').html(JSON.parse(data).responseMessage);
                                    $('#loader').hide();
                                    return false;
                                }
                                $('#btn_checkout').removeClass('disable');
                                $('.btn_sendorder').removeClass('disable');
                                 $('.btn_dineCheckout').removeClass('disable');
                            },
                            error: function (jqXHR, textStatus, errorThrown) {
                                $('#btn_checkout').removeClass('disable');
                                $('.btn_dineCheckout').removeClass('disable');
                                $('.btn_sendorder').removeClass('disable');
                                //$('#orderSend').removeClass('disable');
                                 //$('#orderSend2').removeClass('disable');
                                $('#loader').hide();
                                if (jqXHR.status == 404 || errorThrown == 'Not Found') {
                                    $('#promo-modal').modal('show');
                                    $('#promo-modal #lblMessage').html('<h4>Oops something happened , please contact store directly</h4>');

                                    setTimeout(function () {
                                        $('#promo-modal').modal('hide');
                                        location.href = "/WelcomePage";
                                    }, 3000);
                                }
                            }
                        });
                    }
      }

</script>
<script>
    function StartGroupOrder() {

        $.ajax({
            type: 'get',
            url: '/Index?handler=CheckGroupOrderUserloggedIn',
            data: null,
            contentType: 'application/json;charset=utf-8',
            dataType: 'json',

            success: function (data) {
                $('.modal').modal('hide');
                if (data == 'true') {
                    $('#CreateGroupOrder-Modal').modal('show');
                }
                else {
                    $('#loginModal').modal('show');
                }

            },
            error: function (jqXHR, textStatus, errorThrown) {
                if (jqXHR.status == 404 || errorThrown == 'Not Found') {
                    $('#promo-modal').modal('show');
                    $('#promo-modal #lblMessage').html('<h4>Oops something happened , please contact store directly</h4>');

                    setTimeout(function () {
                        $('#promo-modal').modal('hide');
                        location.href = "/WelcomePage";
                    }, 3000);
                }
            }

        });

    }
    $(document).ready(function () {

        if (false == true) {
            CheckGroupOrderPromptSequence();
        }

    });
    function CancelGroupOrderRequest() {
        $.get('/Index?handler=DisableStartGPClicked', function (data) {
            //$('#Group-OrderPrompt').modal('hide');
        });
    }
    function ShowGroupOrderPrompt() {
        $.ajax({
            url: "/index?handler=CheckIsGroupOrder&StartGPClicked=true",
            type: 'GET',
            dataType: 'json',
            contentType: 'application/json; charset=utf-8',

            success: function (result) {
                if (result == "0") {
                    $('#Group-OrderPrompt').modal('show');
                }
                else if (result == "2") {
                    $('#loginModal').modal('show');
                } else if (result!="99") {
                    $('#CreateGroupOrder-Modal').modal('show');
                }



            }
        });
    }

     function CheckGroupOrderPromptSequence() {
        $.ajax({
            url: "/index?handler=CheckIsGroupOrderOnRefresh&StartGPClicked=true",
            type: 'GET',
            dataType: 'json',
            contentType: 'application/json; charset=utf-8',

            success: function (result) {
                if(result=="false"){

                }
               else if (result == "2") {
                    $('#loginModal').modal('show');
                } else if (result!="99") {
                    $('#CreateGroupOrder-Modal').modal('show');
                }



            }
        });
    }

    function CreateGroupOrder() {

        $.ajax({
            url: "/index?handler=SaveHostUserDetail",
            type: 'GET',
            dataType: 'json',
            contentType: 'application/json; charset=utf-8',

            success: function (result) {
                $('.modal').modal('hide');

                if (result.status == 'true') {
                    $('#txt_inviteURL').val(result.url);
                    $('#txt_inviteURL').attr('disabled',true);
                    $('#txt_inviteURL2').val(result.url);
                }
                $('#Invitation-Modal').modal('show');
                $('#btn-viewgroupOrder').show();
                $('#btn-startgroupOrder').hide();

            }
        });
    };
    function DeleteUserItem(ItemGId) {
        //$('#loader').show();
        var cartitemid = ItemGId;



        $.ajax({
            type: 'get',
            url: '/Checkout?handler=CheckAppliedDiscount&itemId=' + cartitemid,
            data: null,
            contentType: 'application/json;charset=utf-8',
            dataType: 'json',
            success: function (data) {
                 var currency = '$';
                $('#loader').hide();
                //alert(data);
                if (data == 'true') {



                    $('#promo-modal').modal('show');
                    $('#promo-modal .close').hide();
                    $('#promo-modal #lblMessage').html('<h4>The applied offer is being reset now</h4>');
                    setTimeout(function () {
                        $('#promo-modal').modal('hide');
                        $('#promo-modal .close').show();
                        $('#loader').show();
                        RemoveGroupOrderCartItem(cartitemid);
                    }, 3000);



                }
                else {
                    RemoveGroupOrderCartItem(cartitemid);
                }
            },
            error: function (jqXHR, textStatus, errorThrown) {
                $('#loader').hide();
                if (jqXHR.status == 404 || errorThrown == 'Not Found') {
                    $('#promo-modal').modal('show');
                    $('#promo-modal #lblMessage').html('<h4>Oops something happened , please contact store directly</h4>');



                    setTimeout(function () {
                        $('#promo-modal').modal('hide');
                        location.href = "/WelcomePage";
                    }, 3000);
                }
            }
        });



    }



    function RemoveGroupOrderCartItem(cartitemid) {
       // $('#loader').show();
        $.ajax({
            type: 'get',
            url: '/Checkout?handler=IndexRemove&itemId=' + cartitemid,
            data: null,
            contentType: 'application/json;charset=utf-8',
            dataType: 'json',



            success: function (data) {
                 var currency = '$';
                $('#loader').hide();

                if (JSON.parse(data).subTotal == "0.00") {

                    location.reload();
                }
                else if (JSON.parse(data)._cart==null) {

                }
                else {
                    $('#row_' + cartitemid).hide();
                    $('.qty').text(JSON.parse(data).qty);
                    $('.cart_cunt').text(JSON.parse(data).qty);
                    $('.total_price').show();
                    $('.cart_total').html(currency + parseFloat(JSON.parse(data).subTotal).toFixed(2));



                }
               location.reload();
                $('#loader').hide();
            },
            error: function (jqXHR, textStatus, errorThrown) {
                $('#loader').hide();
                if (jqXHR.status == 404 || errorThrown == 'Not Found') {
                    $('#promo-modal').modal('show');
                    $('#promo-modal #lblMessage').html('<h4>Oops something happened , please contact store directly</h4>');



                    setTimeout(function () {
                        $('#promo-modal').modal('hide');
                        location.href = "/WelcomePage";
                    }, 3000);
                }
            }
        });
    }
    function CopyInvitationaLink(modalName) {
        /* Get the text field */
        $('#txt_inviteURL').attr('disabled',false);
        var copyGfGText = $('#txt_inviteURL');

        if (copyGfGText.val() == null || $.trim(copyGfGText.val()) ==''|| !$('#Invitation-Modal').hasClass("show")) {
              copyGfGText = $('#txt_inviteURL2');
        }
       $('#txt_inviteURL2').attr('type','text');
        /* Select the text field */
        copyGfGText.select();

        /* Copy the text inside the text field */
        document.execCommand("copy");
        $('#txt_inviteURL2').attr('type', 'hidden');
        var ModalSelector = '#' + modalName + ' .lbl-linkcopied';

        $(ModalSelector).show();


        $('#btn-viewgroupOrder').show();
        $('#btn-startgroupOrder').hide();
        $('#txt_inviteURL').attr('disabled',true);

    }



    function ShareInvitationaLink(){


          var copyGfGText = document.getElementById("txt_inviteURL2");



         copyGfGText.select();


         document.execCommand("copy");
         $('#txt_inviteURL2').attr('type','hidden');
     }

     function SubmitGroupOrder(summaryId) {
            $('#loader').show();
            if (summaryId != '') {
                $.ajax({
                    type: 'get',
                    url: '/Index?handler=SubmitGrouporderCartItems&SummaryId=' + summaryId,
                    data: null,
                    contentType: 'application/json;charset=utf-8',
                    dataType: 'json',

                    success: function (data) {

                        $('#loader').hide();
                        if (data == '1') {
                            SaveHostUserCart();
                        }
                        else if (data == '2') {
                            window.location = "/Confirmation?IsGPGuest=true";
                        }
                        else {
                            $('#promo-modal').modal('show');
                            $('#promo-modal #lblMessage').html("<h4>" + data + " and if you want to start over, <a href='/Welcomepage?handler=GroupOrderStartOver' style='color:#003875'>click here</a></h4>");
                        }

                    },
                    error: function (jqXHR, textStatus, errorThrown) {
                        if (jqXHR.status == 404 || errorThrown == 'Not Found') {
                            $('#promo-modal').modal('show');
                            $('#promo-modal #lblMessage').html('<h4>Oops something happened , please contact store directly</h4>');

                            setTimeout(function () {
                                $('#promo-modal').modal('hide');
                                location.href = "/WelcomePage";
                            }, 3000);
                        }
                    }

                });
            }
     }


    function DeleteGroupOrder(summaryId,name) {
        $('#DeletegroupOrderUser-modal').modal('show');
        if (name != undefined) {
            $('#DeletegroupOrderUser-modal #lbl_message').html('<h4>Are you sure you want to remove ' + name + ' from group order?</h4>');
        }
        else {
            $('#DeletegroupOrderUser-modal #lbl_message').html('<h4>Are you sure you want to leave group order?</h4>');

        }
        $('#DeletegroupOrderUser-modal #btn_dltGroupUserModal').attr('onclick', 'javascript:DeletegroupOrderUser(' + summaryId+');');
    }

    function DeletegroupOrderUser(summaryId) {
        $('#loader').show();
        if (summaryId != '') {
            $.ajax({
                type: 'get',
                url: '/Index?handler=DeleteGroupUser&summaryId=' + summaryId,
                data: null,
                contentType: 'application/json;charset=utf-8',
                dataType: 'json',

                success: function (data) {
                    $('#loader').hide();

                    if (data == 'Session Out') {
                        window.location = "/WelcomePage";
                    }
                    else if (data == 'false') {
                        window.location = "/index";
                    }
                    else {
                        $('#promo-modal').modal('show');
                        $('#promo-modal #lblMessage').html('<h4>' + data + '</h4>');

                    }
                },
                error: function (jqXHR, textStatus, errorThrown) {
                    if (jqXHR.status == 404 || errorThrown == 'Not Found') {
                        $('#promo-modal').modal('show');
                        $('#promo-modal #lblMessage').html('<h4>Oops something happened , please contact store directly</h4>');

                        setTimeout(function () {
                            $('#promo-modal').modal('hide');
                            location.href = "/WelcomePage";
                        }, 3000);
                    }
                }

            });
        }
    }

    $(document).on('hidden.bs.modal', '#ShowGroupOrderUsers-Modal', function () {
        $('.lbl-linkcopied').hide();
    });
</script>

<script>
    if ($(window).width() > 767) {
        $('.hamburger').on('click', function () {
            setTimeout(function () {
                parent_row_width = jQuery('.menu_nav.fixed_navigation').parents('.row').width();
                jQuery('.menu_nav.fixed_navigation, .menu_nav.fixed_navigation #mainNav').removeAttr('style');
                if (parent_row_width <= 1140) {
                    parent_row_widthn = parent_row_width + 20;
                    parent_ul_width = parent_row_width - 15;
                    jQuery('.menu_nav.fixed_navigation').css('max-width', parent_row_widthn + 'px');
                    jQuery('.menu_nav.fixed_navigation #mainNav').css('max-width', parent_ul_width + 'px');
                }
            }, 300);
        });
        $(window).on('scroll', function () {
            parent_row_width = jQuery('.menu_nav.fixed_navigation').parents('.row').width();
            jQuery('.menu_nav.fixed_navigation, .menu_nav.fixed_navigation #mainNav').removeAttr('style');
            if (parent_row_width <= 1140) {
                parent_row_widthn = parent_row_width + 20;
                parent_ul_width = parent_row_width - 15;
                jQuery('.menu_nav.fixed_navigation').css('max-width', parent_row_widthn + 'px');
                jQuery('.menu_nav.fixed_navigation #mainNav').css('max-width', parent_ul_width + 'px');
            }
        });
    }</script>
<script>
var disableSyncCart=false;
    $(document).ready(function(){
       setInterval(SyncGuestCart, 5000);

    });
    function SyncGuestCart(){
        if(disableSyncCart==false){
        $.ajax({
            url: '/Index?handler=SyncGuestCart',
            type: 'GET',
            dataType:'json',
            success: function (data) {
                var html = '';
                if (data != 'NA' && data != 'Not Found') {
                    var result = JSON.parse(data);
                    var currency = '$';
                    var isPriceShow = false;
                    if (result._cart.isGroupOrder == true) {
                        if (result._cart.isHostUser) {
                            var tr = '';
                            if (result._cart.groupOrderUser != null) {

                                if (result._cart.groupOrderUser.Name != null) {

                                    html += '<tr style="background-color: aliceblue" class="guestname collapsed" id="' + result._cart.groupOrderUser.summaryId + '">';
                                    html += '<td colspan="3">';
                                    html += '<h5>Your Cart';
                                    if (result._cart.groupOrderUser.subTotal != '0') {
                                        html += '<span class="pull-right cart_total" id = "bound_' + result._cart.groupOrderUser.summaryId + '" > ' + currency + "" + parseFloat(result._cart.groupOrderUser.subTotal).toFixed(2) + '</span >';
                                    }
                                    html += '</h5>';
                                    html += '</td>';
                                    html += '</tr>';
                                }
                                tr += '<li title="' + result._cart.groupOrderUser.Name + '">You</li>';
                                var CartItems = result._cart.groupOrderUser.LstCartItem;
                                if (CartItems != null && CartItems.length > 0) {
                                    for (var j = 0; j < CartItems.length; j++) {
                                        var allmodifierPrice = 0;
                                        isPriceShow = true;
                                        flag = true;
                                        html += "<tr class='cart_items' id='row_" + CartItems[j].GId + "'><td class='cart_qty'>" + CartItems[j].qty + " ×</td><td class='cart_name'><span class='cart_title'>" + CartItems[j].itemName + "</span>";

                                        html += "<span class='cart_info'>";
                                        if (CartItems[j].modifiers != null && CartItems[j].modifiers.length > 0) {
                                            html += "<br />";
                                            for (var k = 0; k < CartItems[j].modifiers.length; k++) {
                                                html += "<label> •" + CartItems[j].modifiers[k]._modName + "</label >";
                                                allmodifierPrice = allmodifierPrice + CartItems[j].modifiers[k].price;

                                                if (CartItems[j].modifiers[k].subMOD != null && CartItems[j].modifiers[k].subMOD.length > 0) {
                                                    var submodifiersList = CartItems[j].modifiers[k].subMOD;
                                                    for (var p = 0; p < submodifiersList.length; p++) {
                                                        html += "<label> •" + submodifiersList[p]._modName + "</label >";
                                                        allmodifierPrice = allmodifierPrice + submodifiersList[p].price;
                                                    }
                                                }
                                            }
                                            if (CartItems[j].specialInst != "" && CartItems[j].specialInst != null) {
                                                html += "<br /><label><i> •" + CartItems[j].specialInst + "</i></label>";
                                            }

                                        }
                                        else {
                                            if (CartItems[j].specialInst != "" && CartItems[j].specialInst != null) {
                                                html += "<br /><label><i> •" + CartItems[j].specialInst + "</i></label>";
                                            }
                                        }
                                        html += "</span>";
                                        if (CartItems[j].isSent == false) {
                                            html += "<br /> <a id='" + CartItems[j].GId + "' href='javascript:DeleteUserItem(\"" + CartItems[j].GId + "\")' class='remove_item'>Remove</a>";
                                        }
                                        if (CartItems[j].modifiers == null || CartItems[j].modifiers.length == 0) {
                                            html += " </td > <td class='cart_price'>" + currency + "" + (CartItems[j].itemPrice * CartItems[j].qty).toFixed(2) + "</td></tr> ";
                                        }
                                        else {
                                            html += " </td > <td class='cart_price'>" + currency + "" + (parseFloat(CartItems[j].itemPrice * CartItems[j].qty) + parseFloat(allmodifierPrice * CartItems[j].qty)).toFixed(2) + "</td></tr> ";
                                        }
                                    }


                                }

                                if (result._cart.groupOrderUser.LstGroupUsers != null && result._cart.groupOrderUser.LstGroupUsers.length > 0) {
                                    for (var x = 0; x < result._cart.groupOrderUser.LstGroupUsers.length; x++) {


                                        var nameArr = result._cart.groupOrderUser.LstGroupUsers[x].Name.split(" ");
                                        var displayChar = "";
                                        for (var n = 0; n < nameArr.length; n++) {
                                            displayChar = displayChar + nameArr[n].charAt(0);
                                        }
                                        tr += '<li title="' + result._cart.groupOrderUser.LstGroupUsers[x].Name + '">' + displayChar + '</li>';

                                        var GuestUser = result._cart.groupOrderUser.LstGroupUsers[x];

                                        if (GuestUser.Name != null) {

                                            html += '<tr style="background-color: aliceblue" class="guestname collapsed" id="' + GuestUser.summaryId + '">';
                                            html += '<td colspan="3">';
                                            html += '<h5>' + GuestUser.Name + '';
                                            if (GuestUser.subTotal != '0') {
                                                html += '<span class="pull-right cart_total" id = "bound_' + GuestUser.summaryId + '" > ' + currency + "" + parseFloat(GuestUser.subTotal).toFixed(2) + '</span >';
                                            }
                                            html += '</h5>';
                                            html += '<i class="fa fa-trash ml-2" summaryId="' + GuestUser.summaryId + '" onclick="DeleteGroupOrder(\'' + GuestUser.summaryId + '\',\'' + GuestUser.Name + '\')" id="btn-DeleteGroupuser_' + GuestUser.summaryId + '"></i>';
                                            html += '</td>';
                                            html += '</tr>';
                                        }
                                        var GuestCartItems = GuestUser.LstCartItem;
                                        if (GuestCartItems != null && GuestCartItems.length > 0) {
                                            for (var j = 0; j < GuestCartItems.length; j++) {
                                                var allmodifierPrice = 0;

                                                flag = true;
                                                html += "<tr class='cart_items' id='row_" + GuestCartItems[j].GId + "'><td class='cart_qty'>" + GuestCartItems[j].qty + " ×</td><td class='cart_name'><span class='cart_title'>" + GuestCartItems[j].itemName + "</span>";
                                                html += "<span class='cart_info'>";

                                                if (GuestCartItems[j].modifiers != null && GuestCartItems[j].modifiers.length > 0) {
                                                    html += "<br />";
                                                    for (var k = 0; k < GuestCartItems[j].modifiers.length; k++) {
                                                        html += "<label> •" + GuestCartItems[j].modifiers[k]._modName + "</label >";
                                                        allmodifierPrice = allmodifierPrice + GuestCartItems[j].modifiers[k].price;

                                                        if (GuestCartItems[j].modifiers[k].subMOD != null && GuestCartItems[j].modifiers[k].subMOD.length > 0) {
                                                            var submodifiersList = GuestCartItems[j].modifiers[k].subMOD;
                                                            for (var p = 0; p < submodifiersList.length; p++) {
                                                                html += "<label> •" + submodifiersList[p]._modName + "</label >";
                                                                allmodifierPrice = allmodifierPrice + submodifiersList[p].price;
                                                            }
                                                        }
                                                    }
                                                    if (GuestCartItems[j].specialInst != "" && GuestCartItems[j].specialInst != null) {
                                                        html += "<br /><label><i> •" + GuestCartItems[j].specialInst + "</i></label>";
                                                    }

                                                }
                                                else {
                                                    if (GuestCartItems[j].specialInst != "" && GuestCartItems[j].specialInst != null) {
                                                        html += "<br /><label><i> •" + GuestCartItems[j].specialInst + "</i></label>";
                                                    }
                                                }
                                                html += "</span>";

                                                html += "<br /> <a id='" + GuestCartItems[j].GId + "' href='javascript:DeleteUserItem(\"" + GuestCartItems[j].GId + "\")' class='remove_item'>Remove</a>";

                                                if (GuestCartItems[j].modifiers == null || GuestCartItems[j].modifiers.length == 0) {
                                                    html += " </td > <td class='cart_price'>" + currency + "" + (GuestCartItems[j].itemPrice * GuestCartItems[j].qty).toFixed(2) + "</td></tr> ";
                                                }
                                                else {
                                                    html += " </td > <td class='cart_price'>" + currency + "" + (parseFloat(GuestCartItems[j].itemPrice * GuestCartItems[j].qty) + parseFloat(allmodifierPrice * GuestCartItems[j].qty)).toFixed(2) + "</td></tr> ";
                                                }
                                            }
                                        }

                                    }
                                    $('#lbl_FriendsCount').html(result._cart.groupOrderUser.LstGroupUsers.length);
                                    if (isPriceShow) {
                                        $('.total_price').show();
                                    }
                                    else {
                                        $('.total_price').hide();

                                    }

                                }
                                $('.shared-peoples').html('');
                                $('.shared-peoples').append(tr);
                            }
                        }
                        else {
                            if (result._cart.groupOrderUser != null) {
                                if (result._cart.groupOrderUser.LstGroupUsers != null && result._cart.groupOrderUser.LstGroupUsers.length > 0) {
                                    for (var x = 0; x < result._cart.groupOrderUser.LstGroupUsers.length; x++) {
                                        if (x == 0) {
                                            var GuestUser = result._cart.groupOrderUser.LstGroupUsers[x];

                                            if (GuestUser.Name != null) {

                                                html += '<tr style="background-color: aliceblue" class="guestname collapsed" id="' + GuestUser.summaryId + '">';
                                                html += '<td colspan="3">';
                                                html += '<h5>Your Cart';
                                                if (GuestUser.subTotal != '0') {
                                                    html += '<span class="pull-right cart_total" id="bound_' + GuestUser.summaryId + '">' + currency + "" + parseFloat(GuestUser.subTotal).toFixed(2) + '</span>';

                                                }
                                                html += '</h5>';
                                                html += '</td>';
                                                html += '</tr>';
                                            }
                                            var GuestCartItems = GuestUser.LstCartItem;
                                            if (GuestCartItems != null && GuestCartItems.length > 0) {
                                                for (var j = 0; j < GuestCartItems.length; j++) {
                                                    var allmodifierPrice = 0;

                                                    flag = true;
                                                    html += "<tr class='cart_items' id='row_" + GuestCartItems[j].GId + "'><td class='cart_qty'>" + GuestCartItems[j].qty + " ×</td><td class='cart_name'><span class='cart_title'>" + GuestCartItems[j].itemName + "</span>";

                                                    html += "<span class='cart_info'>";
                                                    if (GuestCartItems[j].modifiers != null && GuestCartItems[j].modifiers.length > 0) {
                                                        html += "<br />";
                                                        for (var k = 0; k < GuestCartItems[j].modifiers.length; k++) {
                                                            html += "<label> •" + GuestCartItems[j].modifiers[k]._modName + "</label >";
                                                            allmodifierPrice = allmodifierPrice + GuestCartItems[j].modifiers[k].price;

                                                            if (GuestCartItems[j].modifiers[k].subMOD != null && GuestCartItems[j].modifiers[k].subMOD.length > 0) {
                                                                var submodifiersList = GuestCartItems[j].modifiers[k].subMOD;
                                                                for (var p = 0; p < submodifiersList.length; p++) {
                                                                    html += "<label> •" + submodifiersList[p]._modName + "</label >";
                                                                    allmodifierPrice = allmodifierPrice + submodifiersList[p].price;
                                                                }
                                                            }
                                                        }
                                                        if (GuestCartItems[j].specialInst != "" && GuestCartItems[j].specialInst != null) {
                                                            html += "<br /><label><i> •" + GuestCartItems[j].specialInst + "</i></label>";
                                                        }

                                                    }
                                                    else {
                                                        if (GuestCartItems[j].specialInst != "" && GuestCartItems[j].specialInst != null) {
                                                            html += "<br /><label><i> •" + GuestCartItems[j].specialInst + "</i></label>";
                                                        }
                                                    }
                                                    html += "</span>";

                                                    html += "<br /> <a id='" + GuestCartItems[j].GId + "' href='javascript:DeleteUserItem(\"" + GuestCartItems[j].GId + "\")' class='remove_item'>Remove</a>";

                                                    if (GuestCartItems[j].modifiers == null || GuestCartItems[j].modifiers.length == 0) {
                                                        html += " </td > <td class='cart_price'>" + currency + "" + (GuestCartItems[j].itemPrice * GuestCartItems[j].qty).toFixed(2) + "</td></tr> ";
                                                    }
                                                    else {
                                                        html += " </td > <td class='cart_price'>" + currency + "" + (parseFloat(GuestCartItems[j].itemPrice * GuestCartItems[j].qty) + parseFloat(allmodifierPrice * GuestCartItems[j].qty)).toFixed(2) + "</td></tr> ";
                                                    }
                                                }
                                                html += '<tr  class="guestname" id="' + GuestUser.summaryId + '">';
                                                html += '<td colspan="3">';
                                                html += "<a id='" + GuestUser.summaryId + "' href='javascript: SubmitGroupOrder(\"" + GuestUser.summaryId + "\")' class='pull-left submitOrder'>Submit Your Order</a>";
                                                html += "<a id='" + GuestUser.summaryId + "' href='javascript: DeleteGroupOrder(\"" + GuestUser.summaryId + "\")' class='pull-right leaveOrder'>Leave Group Order</a>";

                                                html += '</td>';
                                                html += '</tr>';
                                            }
                                        }

                                    }

                                }
                                if (result._cart.groupOrderUser != null) {

                                    if (result._cart.groupOrderUser.Name != null) {

                                        html += '<tr style="background-color: aliceblue" class="guestname collapsed" id="' + result._cart.groupOrderUser.summaryId + '">';
                                        html += '<td colspan="3">';
                                        html += '<h5>Host Cart';
                                        if (result._cart.groupOrderUser.subTotal != '0') {
                                            html += '<span class="pull-right cart_total" id = "bound_' + result._cart.groupOrderUser.summaryId + '" > ' + currency + "" + parseFloat(result._cart.groupOrderUser.subTotal).toFixed(2) + '</span >';
                                        }
                                        html += '</h5>';
                                        html += '</td>';
                                        html += '</tr>';
                                    }

                                    var CartItems = result._cart.groupOrderUser.LstCartItem;
                                    if (CartItems != null && CartItems.length > 0) {
                                        for (var j = 0; j < CartItems.length; j++) {
                                            var allmodifierPrice = 0;
                                            isPriceShow = true;
                                            flag = true;
                                            html += "<tr class='cart_items' id='row_" + CartItems[j].GId + "'><td class='cart_qty'>" + CartItems[j].qty + " ×</td><td class='cart_name'><span class='cart_title'>" + CartItems[j].itemName + "</span>";

                                            html += "<span class='cart_info'>";
                                            if (CartItems[j].modifiers != null && CartItems[j].modifiers.length > 0) {
                                                html += "<br />";
                                                for (var k = 0; k < CartItems[j].modifiers.length; k++) {
                                                    html += "<label> •" + CartItems[j].modifiers[k]._modName + "</label >";
                                                    allmodifierPrice = allmodifierPrice + CartItems[j].modifiers[k].price;

                                                    if (CartItems[j].modifiers[k].subMOD != null && CartItems[j].modifiers[k].subMOD.length > 0) {
                                                        var submodifiersList = CartItems[j].modifiers[k].subMOD;
                                                        for (var p = 0; p < submodifiersList.length; p++) {
                                                            html += "<label> •" + submodifiersList[p]._modName + "</label >";
                                                            allmodifierPrice = allmodifierPrice + submodifiersList[p].price;
                                                        }
                                                    }
                                                }
                                                if (CartItems[j].specialInst != "" && CartItems[j].specialInst != null) {
                                                    html += "<br /><label><i> •" + CartItems[j].specialInst + "</i></label>";
                                                }

                                            }
                                            else {
                                                if (CartItems[j].specialInst != "" && CartItems[j].specialInst != null) {
                                                    html += "<br /><label><i> •" + CartItems[j].specialInst + "</i></label>";
                                                }
                                            }
                                            html += "</span>";

                                            if (CartItems[j].modifiers == null || CartItems[j].modifiers.length == 0) {
                                                html += " </td > <td class='cart_price'>" + currency + "" + (CartItems[j].itemPrice * CartItems[j].qty).toFixed(2) + "</td></tr> ";
                                            }
                                            else {
                                                html += " </td > <td class='cart_price'>" + currency + "" + (parseFloat(CartItems[j].itemPrice * CartItems[j].qty) + parseFloat(allmodifierPrice * CartItems[j].qty)).toFixed(2) + "</td></tr> ";
                                            }
                                        }


                                    }

                                    if (result._cart.groupOrderUser.LstGroupUsers != null && result._cart.groupOrderUser.LstGroupUsers.length > 0) {
                                        for (var x = 0; x < result._cart.groupOrderUser.LstGroupUsers.length; x++) {

                                            if (x != 0) {
                                                var nameArr = result._cart.groupOrderUser.LstGroupUsers[x].Name.split(" ");
                                                var displayChar = "";
                                                for (var n = 0; n < nameArr.length; n++) {
                                                    displayChar = displayChar + nameArr[n].charAt(0);
                                                }
                                                tr += '<li title="' + result._cart.groupOrderUser.LstGroupUsers[x].Name + '">' + displayChar + '</li>';

                                                var GuestUser = result._cart.groupOrderUser.LstGroupUsers[x];

                                                if (GuestUser.Name != null) {

                                                    html += '<tr style="background-color: aliceblue" class="guestname collapsed" id="' + GuestUser.summaryId + '">';
                                                    html += '<td colspan="3">';
                                                    html += '<h5>' + GuestUser.Name + '';
                                                    if (GuestUser.subTotal != '0') {
                                                        html += '<span class="pull-right cart_total" id = "bound_' + GuestUser.summaryId + '" > ' + currency + "" + parseFloat(GuestUser.subTotal).toFixed(2) + '</span >';
                                                    }
                                                    html += '</h5>';
                                                    html += '</td>';
                                                    html += '</tr>';
                                                }
                                                var GuestCartItems = GuestUser.LstCartItem;
                                                if (GuestCartItems != null && GuestCartItems.length > 0) {
                                                    for (var j = 0; j < GuestCartItems.length; j++) {
                                                        var allmodifierPrice = 0;

                                                        flag = true;
                                                        html += "<tr class='cart_items' id='row_" + GuestCartItems[j].GId + "'><td class='cart_qty'>" + GuestCartItems[j].qty + " ×</td><td class='cart_name'><span class='cart_title'>" + GuestCartItems[j].itemName + "</span>";

                                                        html += "<span class='cart_info'>";
                                                        if (GuestCartItems[j].modifiers != null && GuestCartItems[j].modifiers.length > 0) {
                                                            html += "<br />";
                                                            for (var k = 0; k < GuestCartItems[j].modifiers.length; k++) {
                                                                html += "<label> •" + GuestCartItems[j].modifiers[k]._modName + "</label >";
                                                                allmodifierPrice = allmodifierPrice + GuestCartItems[j].modifiers[k].price;

                                                                if (GuestCartItems[j].modifiers[k].subMOD != null && GuestCartItems[j].modifiers[k].subMOD.length > 0) {
                                                                    var submodifiersList = GuestCartItems[j].modifiers[k].subMOD;
                                                                    for (var p = 0; p < submodifiersList.length; p++) {
                                                                        html += "<label> •" + submodifiersList[p]._modName + "</label >";
                                                                        allmodifierPrice = allmodifierPrice + submodifiersList[p].price;
                                                                    }
                                                                }
                                                            }
                                                            if (GuestCartItems[j].specialInst != "" && GuestCartItems[j].specialInst != null) {
                                                                html += "<br /><label><i> •" + GuestCartItems[j].specialInst + "</i></label>";
                                                            }

                                                        }
                                                        else {
                                                            if (GuestCartItems[j].specialInst != "" && GuestCartItems[j].specialInst != null) {
                                                                html += "<br /><label><i> •" + GuestCartItems[j].specialInst + "</i></label>";
                                                            }
                                                        }
                                                        html += "</span>";


                                                        if (GuestCartItems[j].modifiers == null || GuestCartItems[j].modifiers.length == 0) {
                                                            html += " </td > <td class='cart_price'>" + currency + "" + (GuestCartItems[j].itemPrice * GuestCartItems[j].qty).toFixed(2) + "</td></tr> ";
                                                        }
                                                        else {
                                                            html += " </td > <td class='cart_price'>" + currency + "" + (parseFloat(GuestCartItems[j].itemPrice * GuestCartItems[j].qty) + parseFloat(allmodifierPrice * GuestCartItems[j].qty)).toFixed(2) + "</td></tr> ";
                                                        }
                                                    }
                                                }
                                            }

                                        }


                                    }

                                }
                            }
                        }
                        if (result._cart.groupOrderSharingLink != '' && result._cart.groupOrderSharingLink != null) {
                            $('#txt_inviteURL').attr('disabled', false);
                            $('#txt_inviteURL').val(result._cart.groupOrderSharingLink);
                            $('#txt_inviteURL').attr('disabled', true);

                            $('#txt_inviteURL2').attr('disabled', false);
                            $('#txt_inviteURL2').val(result._cart.groupOrderSharingLink);

                        }
                        $('.qty').html(result.qty);
                       // $('.proc').remove();
                        $('.guestname').remove();
                        $('[id^="row_"]').remove();
                        $('#tblCart').append(html);
                        $('.total_price #cartTotalDue').html(currency + result._cart.total.subTotal.toFixed(2));
                    }
                }
                else if (data == 'Not Found') {
                    $('#promo-modal').modal('show');
                    $('#promo-modal .close').attr('onclick', 'javascript:window.location="/Welcomepage"');
                    $('#promo-modal #lblMessage').html("<h4>Host has removed you from group order, please contact host to reinitiate the group order or ,<a href='/Welcomepage' style='color:#003875;'>click start over here</a></h4>");

                }

            }
        });
        }
    }
    function SaveHostUserCart() {
         $.ajax({
            url: '/Index?handler=SyncGuestCart',
            type: 'GET',
            dataType:'json',
            success: function (data) {
                var html = '';
                if (data != 'NA') {
                    window.location = '/Checkout';
                }
            }
        });
    }

</script>



            <!--Mobile bottom fixed bar-->


        </div>
        <div class="container-fluid footer">
            <div class="row">
                <div class="col-md-12" style="z-index:100">
                    <!--footer col-md-9-->
                    <hr>
                    <div class="copyright row d-flex align-items-center">
                        <!--Row Copyright-->
                        <div class="col-6">
                            <ul class="copy_menu">
                                <li><a href="/terms_of_service" target="_blank">Terms of Service</a></li>
                                <li><a href="/privacy-policy">Privacy</a></li>
                                <li>© 2020 TechRyde</li>
                            </ul>
                        </div>
                        <div class="col-6 text-right">
                            <ul class="social">
                                <li><a href="https://www.facebook.com/TechRyde-183990219217138/"><i class="fa fa-facebook-square" aria-hidden="true"></i></a></li>
                                <li><a href="https://twitter.com/techryde_global"><i class="fa fa-twitter-square" aria-hidden="true"></i></a></li>
                                <li><a href="https://www.instagram.com/techryde/"><i class="fa fa-instagram" aria-hidden="true"></i></a></li>
                                <li>
                                    <label>
                                        v 3.4.8.0
                                    </label>
                                </li>
                            </ul>
                        </div>
                    </div><!--Row Copyright-->
                </div><!--footer col-md-9-->
            </div>
        </div>

        <!--Mobile bottom fixed bar-->
        <!--<div class="container-fluid bottom_fixed_mob">
        <div class="row">
        <div class="col-12">-->
        <!--Mobile Only-->
        <!--<ul class="list-inline mobile_only">
        <li class="list-inline-item" id="mob_1"><a href="welcomepage"><i class="fa fa-home"></i>Home</a></li>
        <li class="list-inline-item" id="mob_2"><a href="index"><i class="fa fa-book"></i>Menu</a></li>
        <li class="list-inline-item" id="mob_3"><a href="javascript:void(0)"><i class="fa fa-spoon"></i>Items</a></li>
        <li class="list-inline-item" id="mob_4"><a href="javascript:void(0)" class="cart_toggle" data-toggle="offcanvas"><i class="fa fa-shopping-cart"></i>Order<span class="cart_cunt">5</span></a></li>
        <li class="list-inline-item" id="mob_5"><a href="javascript:void(0)"><i class="fa fa-ellipsis-h"></i>More</a></li>
        </ul>-->
        <!--//Mobile Only-->
        <!--PC Only-->
        <!--<ul class="list-inline mobile_hidden">
        <li class="list-inline-item" id="pc_1"><a href="welcomepage"><i class="fa fa-home"></i>Home</a></li>
        <li class="list-inline-item" id="pc_2"><a href="index"><i class="fa fa-book"></i>Menu</a></li>
        <li class="list-inline-item" id="pc_3"><a href="javascript:void(0)"><i class="fa fa-spoon"></i>Items</a></li>
        <li class="list-inline-item" id="pc_4"><a href="orders.html"><i class="fa fa-shopping-cart"></i>Order</a></li>
        <li class="list-inline-item" id="pc_5"><a href="javascript:void(0)"><i class="fa fa-ellipsis-h"></i>More</a></li>
        <li class="list-inline-item" id="pc_6"><a href="javascript:void(0)"><i class="fa fa-sign-out"></i>Log Out</a></li>
        </ul>-->
        <!--//PC Only-->
        <!--</div>
        </div>
        </div>-->
        <!--Mobile bottom fixed bar-->
    </div>
    
    <!-- Login Modal-->
    <div class="modal product_modal" id="loginModal" >
        <div class="modal-dialog">
            <div class="modal-content login_div">
                <!-- Modal Header -->
                <div class="modal-header">
                    <h4 class="modal-title">Sign in to proceed!</h4>
                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                </div>
                <!-- Modal body -->
                <div class="modal-body">
                    <form>
                        <h2 class="text-center">Sign In</h2>
                        <div class="form-group">
                            <a href="javascript:fbLogin()" class="facebook_login add_btn"><span class="img_icon"><img src="/img/facebook.png" alt="facebook login"></span>Sign in with Facebook</a>
                            <a class="google_login add_btn" href="javascript:attachSignin()" id="GoogleLogin"><span class="img_icon"><img src="/img/btn_google_dark_normal_ios.svg" alt="google login"></span>Sign in with Google</a>
                        </div>
                    </form>
                </div>
                <!-- Modal footer -->
                <div class="modal-footer">
                    <button type="button" class="btn btn-submit customclose" data-dismiss="modal">Close</button>
                </div>
            </div>
        </div>
    </div>
    <div class="modal product_modal" id="CheckoutloginModal" >
        <div class="modal-dialog">
            <div class="modal-content login_div">
                <!-- Modal Header -->
                <div class="modal-header">
                    <h4 class="modal-title">Sign in to proceed!</h4>
                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                </div>
                <!-- Modal body -->
                <div class="modal-body">
                    <form>
                        <h2 class="text-center">Sign In</h2>
                        <div class="form-group">
                            <a href="javascript:fbLogincheckout()" class="facebook_login add_btn"><span class="img_icon"><img src="/img/facebook.png" alt="facebook login"></span>Sign in with Facebook</a>
                            <a class="google_login add_btn" href="javascript:attachSignincheckout()" id="GoogleLoginCheckout"><span class="img_icon"><img src="/img/btn_google_dark_normal_ios.svg" alt="google login"></span>Sign in with Google</a>
                            <a href="javascript:guestcheckout()" class="apple_login add_btn"><span class="img_icon"><img src="/img/user.png" alt="guest login"></span>Continue as Guest</a>
                        </div>
                    </form>
                </div>
                <!-- Modal footer -->
                <div class="modal-footer">
                    <button type="button" class="btn btn-submit customclose " data-dismiss="modal">Close</button>
                </div>
            </div>
        </div>
    </div>
    <!-- Login Modal-->
    <div class="modal fade" id="paypal-modal" tabindex="-1" role="dialog" aria-labelledby="success-modal" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <label id="lblMessagep"> Are you sure to Start Over?</label>
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>
                <div class="modal-body">
                    <form action="#" class="promo-form form-inline">

                        <br>
                        <div class="row ml-3">
                            <div class="col-6">
                                <input type="button" id="btn_Cancelstartover" class="close canclled" data-dismiss="modal" aria-label="Close" value="No">
                            </div>
                            <div class="col-6">
                                <input type="button" class="submitted" data-dismiss="modal" onclick="javascript:startOver();" value="Yes">
                            </div>
                        </div>

                    </form>

                </div>

            </div>
        </div>
    </div>
    <!-----Group Order Modal---->
    <div class="modal fade" id="Group-OrderPrompt" tabindex="-1" role="dialog" aria-labelledby="success-modal" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <h4>Group Order?</h4>
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>
                <div class="modal-body">
                    <form action="#" class="promo-form form-inline">
                        <div class="row m-1">
                            <p>Would you like to order for a group?</p>
                        </div>
                        <div class="row">
                            <div class="col-6">
                                <input type="button" id="btn_StartGOrder" onclick="javascript:StartGroupOrder()" class="canclled" data-dismiss="modal" aria-label="Close" value="Yes! group order">
                            </div>
                            <div class="col-6">

                                <input type="button" class="submitted" onclick="javascript:$('#Group-OrderPrompt').modal('hide')" value="No! Order for self">
                            </div>
                        </div>

                    </form>

                </div>

            </div>
        </div>
    </div>
    <div class="modal fade" id="CreateGroupOrder-Modal" tabindex="-1" role="dialog" aria-labelledby="success-modal" aria-hidden="true" data-backdrop="static" data-keyboard="false">
        <div class="modal-dialog modal-dialog-centered" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <h4>Create Group Order?</h4>
                    <button type="button" class="close" onclick="javascript:CancelGroupOrderRequest()" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>
                <div class="modal-body">
                    <form action="#" class="promo-form form-inline">
                        <div class="row">
                            <div class="col-12">
                                <p>Invite up to 10 friends. Check out and pay when everyone has added to the order.<a href="javascript:void(0)" data-toggle="modal" data-target="#grouporderInfo_modal" style="color: rgb(25, 125, 217)">Learn more about group ordering</a></p>
                            </div>
                        </div>
                    </form>

                </div>
                <div class="modal-footer">
                    <div class="row ml-3">

                        <div class="col-12">
                            <input type="button" onclick="javascript:CreateGroupOrder()" class="submitted" value="Create">
                        </div>
                    </div>
                </div>

            </div>
        </div>
    </div>
    <div class="modal fade" id="ShowGroupOrderUsers-Modal" tabindex="-1" role="dialog" aria-labelledby="success-modal" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered" role="document">
            <div class="modal-content">
                <div class="modal-header">

                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>
                <div class="modal-body">
                    <form action="#" class="form-inline">
                        <div class="row">
                            <div class="col-12">
                                <p>Check out and pay when everyone has added to the order.<a href="#" data-target="#grouporderInfo_modal" style="color: rgb(25, 125, 217)">Learn more about group ordering</a></p>
                            </div>
                        </div>
                        <hr>
                        <div class="row">
                            <div class="col-8">
                                <input type="hidden" class="form-control" id="txt_inviteURL2" value="" style="width:-webkit-fill-available" disabled />
                            </div>
                            <div class="col-4">
                                <a onclick="javascript:CopyInvitationaLink('ShowGroupOrderUsers-Modal');">Share Link</a>
                            </div>
                        </div>

                        <div class="row">

                            <h5>
                                Friends
                            </h5>
                            <div class="col-12">
                                <p>Invite up to 10 friends. Your friends appear here once they join the group order.</p>
                            </div>
                        </div>
                    </form>

                </div>
                <div class="modal-footer">
                    <div class="row ml-3">
                        <div class="col-6">
                            <input type="button" class="canclled" data-dismiss="modal" onclick="javascript:CancelGroupOrder();" aria-label="Close" value="Cancel Group Order">
                        </div>
                        <div class="col-6">
                            <input type="button" class="submitted" data-dismiss="modal" aria-label="Close" value="Done">
                        </div>
                    </div>
                </div>

            </div>
        </div>
    </div>


    <!------Group Order Modal------->
    <div class="modal fade" id="delivery-modal" tabindex="-1" role="dialog" aria-labelledby="success-modal" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>
                <div class="modal-body">
                    <form action="#" class="promo-form form-inline">
                        <p><h4><label>The nearest store to your location is temporarily closed for delivery. Do you want to do a takeaway order instead.</label></h4></p>
                        <br>
                        <div class="row ml-3">
                            <div class="col-6">
                                <input type="button" id="btn_Canceltakeaway" class="close canclled" data-dismiss="modal" aria-label="Close" value="No">
                            </div>
                            <div class="col-6">
                                <input type="button" class="submitted" data-dismiss="modal" onclick="javascript:SetTakeAwayOrder();" value="Yes">
                            </div>
                        </div>

                    </form>

                </div>

            </div>
        </div>
    </div>

    <div class="modal fade" id="PickupromptModal" tabindex="-1" role="dialog" aria-labelledby="success-modal" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>
                <div class="modal-body">
                    <form action="#" class="promo-form form-inline">
                        <p><h4><label>No stores found near to entered address , would you like to search store by zipcode?</label></h4></p>
                        <br>
                        <div class="row ml-3">
                            <div class="col-6">
                                <a id="" class="close canclled" data-dismiss="modal" aria-label="Close">No</a>
                            </div>
                            <div class="col-6">
                                <a id="btn_redirectallstore" class="btn submitted btn_changestore" style="color:white">Yes</a>
                            </div>
                        </div>

                    </form>

                </div>

            </div>
        </div>
    </div>

    <div class="modal fade" id="Checkclose-modal" data-backdrop="static" data-keyboard="false" tabindex="-1" role="dialog" aria-labelledby="success-modal" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered" role="document">
            <div class="modal-content">
                <div class="modal-header">

                </div>
                <div class="modal-body" style="height:100px !important">
                    <form action="#" class="promo-form form-inline">
                        <h4><label for="country-code" id="txtMessage">Check not found or closed on POS, Please contact staff</label></h4>
                        <br>


                    </form>

                </div>
                <div class="modal-footer">
                    <button class="btn px-2 mt-2 close" onclick="location.href='/QRCodeScan'" type="button" data-dismiss="modal" aria-label="Close"><span aria-hidden="true" class="px-4 py-1" style="background-color: #403636;color: white;border-radius: 5px;font-weight:500;">OK</span> </button>
                </div>
            </div>
        </div>
    </div>
    <div class="modal fade" id="Lpromo-modal" tabindex="-1" role="dialog" aria-labelledby="success-modal" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>
                <div class="modal-body" style="height:100px !important">
                    <form action="#" class="promo-form form-inline">
                        <h4><label for="country-code" id="lblLoyaltyMessage"></label></h4>
                        <br>
                    </form>
                </div>
                <div class="modal-footer">

                </div>
            </div>
        </div>
    </div>
    <div class="modal fade" id="promo-modal" tabindex="-1" role="dialog" aria-labelledby="success-modal" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>
                <div class="modal-body" style="height:100px !important">
                    <form action="#" class="promo-form form-inline">
                        <h4><label for="country-code" id="lblMessage"></label></h4>
                        <br>


                    </form>

                </div>
                <div class="modal-footer">
                    <button class="btn px-2 mt-2 close" type="button" data-dismiss="modal" aria-label="Close"><span aria-hidden="true" class="px-4 py-1" style="background-color: #403636;color: white;border-radius: 5px;font-weight:500;">OK</span> </button>
                </div>
            </div>
        </div>
    </div>
    <div class="modal fade" id="reset-modal" tabindex="-1" role="dialog" aria-labelledby="success-modal" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>
                <div class="modal-body" style="height:100px !important">
                    <form action="#" class="promo-form form-inline">
                        <h4><label for="country-code" id="lblMessage"></label></h4>
                        <br>


                    </form>

                </div>
                <div class="modal-footer">
                    <button class="btn px-2 mt-2 close" id="confirmReset" type="button" data-dismiss="modal" aria-label="Close"><span aria-hidden="true" class="px-4 py-1" style="background-color: #403636;color: white;border-radius: 5px;font-weight:500;">OK</span> </button>
                </div>
            </div>
        </div>
    </div>
    <!--Date picket model-->
    <div class="modal" id="loginModalOrder" class="product_modal">
        <div class="modal-dialog">
            <div class="modal-content login_div">
                <!-- Modal Header -->
                <div class="modal-header">
                    <h4 class="modal-title">Sign in to proceed!</h4>
                    <button type="button" class="close" data-dismiss="modal">&times;</button>

                </div>
                <!-- Modal body -->
                <div class="modal-body">
                    <form>
                        <h2 class="text-center">Sign In</h2>
                        <div class="form-group">
                            <a href="javascript:fbLoginOrder()" class="facebook_login add_btn"><span class="img_icon"><img src="/img/facebook.png" alt="facebook login"></span>Sign in with Facebook</a>

                            <a href="javascript:attachSigninOrder()" id="GoogleLoginOrder" class="google_login add_btn"><span class="img_icon"><img src="/img/btn_google_dark_normal_ios.svg" alt="google login"></span>Sign in with Google</a>

                        </div>
                    </form>
                </div>
                <!-- Modal footer -->
                <div class="modal-footer">
                    <button type="button" class="btn btn-submit customclose" data-dismiss="modal">Close</button>
                </div>
            </div>
        </div>
    </div>
    <!-- Gift Modal-->
<div class="modal" id="giftModal">
    <div class="modal-dialog cust_width">
        <div class="modal-content login_div">
            <!-- Modal Header -->
            <div class="modal-header">

                <div class="login-process-section" style="width:100%">
                    <div class="user_details" style="width:100%">
                        <div class="user_avatar">
                            <img src="img/avatar.png">
                        </div>
                        <div class="user_info">



                        </div>
                    </div>

                </div>

            </div>
            <!-- Modal body -->
<div class="modal-body">
    <section class="login-process-section" id="process-tab">
        <div class="container">
            <div class="row">
                <div class="col-md-12">
                    <label style="display:none; width:100%;" id="lblMessageComo" class="alert alert-danger alert-dismissible fade show"></label>

                    <!-- design process steps-->
                    <!-- Nav tabs -->
                    <ul class="nav nav-tabs process-model more-icon-preocess" role="tablist">

                                                        <li role="presentation" class="active">
                                                            <a href="#discover_user" aria-controls="discover_user" role="tab" data-toggle="tab">
                                                                <i class="fa fa-user-o"></i>
                                                                <p>Member Info</p>
                                                            </a>
                                                        </li>
                                                                                    <li role="presentation">
                                                                                        <a href="#gift_list" aria-controls="gift_list" role="tab" data-toggle="tab">
                                                                                            <i class="fa fa-gift"></i>
                                <p>Gift List</p>

                                                                                        </a>
                                                                                    </li>
                                                                                                                <li role="presentation">
                                                                                                                    <a href="#redeem_codes" aria-controls="redeem_codes" role="tab" data-toggle="tab">
                                                                                                                        <i class="fa fa-qrcode" aria-hidden="true"></i>
                                                                                                                        <p>Redeem Codes</p>
                                                                                                                    </a>
                                                                                                                </li>
                    </ul>
                    <!-- end design process steps-->
                    <!-- Tab panes -->
                    <div class="tab-content">
                        <div role="tabpanel" class="tab-pane active" id="discover_user">
                            <div class="design-process-content">
                                <div class="row">
                                    <div class="col-6 user_col">
                                        <div class="row bg_shadow">
                                            <div class="icons col-4">
                                                <div class="col_inner">
                                                    <i class="fa fa-vcard"></i>
                                                </div>
                                            </div>
                                            <div class="user_sub_details col-8">
                                                <div class="col_inner">





                                                </div>
                                            </div>
                                        </div>
                                        <div class="row">



                                        </div>
                                    </div>

                                </div>
                            </div>
                        </div>
                        <div role="tabpanel" class="tab-pane" id="gift_list">
                            <div class="design-process-content coupon_container">
                                <div class="active_toogle">
                                    <ul class="inline-btn">
                <li class="sec_type">
                    <a href="javascript:void(0)" class="active cpn_actv" data-id="active_tbl" id="activetbl"><i class="fa fa-circle"></i> Active</a>
                    <a href="javascript:void(0)" class="cpn_deact" data-id="inactive_tbl" id="inactivetbl">Inactive</a>
                </li>
                                    </ul>
                                </div>
                                <table class="active_coupons table" id="active_tbl">
                                    <tbody>
                <tr>
                    <td class="gift_info">No Queued redemptions available!</td>
                </tr>

                                    </tbody>
                                </table>
                                <table class="active_coupons table" id="inactive_tbl">
                                    <tbody>
    <!-- Gift Modal-->
    <!--
        Custom login Modal
    -->
    <div class="modal fade" id="customLoginModal" tabindex="-1" role="dialog" aria-labelledby="success-modal" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered" role="document">
            <div class="modal-content">

                <div class="modal-header">
                    <h4 class="modal-title"> Login with Guest</h4>
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>
                <div class="modal-body">
                    <label style="color:red" id="loginErrorMsg"></label>
                    <form action="#">
                        <div class="form-group">
                            <label class="col-form-label"> Email/Phone</label>
                            <input type="text" class="form-control" placeholder="Email/Phone" id="lgusername" name="username" />
                        </div>
                        <div class="form-group">
                            <label for="password">Password</label>
                            <input class="form-control" type="password" placeholder="***********" id="lgpassword" name="password" />
                        </div>
                        <div class="form-group">
                            <div class="col-md-12 col-sm-6">
                                <label class="form-text">Don't have an account?<a href="/RegisterNewUser">Sign up</a></label>
                            </div>
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <div class="row">
                        <div class="col-6">
                            <input type="button" class="close btn" data-dismiss="modal" aria-label="Close" value="Cancel">
                        </div>
                        <div class="col-6">
                            <input type="button" class="submitted" data-dismiss="modal" onclick="javascript:checkUserLogin();" value="Login">
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

</body></html>
<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js" integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q" crossorigin="anonymous"></script>
<script src="/js/bootstrap-4.0.0-beta2.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/sweetalert/2.1.1/sweetalert.min.js" integrity="sha512-AA1Bzp5Q0K1KanKKmvN/4d3IRKVlv9PYgwFPvm32nPO6QS8yH1HO7LbgB1pgiOxPtfeg5zEn2ba64MUcqJx6CA==" crossorigin="anonymous"></script>
<script src="https://apis.google.com/js/api:client.js"></script>
<script src="https://polyfill.io/v3/polyfill.min.js?features=default"></script>
<script src="/firebase-notification.js"></script>

<script type="text/javascript">

    function openStripeForm() {
        $(".payment_btn").removeClass("paymentSelected");




        $.ajax({
            type: 'get',
            url: '/Checkout?handler=CreatePaymentIntent',
            data: null,
            contentType: 'application/json;charset=utf-8',
            dataType: 'json',

            success: function (data) {

                const { clientSecret } = data;


                const appearance = {
                    theme: 'stripe',
                };
                elements = stripe.elements({ appearance, clientSecret });
                const paymentElement = elements.create("payment");
                paymentElement.mount("#payment-element");
            }
        });


        $('#payment-form').show();
        $('#placeOrderInstruction').hide();
        $('#placeOrderInstructionMob').hide();


    }
    /*<![CDATA[*/

    var timeText;
    var timemonth;
    var timeid;
    
    if ('serviceWorker' in navigator) {

        console.log("Will the service worker register?");
        navigator.serviceWorker.register('pwa-serviceworker.js')
        .then(function (registration) {
            console.log("Registration successful, scope is:", registration.scope);
            Notification.requestPermission(function (result) {
                if (result === 'granted') { }
                else {
                    //$('#promo-modal').modal('show');
                    //$('#promo-modal #lblMessage').html('<h4>Please allow notifications!</h4>');
                }
            });
        })
        .catch(function (err) {
                console.log("Service worker registration failed, error:", err);
            });

        navigator.serviceWorker.ready.then(function (reg) {
            try {
                reg.pushManager.getSubscription().then(function (sub) {
                    if (sub == undefined) {
                        ;
                        $.get('/welcomepage?handler=PublicKey', null, function (data) {
                            var applicationServerPublicKey = data.key;

                            var applicationServerKey = urlB64ToUint8Array(applicationServerPublicKey);

                            reg.pushManager.subscribe({
                                userVisibleOnly: true,
                                applicationServerKey: applicationServerKey
                            })
                                .then(function (sub) {
                                    $.get('/welcomepage?handler=WebPushSub&sub=' + JSON.stringify(sub), null, function () { });
                                    // send sub.toJSON() to server
                                });

                        });
                        // ask user to register for Push
                    } else {
                        //Unsubscribe
                        //var subscriptionId = sub.subscriptionId;
                        //console.log(JSON.stringify(sub.options));
                        // TODO: Make a request to your server to remove
                        // the subscriptionId from your data store so you
                        // don't attempt to send them push messages anymore
                        $.get('/welcomepage?handler=WebPushSub&sub=' + JSON.stringify(sub), null, function () { });
                        // We have a subscription, so call unsubscribe on it
                        //sub.unsubscribe().then(function (successful) {
                        //    console.log('Unsubscribed ');
                        //}).catch(function (e) {
                        //     //We failed to unsubscribe, this can lead to
                        //     //an unusual state, so may be best to remove
                        //     //the users data from your data store and
                        //     //inform the user that you have done so

                        //    console.log('Unsubscription error: ', e);

                        //});
                        // You have subscription, update the database on your server

                    }
                });
            }
            catch (err) {
                console.log(err);
            }

        });
        navigator.serviceWorker.addEventListener('message', e => {

            var title = JSON.parse(e.data).Title;
            var body = JSON.parse(e.data).Body;
            $('#push_title').text(title);
            $('#push_body').text(body);
        });

    }

    function urlB64ToUint8Array(base64String) {
        const padding = '='.repeat((4 - base64String.length % 4) % 4);
        const base64 = (base64String + padding)
            .replace(/\-/g, '+')
            .replace(/_/g, '/');

        const rawData = window.atob(base64);
        const outputArray = new Uint8Array(rawData.length);

        for (let i = 0; i < rawData.length; ++i) {
            outputArray[i] = rawData.charCodeAt(i);
        }
        return outputArray;
    }
    var skipInstall;
    $.get("/welcomepage?handler=skipInstall&get=true", null, function (data) {
        skipInstall = data;
    });
    function addToHomeScreen() {

let a2hsBtn = document.querySelector(".ad2hs-prompt");  // hide our user interface that shows our A2HS button
a2hsBtn.style.display = 'none';  // Show the prompt
deferredPrompt.prompt();  // Wait for the user to respond to the prompt
deferredPrompt.userChoice
.then(function (choiceResult) {

    if (choiceResult.outcome === 'accepted') {
        skipInstall = true;
        $.get("/welcomepage?handler=skipInstall&skip=true");
console.log('User accepted the A2HS prompt');
    } else {
        skipInstall = true;
        $.get("/welcomepage?handler=skipInstall&skip=true");
console.log('User dismissed the A2HS prompt');
}

deferredPrompt = null;

});
}


function showAddToHomeScreen() {
    $.get("/welcomepage?handler=skipInstall&get=true", null, function (data) {
        skipInstall = data;
        let a2hsBtn = document.querySelector(".ad2hs-prompt");
        a2hsBtn.style.display = "block";
        if (!skipInstall) {
            a2hsBtn.addEventListener("click", addToHomeScreen);
        }

    });


}

let deferredPrompt;
window.addEventListener('beforeinstallprompt', function (e) {
// Prevent Chrome 67 and earlier from automatically showing the prompt
e.preventDefault();
// Stash the event so it can be triggered later.
deferredPrompt = e;

showAddToHomeScreen();
});

function showIosInstall() {
    $.get("/welcomepage?handler=skipInstall&get=true", null, function (data) {
        skipInstall = data;
        let iosPrompt = document.querySelector(".ios-prompt");

        if (!skipInstall) {
            iosPrompt.style.display = "block";
        }
        iosPrompt.addEventListener("click", () => {
            $.get("/welcomepage?handler=skipInstall&skip=true");
            skipInstall = true;
            iosPrompt.style.display = "none";
        });
    });

}

// Detects if device is on iOS
const isIos = () => {
const userAgent = window.navigator.userAgent.toLowerCase();
return /iphone|ipad|ipod/.test(userAgent);
}
// Detects if device is in standalone mode
const isInStandaloneMode = () => ('standalone' in window.navigator) && (window.navigator.standalone);

// Checks if should display install popup notification:
if (isIos() && !isInStandaloneMode()) {
// this.setState({ showInstallMessage: true });
showIosInstall();
}


var order_id = '';
var LoginProcess = "";

function ChangeOT(id) {
$('#loader').show();

checkcart(id);

}

    function locationcheck(id) {
        var getstorevalue = 'true';
        var UserPickupAddress = 'True';
        var storestatus = '';

        //alert(storestatus);
        if (UserPickupAddress == 'True') {
            // alert(UserPickupAddress);
            if (getstorevalue == '') {

                getLocation(id);
                //window.location.href = "/AllStore";
            }
            else {

                if (storestatus == 'Offline') {

                    window.location.href = "/AllStore";
                }
                else {

                    //checkcart(id);
                    window.location.href = "/Index?OrderType=" + id;
                }

            }
        }
        else {
            (UserPickupAddress);
            //checkcart(id);
            window.location.href = "/Index?OrderType=" + id;
        }
    }

    function checkcart(id) {
        $('#loader').show();
       
            $.ajax({
                type: 'get',
                url: '/WelcomePage?handler=ResetdeliveryCart&order_id=' + id,
                data: null,
                contentType: 'application/json;charset=utf-8',
                dataType: 'json',
                success: function (data) {
                  

                    if (data.data == "Same Order Type") {
                        $('#loader').hide();
                    }
                    else if (data.data == "null") {
                        $('#loader').hide();
                        $('#promo-modal').modal('show');
                        $('#promo-modal #lblMessage').html('<h4>' + data.msg + '</h4>');
                    }

                    else if (data.data == "true") {
                        $('#loader').hide();
                        $('#resetcart-modal').modal('show');
                        $('#btn_Welcomereset').attr('name', id);
                        $('#btn_Welcomeresetcancl').attr('name', id);
                    }
                    else if (data.data == "pickup") {
                        // $('#loader').hide();
                        locationcheck(id)

                    }
                    else if (data.data == "Delivery") {

                        $('#resetcart-modal').modal('show');

                        order_id = id;
                        /*  $.when(getAllStores()).done(function () {
                             //  alert("getAllstores")
                               $.getJSON('/Index?handler=UserStoreDetails', function (data) {
   
                                   if (data != "NoData") {
                                       area = data.lstDeliveryGeoArea;
                                   }
   
                               }).done(function (data) {
   
                                   if (data != "NoData") {
                                       var lat = data.latitude;
   
                                       var lng = data.longitude;
   
   
                                       initialize(lat, lng);
                                      CheckUserDeliveryAddress();
   
                                   }
   
                               });
                           });
       */
                        // $('#deliveryaddressmodal').modal('show');
                    }

                    else if (data.data == "DELIVERYNOITEMS") {
                        order_id = id;
                        $('#loader').hide();
                        $.when(getAllStores()).done(function () {
                            //  alert("getAllstores")
                            $.getJSON('/Index?handler=UserStoreDetails', function (data) {

                                if (data != "NoData") {
                                    area = data.lstDeliveryGeoArea;
                                }

                            }).done(function (data) {

                                if (data != "NoData") {
                                    var lat = data.latitude;

                                    var lng = data.longitude;


                                    initialize(lat, lng);
                                    CheckUserDeliveryAddress();

                                }

                            });
                        });


                    }


                    else {

                        CheckGuestDetail(id);
                        //window.location = '/index?OrderType=' + id;
                    }
                },
                error: function (jqXHR, textStatus, errorThrown) {
                    $('#loader').hide();


                        $('#promo-modal').modal('show');
                        $('#promo-modal #lblMessage').html('<h4>Store is currently offline , please contact store directly to place order</h4>');

                }
            });

    }
    function CheckGuestDetail(id) {
        $.ajax({
            type: 'get',
            url: '/WelcomePage?handler=CheckGuestUserLandingPage',
            data: null,
            contentType: 'application/json;charset=utf-8',
            dataType: 'json',

            success: function (data) {

                if (data == 'True') {
                    $('#loader').hide();
                    window.location = '/index?OrderType=' + id;
                }
                else if (data == "IncorrectPh")
                {
                    $('#loader').hide();
                    $('#Phonenumber_Modal').modal('show');
                    $("#btn_getcheckDetails").show();
                    $("#btn_SavePhoneNumber").hide();
                }
                else if (data == 'Set Guest Detail') {
                    $('#loader').hide();
                    $('#EnhanceDineInGuestmodal').modal('show');
                }
                else if (data == 'false') {
                    $('#loader').hide();
                    $('#DineInGuestmodal').modal('show');
                }
                else if (data == 'Tendered') {
                    $('#loader').hide();
                    $('#Phonenumber_Modal').modal('show');
                    $('.hideforcheckout').hide();
                    $('#btn_getcheckDetails').hide();
                    $('#btn_SavePhoneNumber').hide();
                    $('#btn_RedirectQRCode').show();
                    $('#Phonenumber_Modal #lbl_error').html('Check is already tendered, Please contact staff!');
                }
               else if (data == "Pos OFF") {
                    $('.Guestuser ').hide()

                    $('#loader').hide();
                }
                else if (data == "Session Out") {

                    $('.Guestuser ').hide()

                    $('#loader').hide();
                    $('#Phonenumber_Modal').modal('show');
                    $("#btn_getcheckDetails").show();
                    $("#btn_SavePhoneNumber").hide();
                }
                else if (data == "CheckName Session Out") {
                    GetDineInChecks();
                }

                //else {
                //    window.location = '/QRCodeScan';
                //}
            }
        });
    }
function CheckUserDeliveryAddress() {
$.ajax({
type: 'get',
url: '/Index?handler=CheckUserAddress',
data: null,
contentType: 'application/json;charset=utf-8',
dataType: 'json',

success: function (data) {
    $('#loader').hide();
if (data == 'Save') {
window.location = '/index?OrderType=' + order_id;
}
else {
$('#deliveryaddressmodal').modal('show');
}
}
});
}

function RedeemOffers() {
//$('#loader').show();

}

function GetUserStoreDetails() {
$.ajax({
type: 'get',
url: '/Index?handler=UserStoreDetails',
data: null,
contentType: 'application/json;charset=utf-8',
dataType: 'json',

success: function (data) {

if (data != "NoData") {

area = data.lstDeliveryGeoArea;


var lat = data.latitude;

var lng = data.longitude;


initialize(lat, lng);
CheckUserDeliveryAddress();
}
}
});
}


function UserSaveAddressDelivery(Name, Address, lat, lng, locStatus, PostalCode, ordertype) {
$('#loader').show();
var Apartmentnumber = "";
var DropOff = "";
var Dropopt = "";
$.ajax({
type: 'get',
url: '/Index?handler=UserAddress&Name=' + Name + '&Address=' + Address + '&latitude=' + lat + '&longitude=' + lng + '&Apartmentnumber=' + Apartmentnumber + '&comment=' + DropOff + '&DropOff=' + Dropopt + '&PostalCode=' + PostalCode,
data: null,
contentType: 'application/json;charset=utf-8',
dataType: 'json',

success: function (data) {
$('#deliveryaddressmodal').modal('hide');
$('#loader').hide();
window.location = "/index?Ordertype=" + ordertype;
//window.location.reload();

},
error: function (jqXHR, textStatus, errorThrown) {
if (jqXHR.status == 404 || errorThrown == 'Not Found') {
$('#promo-modal').modal('show');
$('#promo-modal #lblMessage').html('<h4>Oops something happened , please contact store directly</h4>');

setTimeout(function () {
$('#promo-modal').modal('hide');
location.href = "/WelcomePage";
}, 3000);
}
}
});

}

function getLocation(orderid) {
order_id = orderid;
if (navigator.geolocation) {
navigator.geolocation.getCurrentPosition(showPosition, positionNotFound);
} else {
//x.innerHTML = "Geolocation is not supported by this browser.";
}
}

function positionNotFound(error) {
$('#promo-modal').modal('show');
$('#promo-modal #lblMessage').html('<h4>Location access is Blocked. Change your location settings in browser or Enter Zipcode</h4>');
//alert("Location not found");
setTimeout(function () {
$('#promo-modal').modal('hide');
location.href = "/AllStore";
}, 3000);
// Handle error
}
// Convert Degress to Radians
function Deg2Rad(deg) {
return deg * Math.PI / 180;
}

function showPosition(position) {

var userlat = position.coords.latitude;
var userlong = position.coords.longitude;
var minDiff = 9999;
//var latlon = new google.maps.LatLng(lat, lon)

$.ajax({
type: 'get',
url: '/Index?handler=AllStores',
data: null,
contentType: 'application/json;charset=utf-8',
dataType: 'json',

success: function (data) {
var storedt = JSON.parse(data);
var closest;
var flag = false;
storeconfig = storedt.storeConfigDetails;

for (var i = 0; i < storeconfig.length; i++) {
if (storeconfig.length == 1) {
flag = true;
GetNearestStore(storeconfig[i].storeId, order_id);
}
else {
var diff = PythagorasEquirectangular(userlat, userlong, parseFloat(storeconfig[i].latitude), parseFloat(storeconfig[i].longitude))
if (diff < minDiff) {
minDiff = diff;
closest = i;
}
}

}

if (closest != undefined) {
var store_id = storeconfig[closest].storeId;
GetNearestStore(store_id, order_id);
}
else if (!flag){
$('#ErrorMsgmodel').modal('show'); $('#lblMessage1').html('<h4>Redirecting to select store for TakeAway</h4>');
window.location = "/AllStore";
}
}
});
}

    function GetNearestStore(store_id, order_id) {
        $('#loader').show();
        $.ajax({
            type: 'get',
            url: '/Index?handler=Neareststore&storeId=' + store_id,
            data: null,
            contentType: 'application/json;charset=utf-8',
            dataType: 'json',

            success: function (data) {

                if (data.status == "Online") {
                    window.location.href = "/Index?OrderType=" + data.order_id;
                    //$('#loader').hide();
                }
                else if (data.status == "Offline") {
                    $('#loader').hide();
                    if (storeconfig.length == 1) {
                        swal("Oops!", "No stores are available", "error")
                            .then((value) => {
                                window.location = "/AllStore";
                            });
                    }
                    else {
                        window.location = "/AllStore";
                    }

                }
                //}

            }
        });
    }

function PythagorasEquirectangular(lat1, lon1, lat2, lon2) {

var R = 6371; // km
var x = (lon2 - lon1) * Math.cos((lat1 + lat2) / 2);
var y = (lat2 - lat1);
var d = Math.sqrt(x * x + y * y) * R;
return d;
}
// Read a page's GET URL variables and return them as an associative array.

function getUrlVars() {
var vars = [], hash;
var hashes = window.location.href.slice(window.location.href.indexOf('?') + 1).split('&');
for (var i = 0; i < hashes.length; i++) {
hash = hashes[i].split('=');
vars.push(hash[0]);
vars[hash[0]] = hash[1];
}
return vars;
}

function openLogin() {
    $('#loginModal').modal('show');

}

$(document).ready(function () {
var itemId = getUrlVars()["itemId"];
$('#product_modal-' + itemId).modal('show');
$('#loader').hide();


});

function AddUpSell(itemId) {
$('#loader').show();
window.location.href = "Index?itemId=" + itemId;
}
//function Index() {

//$('#loader').show();
//window.location.href = 'Index';
//}


    //--This method work for index page without reloading page after add item to cart--//
    function Remove(cartitemid) {
       // $('#loader').show();
        //var cartitemid = this.id;

        $.ajax({
            type: 'get',
            url: '/Checkout?handler=CheckAppliedDiscount&itemId=' + cartitemid,
            data: null,
            contentType: 'application/json;charset=utf-8',
            dataType: 'json',
            success: function (data) {

                $('#loader').hide();
                //alert(data);
                if (data == 'true') {

                    $('#promo-modal').modal('show');
                    $('#promo-modal .close').hide();
                    $('#promo-modal #lblMessage').html('<h4>The applied offer is being reset now</h4>');
                    setTimeout(function () {
                        $('#promo-modal').modal('hide');
                        $('#promo-modal .close').show();
                        $('#loader').show();
                        RemoveItemIndexII(cartitemid);
                    }, 3000);

                }
                else {
                    RemoveItemIndexII(cartitemid);
                }
            },
            error: function (jqXHR, textStatus, errorThrown) {
                $('#loader').hide();
                if (jqXHR.status == 404 || errorThrown == 'Not Found') {
                    $('#promo-modal').modal('show');
                    $('#promo-modal #lblMessage').html('<h4>Oops something happened , please contact store directly</h4>');

                    setTimeout(function () {
                        $('#promo-modal').modal('hide');
                        location.href = "/WelcomePage";
                    }, 3000);
                }
            }
        });
    }

    function RemoveItemIndexII(cartitemid) {
       // $('#loader').show();
        $.ajax({
            type: 'get',
            url: '/Checkout?handler=IndexRemove&itemId=' + cartitemid,
            data: null,
            contentType: 'application/json;charset=utf-8',
            dataType: 'json',

            success: function (data) {
                $('#row_' + cartitemid).hide();
                 var currency = '$';
                if (JSON.parse(data).ordertype != "DineIn") {

                    if (JSON.parse(data).subTotal == "0.00") {
                        //location.reload();
                        $('.total_price').hide();
                        $('#noItems').show();
                        $('.qty').text(JSON.parse(data).qty);
                    }
                    else {
                        $('.cart_total').html(currency + parseFloat(JSON.parse(data).subTotal).toFixed(2));
                        //$('.cart_total').html(currency + parseFloat(JSON.parse(data)._cart.total.subTotal).toFixed(2));
                        //$('#taxTotal').html(currency +parseFloat(JSON.parse(data)._cart.total.taxTotal).toFixed(2));
                        //$('#subTotal').html(currency +parseFloat(JSON.parse(data)._cart.total.subTotal).toFixed(2));
                        //$('#totalDue').html(currency +parseFloat(JSON.parse(data)._cart.total.subTotal).toFixed(2));
                        $('.total_price').show();
                        $('.qty').text(JSON.parse(data).qty);
                        var cartitems = JSON.parse(data)._cart.cartItems;
                        if (cartitems != null && cartitems.length > 0) {
                            var flag = false;
                            for (var i = 0; i < cartitems.length; i++) {

                                if (cartitems[i].isSent == false) {
                                    flag = true;
                                    //$('#tblCart tr#checkouthide').show();
                                    // return false;
                                }

                            }
                            if (!flag) {
                                $('.total_price #orderSend').css('display', 'none');
                                $('.total_price #orderSendDummy').show();
                                $('.total_price #checkouthide').css('display', 'table-cell');
                            }
                        }

                    }
                    if (JSON.parse(data)._cart.minValue < JSON.parse(data)._cart.total.subTotal.toFixed(2) && JSON.parse(data)._cart.validateMin) {

                        $('.total_price>td #minVal').attr('href', 'javascript:Checkout()');
                        $('.total_price>td #minVal').html('Checkout <span class="pull-right cart_total" id="cartTotalDue">$' + JSON.parse(data)._cart.total.totalDue.toFixed(2) + '</span>');
                        $('#cartTotalDue').html(currency + JSON.parse(data)._cart.total.subTotal.toFixed(2));
                        $("#minVal").removeAttr("style");
                    }
                    else if (JSON.parse(data)._cart.minValue > JSON.parse(data)._cart.total.subTotal.toFixed(2) && JSON.parse(data)._cart.validateMin) {

                        if ($('#minVal').length > 0) {
                            $('.total_price>td #minVal').attr('href', '#');
                            $('.total_price>td #minVal').html('Minimum Order: <span class="pull-right cart_total" id="cartTotalDue">$' + JSON.parse(data)._cart.minValue.toFixed(2) + '</span>');

                        }
                        else {
                            $('a[href="javascript:Checkout()"]').attr('href', '#');
                            $('a[href="javascript:Checkout()"]').html('Minimum Order: <span class="pull-right cart_total" id="cartTotalDue">$' + JSON.parse(data)._cart.minValue.toFixed(2) + '</span>');
                        }

                        $('#cartTotalDue').html(currency + JSON.parse(data)._cart.minValue.toFixed(2));
                        $('.total_price>td #minVal').removeAttr('href');
                        $("#minVal").css("color", "red");
                    }

                    else {

                        $('.total_price>td #minVal').attr('href', 'javascript:Checkout()');
                        $('.total_price>td #minVal').html('Checkout <span class="pull-right cart_total" id="cartTotalDue">$' + JSON.parse(data)._cart.total.totalDue.toFixed(2) + '</span>');
                        $('#cartTotalDue').html(currency + JSON.parse(data)._cart.total.subTotal.toFixed(2));
                        $("#minVal").removeAttr("style");
                    }

                }
                else {

                    if (JSON.parse(data)._cart.total.subTotal == "0.00") {
                        //location.reload();
                        var id = $('#row_' + cartitemid).attr('boundguest');
                        $('#' + id).html('');
                        $('.total_price').hide();
                        $('#noItems').show();
                        //$('.guestname').hide();
                        $('.qty').text(0);
                        // location.reload();
                    }
                    else {
                        // location.reload();
                        //$('#cartTotalDue').html(parseInt(JSON.parse(data).subTotal).toFixed(2));
                        var id = $('#row_' + cartitemid).attr('boundguest');
                        var subtotal = JSON.parse(data).subTotal;
                        $('.qty').text(JSON.parse(data).qty);
                        if (subtotal != '0.00') {
                            $('#' + id).html(currency + parseFloat(JSON.parse(data).subTotal).toFixed(2) + '');
                        }
                        else {
                            $('#' + id).html('');
                        }
                        // $('#' + id).html(currency+parseFloat(JSON.parse(data).subTotal) + '');
                        $('#orderSend2 a #cartTotalDue').html(currency + parseFloat(JSON.parse(data)._cart.total.subTotal).toFixed(2));
                        $('#orderSend2 a #guestcarttotal').html(currency + parseFloat(JSON.parse(data)._cart.total.subTotal).toFixed(2));
                        $('#orderSendDummy a #cartTotalDue').html(currency + parseFloat(JSON.parse(data)._cart.total.subTotal).toFixed(2));
                        $('#orderSend2Dummy a #cartTotalDue').html(currency + parseFloat(JSON.parse(data)._cart.total.subTotal).toFixed(2));
                        $('#checkouthide a #guestcarttotal').html(currency + parseFloat(JSON.parse(data)._cart.total.subTotal).toFixed(2));
                        $('.total_price a #cartTotalDue').html(currency + parseFloat(JSON.parse(data)._cart.total.subTotal).toFixed(2));
                        $('#orderSend a #cartTotalDue').html(currency + parseFloat(JSON.parse(data)._cart.total.subTotal).toFixed(2));
                        var showcheckout = true;

                        var guestuser = JSON.parse(data)._cart.SplitCheck.Guestusers;
                        for (var i = 0; i < guestuser.length; i++) {
                            for (var j = 0; j < guestuser[i].guestcartItems.length; j++) {
                                if (guestuser[i].guestcartItems[j].isSent == false) {
                                    showcheckout = false;
                                    break;
                                }
                            }
                            if (showcheckout == false) {
                                break;
                            }

                        }
                        if (showcheckout == true) {
                            $('#orderSend').hide();
                            $('#orderSend2').hide();
                            $('#orderSendDummy').show();
                            $('#orderSend2Dummy').show();
                            $('.total_price #checkouthide').show();

                        }
                        else {
                            $('#orderSend').show();
                            $('#orderSend2').show();
                            $('#orderSendDummy').hide();
                            $('#orderSend2Dummy').hide();
                            $('.total_price #checkouthide').hide();
                        }
                    }


                }

                $('#loader').hide();

            },
            error: function (jqXHR, textStatus, errorThrown) {
                $('#loader').hide();
                if (jqXHR.status == 404 || errorThrown == 'Not Found') {
                    $('#promo-modal').modal('show');
                    $('#promo-modal #lblMessage').html('<h4>Oops something happened , please contact store directly</h4>');

                    setTimeout(function () {
                        $('#promo-modal').modal('hide');
                        location.href = "/WelcomePage";
                    }, 3000);

                }
            }
        });

    }
    //--End of  remove functionality in index page without reloading page---//

     //--This method work for index page with reloading page after add item to cart--//
    $(".RI").click(function () {
        //$('#loader').show();
        var cartitemid = this.id;

        $.ajax({
            type: 'get',
            url: '/Checkout?handler=CheckAppliedDiscount&itemId=' + cartitemid,
            data: null,
            contentType: 'application/json;charset=utf-8',
            dataType: 'json',
            success: function (data) {
                 var currency = '$';
                $('#loader').hide();
                //alert(data);
                if (data == 'true') {

                    $('#promo-modal').modal('show');
                    $('#promo-modal .close').hide();
                    $('#promo-modal #lblMessage').html('<h4>The applied offer is being reset now</h4>');
                    setTimeout(function () {
                        $('#promo-modal').modal('hide');
                        $('#promo-modal .close').show();
                        $('#loader').show();
                        RemoveCartItemIndex(cartitemid);
                    }, 3000);

                }
                else {
                    RemoveCartItemIndex(cartitemid);
                }
            },
            error: function (jqXHR, textStatus, errorThrown) {
                $('#loader').hide();
                if (jqXHR.status == 404 || errorThrown == 'Not Found') {
                    $('#promo-modal').modal('show');
                    $('#promo-modal #lblMessage').html('<h4>Oops something happened , please contact store directly</h4>');

                    setTimeout(function () {
                        $('#promo-modal').modal('hide');
                        location.href = "/WelcomePage";
                    }, 3000);
                }
            }
        });

    });

    function RemoveCartItemIndex(cartitemid) {
       // $('#loader').show();
        $.ajax({
            type: 'get',
            url: '/Checkout?handler=IndexRemove&itemId=' + cartitemid,
            data: null,
            contentType: 'application/json;charset=utf-8',
            dataType: 'json',

            success: function (data) {
                 var currency = '$';
                $('#loader').hide();
                $('#row_' + cartitemid).hide();
                if (JSON.parse(data).subTotal == "0.00") {
                    $('.total_price').hide();
                    $('#noItems').show();
                    $('.qty').text(JSON.parse(data).qty);
                    $('.cart_cunt').text(JSON.parse(data).qty);
                    location.reload();
                }
                else {
                    $('.qty').text(JSON.parse(data).qty);
                    $('.cart_cunt').text(JSON.parse(data).qty);
                    $('.total_price').show();
                    $('.cart_total').html(currency + parseFloat(JSON.parse(data).subTotal).toFixed(2));

                }
               location.reload();
                $('#loader').hide();
            },
            error: function (jqXHR, textStatus, errorThrown) {
                $('#loader').hide();
                if (jqXHR.status == 404 || errorThrown == 'Not Found') {
                    $('#promo-modal').modal('show');
                    $('#promo-modal #lblMessage').html('<h4>Oops something happened , please contact store directly</h4>');

                    setTimeout(function () {
                        $('#promo-modal').modal('hide');
                        location.href = "/WelcomePage";
                    }, 3000);
                }
            }
        });
    }
    //--End of  remove functionality in index page with reloading page---//

     //--This method work for checkout page remove item from cart--//
    $(".RIchk").click(function () {
        $('#loader').show();
        var cartitemid = this.id;
        $.ajax({
            type: 'get',
            url: '/Checkout?handler=CheckAppliedDiscount&itemId=' + cartitemid,
            data: null,
            contentType: 'application/json;charset=utf-8',
            dataType: 'json',
            success: function (data) {
                 var currency = '$';
                $('#loader').hide();
                //alert(data);
                if (data == 'true') {

                    $('#promo-modal').modal('show');
                    $('#promo-modal .close').hide();
                    $('#promo-modal #lblMessage').html('<h4>The applied offer is being reset now</h4>');
                    setTimeout(function () {
                        $('#promo-modal').modal('hide');
                        $('#promo-modal .close').show();
                        $('#loader').show();
                        RemoveItem(cartitemid);
                    }, 3000);

                }
                else {
                    RemoveItem(cartitemid);
                }
            },
            error: function (jqXHR, textStatus, errorThrown) {
                $('#loader').hide();
                if (jqXHR.status == 404 || errorThrown == 'Not Found') {
                    $('#promo-modal').modal('show');
                    $('#promo-modal #lblMessage').html('<h4>Oops something happened , please contact store directly</h4>');

                    setTimeout(function () {
                        $('#promo-modal').modal('hide');
                        location.href = "/WelcomePage";
                    }, 3000);
                }
            }
        });
    });

    function RemoveItem(cartitemid) {
        $('#loader').show();
        $.ajax({
            type: 'get',
            url: '/Checkout?handler=Remove&itemId=' + cartitemid,
            data: null,
            contentType: 'application/json;charset=utf-8',
            dataType: 'json',

            success: function (data) {
                //  alert(data);
                 var currency = '$';
                $('#row_' + cartitemid).hide();

                //if (!$('.cart_table #tblCart tr').hasClass('cart_items')) {
                //    window.location.href = 'Index';
                //}
                //alert(parseFloat(JSON.parse(data).subTotal).toFixed(2));

                if (JSON.parse(data).subTotal == "0"|| (JSON.parse(data)._cart.validateMin && parseFloat(JSON.parse(data)._cart.minValue) > parseFloat(JSON.parse(data).subTotal).toFixed(2))) {
                    $('.totalDue').html(currency + parseFloat(JSON.parse(data)._cart.total.subTotal).toFixed(2));
                    $('.taxTotal').html(currency + parseFloat(JSON.parse(data)._cart.total.taxTotal).toFixed(2));
                    $('.subTotal').html(currency + parseFloat(JSON.parse(data)._cart.total.subTotal).toFixed(2));
                    $('.cart_total').html(currency + parseFloat(JSON.parse(data)._cart.total.totalDue).toFixed(2));
                    window.location.href = 'Index';
                }
                else {
                    location.reload();
                    $('.totalDue').html(currency + parseFloat(JSON.parse(data)._cart.total.subTotal).toFixed(2));
                    $('.taxTotal').html(currency + parseFloat(JSON.parse(data)._cart.total.taxTotal).toFixed(2));
                    $('.subTotal').html(currency + parseFloat(JSON.parse(data)._cart.total.subTotal).toFixed(2));
                    $('.cart_total').html(currency + parseFloat(JSON.parse(data)._cart.total.totalDue).toFixed(2));

                    //  location.reload();
                }

                //else {
                //    $('#cartTotalDue').html(parseInt(JSON.parse(data).subTotal).toFixed(2));
                //    $('.qty').text(JSON.parse(data).qty);
                //}

                // window.location.href = 'Index';
            },
            error: function (jqXHR, textStatus, errorThrown) {
                $('#loader').hide();
                if (jqXHR.status == 404 || errorThrown == 'Not Found') {
                    $('#promo-modal').modal('show');
                    $('#promo-modal #lblMessage').html('<h4>Oops something happened , please contact store directly</h4>');

                    setTimeout(function () {
                        $('#promo-modal').modal('hide');
                        location.href = "/WelcomePage";
                    }, 3000);
                }
            }
        });
    }
    //--End of checkout page remove functionality---//

function checkPhn() {

if ($('#phone').val().length == 10) {
$('#changeNo').prop('disabled', false);
} else {
$('#changeNo').prop('disabled', true);
}
}

    function checkPhntakeout() {

        if ($('#phone').val().length == 10) {
            $('#changeNo').prop('disabled', false);
        } else {
            $('#changeNo').prop('disabled', true);
        }
    }

function ChangePhNo() {
$('#loader').show();
if ($('#phone').val() != '') {
//var value = $('#phone').val();
var NumberRegex = /^[0-9]*$/;
if (NumberRegex.test($('#phone').val())) {
//if (value.length <= 10 && value.length >= 8) {
var ph = $('#country-code').val() + " " + $('#phone').val();
$.ajax({
type: 'get',
url: '/Index?handler=SavePh&PhNo=' + ph,
data: null,
contentType: 'application/json;charset=utf-8',
dataType: 'json',

success: function (data) {

$('#phonemodal').modal('hide');
    if (data == "LoyaltyMember") {
        $('#phoneNumber').html(ph);
        location.reload();
    }
    else if (data == "-1") {
        $('#loader').hide();

        $('#pay-modal').modal('show');
        $('#lblPayMessage').html('<h4>Please remove COMO payment before changing Phone Number</h4>');

    }
    else {
        $('#phoneNumber').html(ph);
        $('#loader').hide();

    }

},
error: function (jqXHR, textStatus, errorThrown) {
$('#loader').hide();
if (jqXHR.status == 404 || errorThrown == 'Not Found') {
// $('#promo-modal').modal('show');
//  $('#promo-modal #lblMessage').html('<h4>Oops something happened , please contact store directly</h4>');

setTimeout(function () {
$('#promo-modal').modal('hide');
location.href = "/WelcomePage";
}, 3000);
}
}
});
}
else {
$('#loader').hide();
$('#pay-modal').modal('show');
$('#lblPayMessage').html('<h4>Phone Number is invalid.</h4>');
}
// }

} else {
$('#phoneNumber').html('');
$('#phonemodal').modal('hide');
$('#loader').hide();
location.reload();
}

}

function RemovefromCheckout(cartitemid) {
$('#loader').show();
$.ajax({
type: 'get',
url: '/Index?handler=Remove&itemId=' + cartitemid,
data: null,
contentType: 'application/json;charset=utf-8',
dataType: 'json',

success: function (data) {
$('#loader').hide();
$('#row_' + cartitemid).hide();
//if (JSON.parse(data).subTotal == "0.00") {
//    window.location.href = 'Index';
//}
//else {
//    $('#cartTotalDue').html(parseInt(JSON.parse(data).subTotal).toFixed(2));
//}

window.location.href = 'Index';
},
error: function (jqXHR, textStatus, errorThrown) {
$('#loader').hide();
if (jqXHR.status == 404 || errorThrown == 'Not Found') {
$('#promo-modal').modal('show');
$('#promo-modal #lblMessage').html('<h4>Oops something happened , please contact store directly</h4>');

setTimeout(function () {
$('#promo-modal').modal('hide');
location.href = "/WelcomePage";
}, 3000);
}
}
});

}
var PaymentResponse = 0;
    var IsPaymentSelected = 0;
    var placeOrderHref;
     function DisablePlaceOrder() {
         placeOrderhref = $("#placeOrder td>a").attr('href');
         //$('#placeOrder td>a').attr('href', '#');
         $.each($('#placeOrder'), function () {
             $(this).css("display", "none");
         });
         $('.order-now ').hide();
         //$("#placeOrder").hide();
    }
    function EnablePlaceOrder() {
        //$("#placeOrder td>a").attr("href", placeOrderhref);
        $.each($('#placeOrder'), function () {
            $(this).css("display","");
        });
        $('.order-now ').show();
        //$("#placeOrder").show();
    }
    function PlaceOrder() {
       
        $.when(DisablePlaceOrder()).then(function () {
            $('#loader').show();
            var card = $(".paymentSelected").val();
            var PostalCode = $('#CardPostalCode').val();
            var addressLine = $('#CardaddressLine').val();
            var selectedToken = $('.paymentSelected').val();
            if (selectedToken == undefined) {
                selectedToken = $('.PaymentGcselected').val();
                card = $('.PaymentGcselected').val();
            }
            var nm;
            var email;

            nm = ($("#name").html() == null || $.trim($("#name").html()) == "") ? $("#name").val() : $("#name").html();;
            email = ($("#email").html() == null || $.trim($("#email").html()) == "") ? $("#email").val() : $("#email").html();
           // var phno = $("#phoneNumber").html();
            var spInstr = $("#spInstr").val();
            var emailReg = /^([\w-\.]+@([\w-]+\.)+[\w-]{2,4})?$/;

            var PhnNoSkipped = false;
            var phno = "";

            if (document.getElementById('phoneNumber').nodeName=="P") {
                    phno = $("#phoneNumber").html();
                }
                else {
                    if ($('#phoneNumber').val() != "") {
                        phno = $('#country-code').val() + " " + $('#phoneNumber').val();
                    }

                }

            $.get('/Index?handler=SkipPhn', null, function (data) {

                PhnNoSkipped = parseInt(data);
                 $('#loader').hide();

                if (($.trim(phno) == "" || phno == null) && PhnNoSkipped != 1) {
                    if (document.getElementById('phoneNumber').nodeName == "INPUT") {
                       
                        //$('#ErrorMsgmodel').modal('show');
                      //  $('#modalimg').hide();
                        if (nm == "") {
                            $("#name").focus();
                            
                        }
                        else if (email == "") {
                            $("#email").focus();
                        }
                       
                        else {
                            $('#phoneNumber').focus();
                        }

                    }
                    else {
                        $('#phonemodal').modal('show');
                        $('#loader').hide();
                    }


                    EnablePlaceOrder();
                    return;
                }
                else if (nm == "") {

                    $("#name").focus();
                    EnablePlaceOrder();
                    return;

                }
                else if (email == "") {
                    $("#email").focus();
                    EnablePlaceOrder();
                    return;
                }
                   
                
                else if (!emailReg.test(email)) {
                  
                    $('#email').val("");
                    $('#email').focus();
                    $('#email').attr("placeholder", "Enter valid Email");
                    EnablePlaceOrder();
                    return;
                }
                else if (!isPaymentSelected()) {
                    $('#loader').hide();
                    $('#pay-modal').modal('show');
                    // $('#modalimg').show();
                    $('#lblPayMessage').html('Please select a Payment Method First!');
                    setTimeout(function () {
                        $('#pay-modal').modal('hide');
                    }, 3000);
                    EnablePlaceOrder();
                    return false
                }
                else if (!CheckCartSession()) {

                }

                else if (!CheckForSession())
                {
                    $('#loader').hide();
                    $('#modalimg').hide();
                    $('#StoreClosedmodel').modal('show');
                    $('#lblMessage2').html("Sorry , your session has expired! ");
                    return false;
                }
               
                else {

                    $.get("/Checkout?handler=CheckForTimeSlot", function (data) {
                       

                        if (data == "VALID") {
                            $.ajax({
                                type: 'get',
                                url: '/Checkout?handler=CheckForUpsell',
                                data: null,
                                async: false,
                                contentType: 'application/json;charset=utf-8',
                                dataType: 'json',
                                success: function (data) {
                                    //alert(data);
                                    if (data == 0 || data.html == 0) {

                                        $.get("/Checkout?handler=CheckForDoordash", function (data) {

                                            if (data == "VALID") {
                                                StopTime = true;

                                                if (selectedToken == 'Cash') {
                                                    var selectedToken2;
                                                    var appliedgiftcardcount;
                                                    if ($('.payment_container .PaymentGcselected ').length == 1) {
                                                        selectedToken2 = $('.PaymentGcselected').val();
                                                    }
                                                    else {
                                                        appliedgiftcardcount = $('.payment_container .PaymentGcselected ').length;
                                                    }

                                                    if (selectedToken2 != undefined || appliedgiftcardcount > 1) {
                                                        card = $('.PaymentGcselected').val();
                                                        $.when(GetPayment(nm, email)).done(function () {

                                                            if (PaymentResponse == 1) {
                                                                $('#div_closemodal').hide();
                                                                $('#modalimg').show();
                                                                $('#ErrorMsgmodel').modal({ backdrop: 'static', keyboard: false });
                                                                $('#closeButton').hide();
                                                                $('#lblMessage1').html('<h4>Payment approved and now processing order to restaurant</h4>');

                                                                if (phno == null || $.trim(phno) == "") { phno = '0' }

                                                                if (card.split('-')[0] == "TCC") {
                                                                    Paymentmethod = "TCC";
                                                                }
                                                                else {
                                                                    Paymentmethod = "";
                                                                }
                                                                alert(Paymentmethod);
                                                                try {
                                                                    $.ajax({
                                                                        type: 'get',
                                                                        url: '/Checkout?handler=PlaceOrder',
                                                                        //url: '/Checkout?handler=PlaceOrder&payOrder=2&Name=' + nm + '&PhNo=' + phno + '&email=' + email + '&instr=' + spInstr ,
                                                                        data: { "payOrder": 3, "Name": nm, "PhNo": phno, "email": email, "instr": spInstr, "Paymentmethod": Paymentmethod },
                                                                        contentType: 'application/json;charset=utf-8',
                                                                        dataType: 'json',

                                                                        success: function (data) {
                                                                            //window.clearTimeout(longWaitTimerId); no Need now , we are not checking time for place order response here.(Aditya)

                                                                            //$('#promo-modal').modal('show');

                                                                            if (data == "") {
                                                                                $('#div_closemodal').show();
                                                                                $('#modalimg').hide();
                                                                                //  $('#lblMessage1').html('<h4>Refund is initiated.We are unable to place order, contact store directly to place order</h4>');
                                                                                $('#lblMessage1').html('<h4>Failed to get order confirmation, we will email you as soon as the order is confirmed by the restaurant</h4>');
                                                                                //EnablePlaceOrder();
                                                                            }
                                                                            else if (data.split('-')[0] == "Order Fulfilled") {
                                                                                $('.modal').modal('hide');
                                                                                $('#BusyHour-modal').modal('show');

                                                                                $('#BusyHour-modal #msgprompt').html(data.split('-')[1]);
                                                                                if (data.split('-')[1].includes('retry')) {
                                                                                    $('#BusyHour-modal .slotsavailable').hide();
                                                                                    $('#BusyHour-modal .noslots').show();
                                                                                }
                                                                                else {
                                                                                    $('#BusyHour-modal .noslots').hide();
                                                                                    $('#BusyHour-modal .slotsavailable').show();
                                                                                }
                                                                                //RemoveUserTimeslot();
                                                                                EnablePlaceOrder();
                                                                            }
                                                                            else if (data == "null") {
                                                                                $('#div_closemodal').show();
                                                                                $('#modalimg').hide();
                                                                                $('#lblMessage1').html('<h4>Your cart is empty, please start over.</h4>');
                                                                                EnablePlaceOrder();
                                                                            }
                                                                            else {
                                                                                $('#loader').show();
                                                                                window.location.href = data;


                                                                            }
                                                                        },
                                                                        error: function (jqXHR, textStatus, errorThrown) {
                                                                            $('#loader').hide();

                                                                            if (jqXHR.status == 404 || errorThrown == 'Not Found') {
                                                                                $('#promo-modal').modal('show');
                                                                                $('#promo-modal #lblMessage').html('<h4>Oops something happened , please contact store directly</h4>');
                                                                                EnablePlaceOrder();
                                                                                setTimeout(function () {
                                                                                    $('#promo-modal').modal('hide');
                                                                                    location.href = "/WelcomePage";
                                                                                }, 3000);
                                                                            }
                                                                        }

                                                                    });
                                                                }
                                                                catch
                                                                {
                                                                    $('#ErrorMsgmodel').modal('hide');
                                                                    $('#pay-modal').modal('show'); $('#lblPayMessage').html('<h4>Something went wrong.</h4>');

                                                                }
                                                            }
                                                            else if (PaymentResponse == 2) {
                                                                StopTime = false;

                                                                var selectedToken = $('.paymentSelected').val();
                                                                if (selectedToken.split('-')[1] == "TCC") {
                                                                    var tcccardnumber = selectedToken.split('-')[1];
                                                                }
                                                                //$('#ErrorMsgmodel').modal('hide');
                                                                $('#modalimg').hide();
                                                                $('#ErrorMsgmodel #closeButton').show();
                                                                // $('#promo-modal').modal('show');
                                                                $('#ErrorMsgmodel #lblMessage1').html('<h4>Your card has insufficient balance, <a href="Javascript:ChangeGiftCardRequest(false,' + tcccardnumber + ')" style="color:red">click here</a> to reload your card</h4>');
                                                                EnablePlaceOrder();
                                                            }
                                                            else if (PaymentResponse == 3) {
                                                                StopTime = false;
                                                                //$('#ErrorMsgmodel').modal('hide');
                                                                var selectedToken = $('.paymentSelected').val();
                                                                if (selectedToken.split('-')[1] == "TCC") {
                                                                    var tcccardnumber = selectedToken.split('-')[1];
                                                                }
                                                                $('#modalimg').hide();
                                                                $('#ErrorMsgmodel #closeButton').show();
                                                                // $('#promo-modal').modal('show');
                                                                $('#ErrorMsgmodel #lblMessage1').html('<h4>Your card is not activated, <a href="Javascript:ChangeGiftCardRequest(true,' + tcccardnumber + ')" style="color:red">click here</a> to activate your card</h4>');
                                                                EnablePlaceOrder();
                                                            }
                                                            else if (PaymentResponse == 11) {
                                                                $('#loader').hide();
                                                                $('#ErrorMsgmodel').modal('hide');
                                                                $('#modalimg').hide();
                                                                EnablePlaceOrder();
                                                            }
                                                            else if (PaymentResponse != 99) {
                                                                StopTime = false;
                                                                $('#loader').hide();
                                                                $('#ErrorMsgmodel').modal('hide');
                                                                $('#modalimg').hide();
                                                                $('#pay-modal').modal('show'); $('#lblPayMessage').html('<h4> Payment was failed.Contact store directly to place the order. </h4>');
                                                                EnablePlaceOrder();
                                                                setTimeout(function () {
                                                                    $('#pay-modal').modal('hide');
                                                                }, 5000);

                                                            }
                                                            $('#loader').hide();
                                                        });
                                                    }
                                                    else {
                                                        $('#loader').hide();
                                                        $('#div_closemodal').hide();
                                                        $('#modalimg').show();
                                                        $('#ErrorMsgmodel').modal({ backdrop: 'static', keyboard: false });
                                                        $('#closeButton').hide();
                                                        $('#lblMessage1').html('<h4>Processing order to restaurant</h4>');
                                                        try {
                                                            $.ajax({
                                                                type: 'get',
                                                                url: '/Checkout?handler=PlaceOrder&payOrder=3&Name=' + nm + '&PhNo=' + phno + '&email=' + email + '&instr=' + spInstr,
                                                                data: null,
                                                                contentType: 'application/json;charset=utf-8',
                                                                dataType: 'json',

                                                                success: function (data) {


                                                                    if (data == "") {
                                                                        StopTime = false;
                                                                        $('#div_closemodal').show();
                                                                        $('#modalimg').hide();
                                                                        $('#lblMessage1').html('<h4>We are unable to place order, contact store directly to place order</h4>');
                                                                        EnablePlaceOrder();
                                                                    }
                                                                    else if (data.split('-')[0] == "Order Fulfilled") {
                                                                        $('.modal').modal('hide');
                                                                        $('#BusyHour-modal').modal('show');
                                                                        $('#BusyHour-modal #msgprompt').html(data.split('-')[1]);
                                                                        if (data.split('-')[1].includes('retry')) {
                                                                            $('#BusyHour-modal .slotsavailable').hide();
                                                                            $('#BusyHour-modal .noslots').show();
                                                                        }
                                                                        else {
                                                                            $('#BusyHour-modal .noslots').hide();
                                                                            $('#BusyHour-modal .slotsavailable').show();
                                                                        }
                                                                        EnablePlaceOrder();
                                                                    }
                                                                    else if (data == "null") {
                                                                        StopTime = false;
                                                                        $('#div_closemodal').show();
                                                                        $('#modalimg').hide();
                                                                        $('#lblMessage1').html('<h4>Your cart is empty, please start over.</h4>');
                                                                        EnablePlaceOrder();
                                                                    }
                                                                    else {
                                                                        // $('#modalimg').attr('src', '/img/success.gif'); $('#lblMessage1').html('<h4>Done!</h4>');
                                                                        //  setTimeout(function () {
                                                                        $('#ErrorMsgmodel').modal('hide');
                                                                        $('#loader').show();
                                                                        window.location.href = data;
                                                                        //$('#ErrorMsgmodel').modal('show'); $('#lblMessage1').html('<h4> It is taking time for getting store order confirmation , please wait for few minutes and do not refresh or click back </h4>');

                                                                        // }, 5000);

                                                                    }
                                                                },
                                                                error: function (jqXHR, textStatus, errorThrown) {
                                                                    StopTime = false;
                                                                    if (jqXHR.status == 404 || errorThrown == 'Not Found') {
                                                                        $('#promo-modal').modal('show');
                                                                        EnablePlaceOrder();
                                                                        $('#promo-modal #lblMessage').html('<h4>Oops something happened , please contact store directly</h4>');
                                                                        location.href = "/welcomepage";
                                                                    }
                                                                }

                                                            });
                                                        }
                                                        catch
                                                        {
                                                            $('#ErrorMsgmodel').modal('hide');
                                                            $('#pay-modal').modal('show'); $('#lblPayMessage').html('<h4>Something went wrong.</h4>');

                                                        }
                                                    }
                                                }

                                                else {

                                                    $.when(GetPayment(nm, email)).done(function () {

                                                        if (PaymentResponse == 1) {
                                                            $('#div_closemodal').hide();
                                                            $('#modalimg').show();
                                                            $('#ErrorMsgmodel').modal({ backdrop: 'static', keyboard: false });
                                                            $('#closeButton').hide();
                                                            $('#lblMessage1').html('<h4>Payment approved and now processing order to restaurant</h4>');

                                                            if (phno == null || $.trim(phno) == "") { phno = '0' }
                                                            if (card.split('-')[0] == "TCC") {
                                                                Paymentmethod = "TCC";
                                                            }
                                                            else {
                                                                Paymentmethod = "";
                                                            }
                                                            try {
                                                                $.ajax({
                                                                    type: 'get',
                                                                    url: '/Checkout?handler=PlaceOrder',
                                                                    //url: '/Checkout?handler=PlaceOrder&payOrder=2&Name=' + nm + '&PhNo=' + phno + '&email=' + email + '&instr=' + spInstr ,
                                                                    data: { "payOrder": 2, "Name": nm, "PhNo": phno, "email": email, "instr": spInstr, "Paymentmethod": Paymentmethod },
                                                                    contentType: 'application/json;charset=utf-8',
                                                                    dataType: 'json',

                                                                    success: function (data) {

                                                                        if (data == "") {
                                                                            $('#div_closemodal').show();
                                                                            $('#modalimg').hide();
                                                                            EnablePlaceOrder();
                                                                            $('#lblMessage1').html('<h4>Refund is initiated.We are unable to place order, contact store directly to place order</h4>');
                                                                        }
                                                                        else if (data.split('-')[0] == "Order Fulfilled") {
                                                                            $('.modal').modal('hide');
                                                                            $('#BusyHour-modal').modal('show');
                                                                            $('#BusyHour-modal #msgprompt').html(data.split('-')[1]);
                                                                            if (data.split('-')[1].includes('retry')) {
                                                                                $('#BusyHour-modal .slotsavailable').hide();
                                                                                $('#BusyHour-modal .noslots').show();
                                                                            }
                                                                            else {
                                                                                $('#BusyHour-modal .noslots').hide();
                                                                                $('#BusyHour-modal .slotsavailable').show();
                                                                            }
                                                                            EnablePlaceOrder();
                                                                        }
                                                                        else if (data == "null") {
                                                                            $('#div_closemodal').show();
                                                                            $('#modalimg').hide();
                                                                            $('#lblMessage1').html('<h4>Your cart is empty, please start over.</h4>');
                                                                            EnablePlaceOrder();
                                                                        }
                                                                        else {
                                                                            // $('#modalimg').attr('src', '/img/success.gif'); $('#lblMessage1').html('<h4>Done!</h4>');
                                                                            //setTimeout(function () {
                                                                            //$('#ErrorMsgmodel').modal('hide');
                                                                            $('#loader').show();
                                                                            console.log(data);
                                                                            document.location.assign(document.location.origin + data);

                                                                            //window.location.href = 'Confirmation';
                                                                            //$('#ErrorMsgmodel').modal('show'); $('#lblMessage1').html('<h4> It is taking time for getting store order confirmation , please wait for few minutes and do not refresh or click back </h4>');
                                                                            //}, 5000);

                                                                        }
                                                                    },
                                                                    error: function (jqXHR, textStatus, errorThrown) {
                                                                        $('#ErrorMsgmodel').modal('hide');
                                                                        $('#loader').hide();
                                                                        if (jqXHR.status == 504) {

                                                                            location.href = "/Confirmation?Finalize=1";
                                                                            // $('#promo-modal').modal('show');
                                                                            //  EnablePlaceOrder();
                                                                            // $('#promo-modal #lblMessage').html('<h4>Oops something happened , please contact store directly. If Order was not processed - payment if any will be reverted</h4>');


                                                                        }
                                                                        if (jqXHR.status == 404 || errorThrown == 'Not Found') {
                                                                            $('#promo-modal').modal('show');
                                                                            EnablePlaceOrder();
                                                                            $('#promo-modal #lblMessage').html('<h4>Oops something happened , please contact store directly</h4>');

                                                                            setTimeout(function () {
                                                                                $('#promo-modal').modal('hide');
                                                                                location.href = "/WelcomePage";
                                                                            }, 3000);
                                                                        }





                                                                    }

                                                                });
                                                            }
                                                            catch
                                                            {
                                                                $('#ErrorMsgmodel').modal('hide');
                                                                $('#pay-modal').modal('show'); $('#lblPayMessage').html('<h4>Something went wrong.</h4>');

                                                            }
                                                        }
                                                        else if (PaymentResponse == 2) {
                                                            StopTime = false;
                                                            var selectedToken = $('.paymentSelected').val();
                                                            if (selectedToken.split('-')[1] == "TCC") {
                                                                var tcccardnumber = selectedToken.split('-')[1];
                                                            }
                                                            //$('#ErrorMsgmodel').modal('hide');
                                                            $('#modalimg').hide();
                                                            $('#ErrorMsgmodel #closeButton').show();
                                                            EnablePlaceOrder();
                                                            // $('#promo-modal').modal('show');
                                                            $('#ErrorMsgmodel #lblMessage1').html('<h4>Your card has insufficient balance, <a href="Javascript:ChangeGiftCardRequest(false,' + tcccardnumber + ')" style="color:red">click here</a> to reload your card</h4>');
                                                        }
                                                        else if (PaymentResponse == 3) {
                                                            StopTime = false;
                                                            //$('#ErrorMsgmodel').modal('hide');
                                                            var selectedToken = $('.paymentSelected').val();
                                                            if (selectedToken.split('-')[1] == "TCC") {
                                                                var tcccardnumber = selectedToken.split('-')[1];
                                                            }
                                                            $('#modalimg').hide();
                                                            $('#ErrorMsgmodel #closeButton').show();
                                                            EnablePlaceOrder();
                                                            // $('#promo-modal').modal('show');
                                                            $('#ErrorMsgmodel #lblMessage1').html('<h4>Your card is not activated, <a href="Javascript:ChangeGiftCardRequest(true,' + tcccardnumber + ')" style="color:red">click here</a> to activate your card</h4>');
                                                        }
                                                        else if (PaymentResponse == 11) {
                                                            $('#loader').hide();
                                                            $('#ErrorMsgmodel').modal('hide');
                                                            $('#modalimg').hide();
                                                            EnablePlaceOrder();
                                                        }
                                                        else if (PaymentResponse != 99) {
                                                            StopTime = false;
                                                            $('#loader').hide();
                                                            $('#ErrorMsgmodel').modal('hide');
                                                            $('#pay-modal').modal('show'); $('#lblPayMessage').html('<h4> Payment was failed.Contact store directly to place the order. </h4>');
                                                            EnablePlaceOrder();
                                                            setTimeout(function () {
                                                                $('#pay-modal').modal('hide');
                                                            }, 5000);

                                                        }
                                                        $('#loader').hide();
                                                    });


                                                }
                                            }
                                            else {
                                                $('#loader').hide();
                                                $('#pay-modal').modal('show');
                                                $('#lblPayMessage').html(data);
                                                EnablePlaceOrder();
                                            }
                                        });

                                    }
                                    else {
                                        $('#loader').hide();
                                        $('#upsellbody').html('');
                                        $('#upsellname').html(data.name);
                                        $('#upsellbody').append(data.html);
                                        $('#Upsellmodal').modal('show');
                                        EnablePlaceOrder();
                                    }

                                }
                            });
                        }
                        else if (data == "STORECLOSED") {
                            $('#loader').hide();
                            $('#modalimg').hide();
                            $('#StoreClosedmodel').modal('show');
                            $('#lblMessage2').html("Unable to Place an Order Store is Closed ! ");
                          
                            return false;
                        }
                        else {


                            //              resetOrderrTime
                            $('#loader').hide();
                            $('#modalimg').hide();
                            $('#resetOrderTime-modal').modal({ backdrop: 'static', keyboard: false });
                            $('#promptOrderTime').html(data);
                            EnablePlaceOrder();
                        }
                    })

                  
                }
                //CheckCartSession);
            });
        });
    }



    function PlaceOrderAUTHNET(response) {
        $.when(DisablePlaceOrder()).then(function () {
            $('#loader').show();

            var nm;
            var email;

            nm = ($("#name").html() == null || $.trim($("#name").html()) == "") ? $("#name").val() : $("#name").html();;
            email = ($("#email").html() == null || $.trim($("#email").html()) == "") ? $("#email").val() : $("#email").html();
           /* var phno = $("#phoneNumber").html();*/
            var spInstr = $("#spInstr").val();
            var emailReg = /^([\w-\.]+@([\w-]+\.)+[\w-]{2,4})?$/;
            var phno = "";

            if (document.getElementById('phoneNumber').nodeName == "P") {
                phno = $("#phoneNumber").html();
            }
            else {
                if ($('#phoneNumber').val() != "") {
                    phno = $('#country-code').val() + " " + $('#phoneNumber').val();
                }

            }
            var PhnNoSkipped = false;
            $.get('/Index?handler=SkipPhn', null, function (data) {
                PhnNoSkipped = parseInt(data);

                if (($.trim(phno) == "" || phno == null) && PhnNoSkipped != 1) {
                    if (document.getElementById('phoneNumber').nodeName == "INPUT") {

                        //$('#ErrorMsgmodel').modal('show');
                        //  $('#modalimg').hide();
                        if (nm == "") {
                            $("#name").focus();

                        }
                        else if (email == "") {
                            $("#email").focus();
                        }

                        else {
                            $('#phoneNumber').focus();
                        }

                    }
                    else {
                        $('#phonemodal').modal('show');
                        $('#loader').hide();
                    }


                    EnablePlaceOrder();
                    return;
                }
                else if (nm == "") {

                    $("#name").focus();
                    EnablePlaceOrder();
                    return;

                }
                else if (email == "") {
                    $("#email").focus();
                    EnablePlaceOrder();
                    return;
                }


                else if (!emailReg.test(email)) {

                    $('#email').val("");
                    $('#email').focus();
                    $('#email').attr("placeholder", "Enter valid Email");
                    EnablePlaceOrder();
                    return;
                }
               
                else if (!CheckCartSession()) {

                }



                else {

                    $.get("/Checkout?handler=CheckForDoordash", function (data) {
                        StopTime = true;
                        if (data == "VALID") {


                            var transRes = JSON.parse(response);

                            if (transRes.responseCode = "1") {


                                $('#div_closemodal').hide();
                                $('#modalimg').show();
                                $('#ErrorMsgmodel').modal({ backdrop: 'static', keyboard: false });
                                $('#closeButton').hide();
                                $('#lblMessage1').html('<h4>Payment approved and now processing order to restaurant</h4>');

                                if (phno == null || $.trim(phno) == "") { phno = '0' }
                                try {
                                    $.ajax({
                                        type: 'get',
                                        url: '/Checkout?handler=PlaceOrder',

                                        data: { "payOrder": 5, "Name": nm, "PhNo": phno, "email": email, "instr": spInstr, "Paymentmethod": response },
                                        contentType: 'application/json;charset=utf-8',
                                        dataType: 'json',

                                        success: function (data) {

                                            if (data == "") {
                                                StopTime = false;
                                                $('#div_closemodal').show();
                                                $('#modalimg').hide();
                                                EnablePlaceOrder();
                                                $('#lblMessage1').html('<h4>Refund is initiated.We are unable to place order, contact store directly to place order</h4>');
                                            }
                                            else if (data.split('-')[0] == "Order Fulfilled") {
                                                $('.modal').modal('hide');
                                                $('#BusyHour-modal').modal('show');
                                                $('#BusyHour-modal #msgprompt').html(data.split('-')[1]);
                                                if (data.split('-')[1].includes('retry')) {
                                                    $('#BusyHour-modal .slotsavailable').hide();
                                                    $('#BusyHour-modal .noslots').show();
                                                }
                                                else {
                                                    $('#BusyHour-modal .noslots').hide();
                                                    $('#BusyHour-modal .slotsavailable').show();
                                                }
                                                EnablePlaceOrder();
                                            }
                                            else if (data == "null") {
                                                StopTime = false;
                                                $('#div_closemodal').show();
                                                $('#modalimg').hide();
                                                EnablePlaceOrder();
                                                $('#lblMessage1').html('<h4>Your cart is empty, please start over.</h4>');
                                            }
                                            else {
                                                // $('#modalimg').attr('src', '/img/success.gif'); $('#lblMessage1').html('<h4>Done!</h4>');
                                                //setTimeout(function () {
                                                //$('#ErrorMsgmodel').modal('hide');
                                                $('#loader').show();
                                                console.log(data);
                                                document.location.assign(document.location.origin + data);

                                                //window.location.href = 'Confirmation';
                                                //$('#ErrorMsgmodel').modal('show'); $('#lblMessage1').html('<h4> It is taking time for getting store order confirmation , please wait for few minutes and do not refresh or click back </h4>');
                                                //}, 5000);

                                            }
                                        },
                                        error: function (jqXHR, textStatus, errorThrown) {
                                            StopTime = false;
                                            $('#loader').hide();
                                            if (jqXHR.status == 404 || errorThrown == 'Not Found') {
                                                $('#promo-modal').modal('show');
                                                $('#promo-modal #lblMessage').html('<h4>Oops something happened , please contact store directly</h4>');
                                                EnablePlaceOrder();
                                                setTimeout(function () {
                                                    $('#promo-modal').modal('hide');
                                                    location.href = "/WelcomePage";
                                                }, 3000);
                                            }
                                        }

                                    });
                                }
                                catch
                                {
                                    $('#ErrorMsgmodel').modal('hide');
                                    $('#pay-modal').modal('show'); $('#lblPayMessage').html('<h4>Something went wrong.</h4>');

                                }
                            }

                            else if (PaymentResponse != 99) {
                                StopTime = false;
                                $('#loader').hide();
                                $('#ErrorMsgmodel').modal('hide');
                                $('#pay-modal').modal('show'); $('#lblPayMessage').html('<h4> Payment was failed.Contact store directly to place the order. </h4>');
                                EnablePlaceOrder();
                                setTimeout(function () {
                                    $('#pay-modal').modal('hide');
                                }, 5000);

                            }
                            $('#loader').hide();
                        }
                        else {
                            StopTime = false;
                            $('#loader').hide();
                            $('#pay-modal').modal('show');
                            $('#lblPayMessage').html(data);
                            EnablePlaceOrder();
                        }
                    });



                }
            });
        });
    }


   
    function PlaceOrderCOMO() {
        $.when(DisablePlaceOrder()).then(function () {
            $('#loader').show();
            var card = $(".paymentSelected").val();
            var PostalCode = $('#CardPostalCode').val();
            var addressLine = $('#CardaddressLine').val();

            var nm;
            var email;
            //if (card == undefined) {
            //     nm = $("#name").html();

            //}
            //else {
            //    nm = $("#name").val();

            //}
            nm = ($("#name").html() == null || $.trim($("#name").html()) == "") ? $("#name").val() : $("#name").html();;
            email = ($("#email").html() == null || $.trim($("#email").html()) == "") ? $("#email").val() : $("#email").html();
            //var phno = $("#phoneNumber").html();
            var spInstr = $("#spInstr").val();
            var emailReg = /^([\w-\.]+@([\w-]+\.)+[\w-]{2,4})?$/;
            var phno = "";

            if (document.getElementById('phoneNumber').nodeName == "P") {
                phno = $("#phoneNumber").html();
            }
            else {
                if ($('#phoneNumber').val() != "") {
                    phno = $('#country-code').val() + " " + $('#phoneNumber').val();
                }

            }
            var PhnNoSkipped = false;
            $.get('/Index?handler=SkipPhn', null, function (data) {
                PhnNoSkipped = parseInt(data);

                if (($.trim(phno) == "" || phno == null) && PhnNoSkipped != 1) {
                    if (document.getElementById('phoneNumber').nodeName == "INPUT") {

                        //$('#ErrorMsgmodel').modal('show');
                        //  $('#modalimg').hide();
                        if (nm == "") {
                            $("#name").focus();

                        }
                        else if (email == "") {
                            $("#email").focus();
                        }

                        else {
                            $('#phoneNumber').focus();
                        }

                    }
                    else {
                        $('#phonemodal').modal('show');
                        $('#loader').hide();
                    }


                    EnablePlaceOrder();
                    return;
                }
                else if (nm == "") {

                    $("#name").focus();
                    EnablePlaceOrder();
                    return;

                }
                else if (email == "") {
                    $("#email").focus();
                    EnablePlaceOrder();
                    return;
                }


                else if (!emailReg.test(email)) {

                    $('#email').val("");
                    $('#email').focus();
                    $('#email').attr("placeholder", "Enter valid Email");
                    EnablePlaceOrder();
                    return;
                }
                
                else if (!CheckCartSession()) {

                }
else {

                    $.get("/Checkout?handler=CheckForDoordash", function (data) {
                        StopTime = true;
                        if (data == "VALID") {

                            $('#loader').hide();
                            $('#div_closemodal').hide();
                            $('#modalimg').show();
                            $('#ErrorMsgmodel').modal({ backdrop: 'static', keyboard: false });
                            $('#closeButton').hide();
                            $('#lblMessage1').html('<h4>Processing order to restaurant</h4>');
                            try {
                                $.ajax({
                                    type: 'get',
                                    url: '/Checkout?handler=PlaceOrder&payOrder=2&Name=' + nm + '&PhNo=' + phno + '&email=' + email + '&instr=' + spInstr,
                                    data: null,
                                    contentType: 'application/json;charset=utf-8',
                                    dataType: 'json',

                                    success: function (data) {


                                        if (data == "") {
                                            StopTime = false;
                                            $('#div_closemodal').show();
                                            $('#modalimg').hide();
                                            EnablePlaceOrder();
                                            $('#lblMessage1').html('<h4>We are unable to place order, contact store directly to place order</h4>');

                                        }
                                        else if (data.split('-')[0] == "Order Fulfilled") {
                                            $('.modal').modal('hide');
                                            $('#BusyHour-modal').modal('show');
                                            $('#BusyHour-modal #msgprompt').html(data.split('-')[1]);
                                            if (data.split('-')[1].includes('retry')) {
                                                $('#BusyHour-modal .slotsavailable').hide();
                                                $('#BusyHour-modal .noslots').show();
                                            }
                                            else {
                                                $('#BusyHour-modal .noslots').hide();
                                                $('#BusyHour-modal .slotsavailable').show();
                                            }
                                            EnablePlaceOrder();
                                        }
                                        else if (data == "null") {
                                            StopTime = false;
                                            $('#div_closemodal').show();
                                            $('#modalimg').hide();
                                            EnablePlaceOrder();
                                            $('#lblMessage1').html('<h4>Your cart is empty, please start over.</h4>');
                                        }
                                        else {


                                            $('#loader').show();
                                            $('#ErrorMsgmodel').modal('hide');
                                            console.log(data);
                                            document.location.assign(document.location.origin + data)
                                            //$('#ErrorMsgmodel').modal('show'); $('#lblMessage1').html('<h4> It is taking time for getting store order confirmation , please wait for few minutes and do not refresh or click back </h4>');

                                            // }, 5000);

                                        }
                                    },
                                    error: function (jqXHR, textStatus, errorThrown) {
                                        StopTime = false;
                                        if (jqXHR.status == 404 || errorThrown == 'Not Found') {
                                            $('#promo-modal').modal('show');
                                            EnablePlaceOrder();
                                            $('#promo-modal #lblMessage').html('<h4>Oops something happened , please contact store directly</h4>');
                                            location.href = "/welcomepage";
                                        }
                                    }

                                });
                            }
                            catch
                            {
                                $('#ErrorMsgmodel').modal('hide');
                                $('#pay-modal').modal('show'); $('#lblPayMessage').html('<h4>Something went wrong.</h4>');

                            }
                        }
                        else {
                            StopTime = false;
                            $('#loader').hide();
                            $('#pay-modal').modal('show');
                            $('#lblPayMessage').html(data);
                            EnablePlaceOrder();
                        }
                    });

                }
            });
        });
    }


    function PlaceOrderSTRIPE() {
        $.when(DisablePlaceOrder()).then(function () {
            $('#loader').show();
            var card = $(".paymentSelected").val();
            var PostalCode = $('#CardPostalCode').val();
            var addressLine = $('#CardaddressLine').val();

            var nm;
            var email;
            //if (card == undefined) {
            //     nm = $("#name").html();

            //}
            //else {
            //    nm = $("#name").val();

            //}
            nm = ($("#name").html() == null || $.trim($("#name").html()) == "") ? $("#name").val() : $("#name").html();;
            email = ($("#email").html() == null || $.trim($("#email").html()) == "") ? $("#email").val() : $("#email").html();
            //var phno = $("#phoneNumber").html();
            var spInstr = $("#spInstr").val();
            var emailReg = /^([\w-\.]+@([\w-]+\.)+[\w-]{2,4})?$/;
            var phno = "";

            if (document.getElementById('phoneNumber').nodeName == "P") {
                phno = $("#phoneNumber").html();
            }
            else {
                if ($('#phoneNumber').val() != "") {
                    phno = $('#country-code').val() + " " + $('#phoneNumber').val();
                }

            }
        
                            try {
                                $.ajax({
                                    type: 'get',
                                    url: '/Checkout?handler=PlaceOrder&payOrder=4&Name=' + nm + '&PhNo=' + phno + '&email=' + email + '&instr=' + spInstr,
                                    data: null,
                                    contentType: 'application/json;charset=utf-8',
                                    dataType: 'json',

                                    success: function (data) {


                                        if (data == "") {
                                            StopTime = false;
                                            $('#div_closemodal').show();
                                            $('#modalimg').hide();
                                            EnablePlaceOrder();
                                            $('#lblMessage1').html('<h4>We are unable to place order, contact store directly to place order</h4>');

                                        }
                                        else if (data.split('-')[0] == "Order Fulfilled") {
                                            $('.modal').modal('hide');
                                            $('#BusyHour-modal').modal('show');
                                            $('#BusyHour-modal #msgprompt').html(data.split('-')[1]);
                                            if (data.split('-')[1].includes('retry')) {
                                                $('#BusyHour-modal .slotsavailable').hide();
                                                $('#BusyHour-modal .noslots').show();
                                            }
                                            else {
                                                $('#BusyHour-modal .noslots').hide();
                                                $('#BusyHour-modal .slotsavailable').show();
                                            }
                                            EnablePlaceOrder();
                                        }
                                        else if (data == "null") {
                                            StopTime = false;
                                            $('#div_closemodal').show();
                                            $('#modalimg').hide();
                                            EnablePlaceOrder();
                                            $('#lblMessage1').html('<h4>Your cart is empty, please start over.</h4>');
                                        }
                                        else {


                                            $('#loader').show();
                                            $('#ErrorMsgmodel').modal('hide');
                                            console.log(data);
                                            document.location.assign(document.location.origin + data)
                                            //$('#ErrorMsgmodel').modal('show'); $('#lblMessage1').html('<h4> It is taking time for getting store order confirmation , please wait for few minutes and do not refresh or click back </h4>');

                                            // }, 5000);

                                        }
                                    },
                                    error: function (jqXHR, textStatus, errorThrown) {
                                        StopTime = false;
                                        if (jqXHR.status == 404 || errorThrown == 'Not Found') {
                                            $('#promo-modal').modal('show');
                                            EnablePlaceOrder();
                                            $('#promo-modal #lblMessage').html('<h4>Oops something happened , please contact store directly</h4>');
                                            location.href = "/welcomepage";
                                        }
                                    }

                                });
                            }
                            catch
                            {
                                $('#ErrorMsgmodel').modal('hide');
                                $('#pay-modal').modal('show'); $('#lblPayMessage').html('<h4>Something went wrong.</h4>');

                            }
                     

                
           
        });
    }
    function RemoveUserTimeslot()
    {
        $('#loader').show();
        $.ajax({
            type: 'get',
            url: '/Index?handler=ResetSelectedTimeSlot',
            data: null,
            contentType: 'application/json;charset=utf-8',
            dataType: 'json',
            success: function (data) {
                $('#loader').hide();



                if (data == "1") {
                    window.location = '/Index';
                }

            },
            error: function (jqXHR, textStatus, errorThrown) {
                $('#loader').hide();
                if (jqXHR.status == 404 || errorThrown == 'Not Found') {

                    //$('#promo-modal').modal('show');
                   // $('#promo-modal #lblMessage').html('<h4>Oops something happened , please try again!</h4>');

                    setTimeout(function () {
                       // $('#promo-modal').modal('hide');
                        location.href = "/WelcomePage";
                    }, 3000);
                }
            }
        });

    }

    function SetAvailableTimeSlotCheckout(){
         $('#loader').show();
        $.ajax({
            type: 'get',
            url: '/Checkout?handler=SetAvailableTimeSlotCheckout',
            data: null,
            contentType: 'application/json;charset=utf-8',
            dataType: 'json',
            success: function (data) {
                //$('#loader').hide();



                if (data == "1") {
                    window.location = '/Checkout';
                }

            },
            error: function (jqXHR, textStatus, errorThrown) {
                $('#loader').hide();
                if (jqXHR.status == 404 || errorThrown == 'Not Found') {

                    //$('#promo-modal').modal('show');
                   // $('#promo-modal #lblMessage').html('<h4>Oops something happened , please try again!</h4>');

                    setTimeout(function () {
                       // $('#promo-modal').modal('hide');
                        location.href = "/WelcomePage";
                    }, 3000);
                }
            }
        });
    }

    function SetAvailableTimeSlotPlaceOrder(){
         $('#loader').show();
        $.ajax({
            type: 'get',
            url: '/Checkout?handler=SetAvailableTimeSlotCheckout',
            data: null,
            contentType: 'application/json;charset=utf-8',
            dataType: 'json',
            success: function (data) {

                if (data == "1") {
                    ProcessOrder();
                }

            },
            error: function (jqXHR, textStatus, errorThrown) {
                $('#loader').hide();
                if (jqXHR.status == 404 || errorThrown == 'Not Found') {

                    //$('#promo-modal').modal('show');
                   // $('#promo-modal #lblMessage').html('<h4>Oops something happened , please try again!</h4>');

                    setTimeout(function () {
                       // $('#promo-modal').modal('hide');
                        location.href = "/WelcomePage";
                    }, 3000);
                }
            }
        });
    }
function ChangeGiftCardRequest(requesttype,cardnumber) {
//alert(requesttype);
$('#loader').show();
$('#btn_ActivateCard').prop('disabled', true);
$('#btn_ReloadCard').prop('disabled', true);

// $("#btn_ActivateCard, #btn_ReloadCard").prop('disabled', true);
$("#txt_amount").val('');
$("#txt_cardnumber").val('');
if (requesttype == false) {
var Requesttype = false;
}
else {
var Requesttype = true;
}
$.ajax({
type: 'get',
url: '/Checkout?handler=ChangeCardRequest',
data: { "Requesttype": Requesttype, "Cardnumber": cardnumber},
contentType: 'application/json;charset=utf-8',
dataType: 'json',
success: function (data) {
$('#loader').hide();
$('#btn_ActivateCard').prop('disabled', true);
$('#btn_ReloadCard').prop('disabled', true);
if (data == true) {
window.location = '/ReloadGiftCard';
$("#btn_ReloadCard").hide();
$("#btn_ActivateCard").show();

}
else {
window.location = '/ReloadGiftCard';
$("#btn_ReloadCard").show();
$("#btn_ActivateCard").hide();
}
}
});

}

    function PlaceOrderDirect(token, postalCode, address, Payment, IsDineOrderType) {
        $('#loader').show();
        //$.ajax({
        //    type: 'get',
        //    url: '/Checkout?handler=CheckForUpsell',
        //    data: null,
        //    async: false,
        //    contentType: 'application/json;charset=utf-8',
        //    dataType: 'json',
        //    success: function (data) {
        //        //alert(data);
        //        if (data == 0 || data.html == 0) {
                    PaymentResponse = Payment;
                    var nm;
                    var email;

                    nm = ($("#name").html() == null || $.trim($("#name").html()) == "") ? $("#name").val() : $("#name").html();;
                    email = ($("#email").html() == null || $.trim($("#email").html()) == "") ? $("#email").val() : $("#email").html();
                    //var phno = $("#phoneNumber").html();
                    var spInstr = $("#spInstr").val();
                    var emailReg = /^([\w-\.]+@([\w-]+\.)+[\w-]{2,4})?$/;
        var phno = "";

        if (document.getElementById('phoneNumber').nodeName == "P") {
            phno = $("#phoneNumber").html();
        }
        else {
            if ($('#phoneNumber').val() != "") {
                phno = $('#country-code').val() + " " + $('#phoneNumber').val();
            }

        }
        $.get('/Index?handler=SkipPhn', null, function (data) {

            PhnNoSkipped = parseInt(data);


            if (($.trim(phno) == "" || phno == null) && PhnNoSkipped != 1) {
                if (document.getElementById('phoneNumber').nodeName == "INPUT") {
                    $('#loader').hide();
                    $('#ErrorMsgmodel').modal('show');
                    $('#modalimg').hide();
                    if (nm == "" && email == "") {
                        $('#lblMessage1').html('<h4>Missing required fields - mobile number, name and email</h4>');
                    }
                    else if (nm != "" && email == "") {
                        $('#lblMessage1').html('<h4>Missing required fields - mobile number and email</h4>');
                    }
                    else if (nm == "" && email != "") {
                        $('#lblMessage1').html('<h4>Missing required fields - mobile number and name</h4>');
                    }
                    else {
                        $('#lblMessage1').html('<h4>Missing required field - mobile number</h4>');
                    }
                }
                else {
                    $('#phonemodal').modal('show');
                    $('#loader').hide();
                }


                EnablePlaceOrder();
                return;
            }
                    else if (nm == "" || email == "" ) {
                        $('#loader').hide();
                $('#ErrorMsgmodel').modal('show');
                $('#ErrorMsgmodel #closeButton').show();
                        $('#modalimg').hide();
                        if (nm == "" && email != "" ) {
                            $('#lblMessage1').html('<h4>Missing required field - name</h4>');

                        }
                        else if (nm != "" && email == "" ) {
                            $('#lblMessage1').html('<h4>Missing required field - email</h4>');

                        }
                        else if (nm == "" && email == "" ) {
                            $('#lblMessage1').html('<h4>Missing required fields - name and email</h4>');

                        }
                        return;
                    }
                    else if (!emailReg.test(email)) {
                        $('#loader').hide();
                        $('#email').val("");
                        $('#pay-modal').modal('show');
                        $('#lblPayMessage').html('<h4>Email is invalid3</h4>');
            }
                    else if (!CheckCartSession()) {

                    }
                    else {
                        DisablePlaceOrder();
                        StopTime = true;

                        if (PaymentResponse == 1) {

                            $('#ErrorMsgmodel').modal('show');
                            $('#lblMessage1').html('<h4>Payment approved and now processing order to restaurant</h4>');
                            //var longWaitTimerId = setTimeout(function () {
                            //    // $('#ErrorMsgmodel').modal('hide');

                            //}, 5000);
                            if (phno == null || $.trim(phno) == "") { phno = '0' }
                            if (IsDineOrderType) {
                                $.ajax({
                                    type: 'get',
                                    url: '/Checkout?handler=PlaceOrderDinein',
                                    //url: '/Checkout?handler=PlaceOrder&payOrder=2&Name=' + nm + '&PhNo=' + phno + '&email=' + email + '&instr=' + spInstr,
                                    data: { "payOrder": 2, "Name": nm, "PhNo": phno, "email": email, "instr": spInstr },
                                    contentType: 'application/json;charset=utf-8',
                                    dataType: 'json',

                                    success: function (data) {
                                        if (data == "") {
                                            StopTime = false;
                                            $('#loader').hide();
                                            $('#div_closemodal').show();
                                            $('#modalimg').hide();
                                            $('#lblMessage1').html('<h4>Refund initiated.We are unable to place order, contact store directly to place order</h4>');
                                        }
                                        else if (data == "null") {
                                            StopTime = false;
                                            $('#div_closemodal').show();
                                            $('#modalimg').hide();
                                            $('#lblMessage1').html('<h4>Your cart is empty, please start over.</h4>');
                                        }
                                        else if (data == "Check Open") {
                                            StopTime = false;
                                            $('#loader').hide();
                                            $('#div_closemodal').show();
                                            $('#modalimg').hide();
                                            $('#lblMessage1').html('<h4>Check open on POS. Refund is initiated.</h4>');
                                        }
                                        else {
                                            $('#loader').show();
                                            $('#div_closemodal').hide();
                                            // $('#modalimg').attr('src', '/img/success.gif'); $('#lblMessage1').html('<h4>Done!</h4>');
                                            //setTimeout(function () {
                                            //$('#ErrorMsgmodel').modal('hide');
                                            console.log(data);
                                            document.location.assign(document.location.origin + data);

                                            //window.location.href = 'Confirmation';
                                            //$('#ErrorMsgmodel').modal('show'); $('#lblMessage1').html('<h4> It is taking time for getting store order confirmation , please wait for few minutes and do not refresh or click back </h4>');
                                            //}, 5000);

                                        }
                                    },
                                    error: function (jqXHR, textStatus, errorThrown) {
                                        StopTime = false;
                                        $('#ErrorMsgmodel').modal('hide');
                                        $('#loader').hide();
                                        if (jqXHR.status == 404 || errorThrown == 'Not Found') {
                                            $('#promo-modal').modal('show');
                                            $('#promo-modal #lblMessage').html('<h4>Oops something happened , please contact store directly</h4>');

                                            setTimeout(function () {
                                                $('#promo-modal').modal('hide');
                                                location.href = "/WelcomePage";
                                            }, 3000);
                                        }
                                    }

                                });
                            }
                            else {
                                try {
                                    $.ajax({
                                        type: 'get',
                                        url: '/Checkout?handler=PlaceOrder',
                                        //url: '/Checkout?handler=PlaceOrder&payOrder=2&Name=' + nm + '&PhNo=' + phno + '&email=' + email + '&instr=' + spInstr,
                                        data: { "payOrder": 2, "Name": nm, "PhNo": phno, "email": email, "instr": spInstr },
                                        contentType: 'application/json;charset=utf-8',
                                        dataType: 'json',

                                        success: function (data) {
                                            // window.clearTimeout(longWaitTimerId);

                                            //$('#promo-modal').modal('show');

                                            if (data == "") {
                                                StopTime = false;
                                                $('#loader').hide();
                                                $('#div_closemodal').show();
                                                $('#modalimg').hide();
                                                $('#lblMessage1').html('<h4>Refund is initiated.We are unable to place order, contact store directly to place order</h4>');
                                            }
                                            else if (data.split('-')[0] == "Order Fulfilled") {
                                                $('.modal').modal('hide');
                                                $('#BusyHour-modal').modal('show');
                                                $('#BusyHour-modal #msgprompt').html(data.split('-')[1]);
                                                if (data.split('-')[1].includes('retry')) {
                                                    $('#BusyHour-modal .slotsavailable').hide();
                                                    $('#BusyHour-modal .noslots').show();
                                                }
                                                else {
                                                    $('#BusyHour-modal .noslots').hide();
                                                    $('#BusyHour-modal .slotsavailable').show();
                                                }
                                                EnablePlaceOrder();
                                            }
                                            else if (data == "null") {
                                                StopTime = false;
                                                $('#div_closemodal').show();
                                                $('#modalimg').hide();
                                                $('#lblMessage1').html('<h4>Your cart is empty, please start over.</h4>');
                                            }
                                            else {
                                                $('#loader').show();
                                                // $('#modalimg').attr('src', '/img/success.gif'); $('#lblMessage1').html('<h4>Done!</h4>');
                                                //setTimeout(function () {
                                                //$('#ErrorMsgmodel').modal('hide');
                                                console.log(data);
                                                document.location.assign(document.location.origin + data);

                                                //window.location.href = 'Confirmation';
                                                //$('#ErrorMsgmodel').modal('show'); $('#lblMessage1').html('<h4> It is taking time for getting store order confirmation , please wait for few minutes and do not refresh or click back </h4>');
                                                //}, 5000);

                                            }
                                        },
                                        error: function (jqXHR, textStatus, errorThrown) {
                                            StopTime = false;
                                            $('#ErrorMsgmodel').modal('hide');
                                            $('#loader').hide();
                                            if (jqXHR.status == 404 || errorThrown == 'Not Found') {
                                                $('#promo-modal').modal('show');
                                                $('#promo-modal #lblMessage').html('<h4>Oops something happened , please contact store directly</h4>');

                                                setTimeout(function () {
                                                    $('#promo-modal').modal('hide');
                                                    location.href = "/WelcomePage";
                                                }, 3000);
                                            }
                                        }

                                    });
                                }
                                catch
                                {
                                    $('#ErrorMsgmodel').modal('hide');
                                    $('#pay-modal').modal('show'); $('#lblPayMessage').html('<h4>Something went wrong.</h4>');

                                }
                            }
                        }
                        else {
                            StopTime = false;
                            $('#loader').hide();
                            $('#ErrorMsgmodel').modal('hide');
                            $('#pay-modal').modal('show'); $('#lblPayMessage').html('<h4> Payment was failed.Contact store directly to place the order. </h4>');

                            setTimeout(function () {
                                $('#pay-modal').modal('hide');
                            }, 5000);

                        }


                        $('#loader').hide();
                        EnablePlaceOrder();

                    }
        //        }
        //        else {
        //            $('#loader').hide();
        //            $('#upsellbody').html('');
        //            $('#upsellname').html(data.name);
        //            $('#upsellbody').append(data.html);
        //            $('#Upsellmodal').modal('show');
        //        }
        //    }
        //});
        });
    }

//$('#btn_confirm').click(function () {
//    window.location.href = 'Confirmation';
//});

    function GetPayment(name, email) {

        var selectedToken;
        var appliedgiftcardcount;

        var PostalCode = $('#CardPostalCode').val();
        var addressLine = $('#CardaddressLine').val();
        selectedToken = $('.paymentSelected').val();
        var totaldue = $('.no_border #totalDue').html();

        if (selectedToken == undefined && !totaldue.includes("0.00") && !totaldue.includes("0.0")) {
            IsPaymentSelected = 0;
        }

        else {
            if (selectedToken == undefined || selectedToken == "Cash") {
                appliedgiftcardcount = $('.PaymentGcselected').length;

                if (appliedgiftcardcount == 1) {
                    selectedToken = $('.PaymentGcselected').val();

                }

            }
            if (selectedToken != null && selectedToken != '' && selectedToken != 'undefined' || appliedgiftcardcount > 1) {
                IsPaymentSelected = 1;

            }
            if ($('#PaymentLselected').length != 0) {
                IsPaymentSelected = 1;
                selectedToken = $('#PaymentLselected').val();
            }
        }

        if (!CheckCartSession()) {

        }
        else if (IsPaymentSelected == 1) {

            $('#loader').hide();
            $('#ErrorMsgmodel').modal({ backdrop: 'static', keyboard: false });
            $('#modalimg').show();
            $('#ErrorMsgmodel #closeButton').hide();
            $('#div_closemodal').hide();
            $('#lblMessage1').html('<h4> Processing Payment , Authorizing , please wait for few minutes and do not refresh or click back </h4>');


            return $.ajax({
                type: 'post',
                url: '/Checkout?handler=ProcessTransaction&token=' + selectedToken + "&location=" + $(".drop_location").text() + '&PostalCode=' + PostalCode + '&addressLine=' + addressLine + '&Name=' + name + '&Email=' + email,
                data: null,
                contentType: 'application/json;charset=utf-8',
                dataType: 'json',
                beforeSend: function (xhr) {
                    xhr.setRequestHeader('XSRF-TOKEN', $('input:hidden[name="__RequestVerificationToken"]').val());
                },
                success: function (data) {

                    if (data == "0") {
                        $('#ErrorMsgmodel').modal('hide');
                        //Payment Success and Address not verified
                        // $('#placeOrder').show();
                        // $('#lblPayMessage').html('<h4>Something wrong with your Postal Code and Address. Please correct and place your order.  </h4>');
                        PaymentResponse = 0;
                        return 0;
                    }
                    else if (data == "-1") {
                        //$('#ErrorMsgmodel').modal('hide');
                        //Payment Not Success
                        //  $('#lblPayMessage').html('<h4> Payment was failed </h4>');
                        $('#loader').hide();
                        PaymentResponse = -1;
                        return -1;
                    }
                    else if (data == "1") {
                        $('#loader').hide();

                        PaymentResponse = 1;
                        return 1;
                    }
                    else if (data == "2") {
                        $('#loader').hide();

                        PaymentResponse = 2;
                        return 2;
                        // $('#promo-modal').modal('show');
                        // $('#promo-modal #lblMessage').html('<h4>Your Card has insufficient balance <a href="ReloadGiftCard">Click here</a> to activate card</h4>');
                    }
                    else if (data == "Expired card") {
                        $('#loader').hide();
                        $('#ErrorMsgmodel').modal('hide');
                        $('#promo-modal').modal('show');
                        $('#promo-modal #lblMessage').html('<h4>Card Expired</h4>');
                        PaymentResponse = 11;
                        return 11;
                    }
                    else {
                        $('#ErrorMsgmodel').modal('hide');
                        //Something went wrong
                        // $('#lblPayMessage').html('<h4>Something Went Wrong . Please try Again </h4>');
                        $('#loader').hide();
                        PaymentResponse = -1;
                        return -1;
                    }
                },
                error: function (jqXHR, textStatus, errorThrown) {

                    $('#loader').hide();
                    if (jqXHR.status == 404 || errorThrown == 'Not Found') {
                        $('#promo-modal').modal('show');
                        $('#promo-modal #lblMessage').html('<h4>Oops something happened , please contact store directly</h4>');

                        setTimeout(function () {
                            $('#promo-modal').modal('hide');
                            location.href = "/WelcomePage";
                        }, 3000);
                    }
                }
            });
        }
        else if (IsPaymentSelected == 0) {
            //alert("not selected");
            $('#loader').hide();
            $('#pay-modal').modal('show');
            // $('#modalimg').show();
            $('#lblPayMessage').html('Please select a Payment Method First!');
            setTimeout(function () {
                $('#pay-modal').modal('hide');
            }, 3000);
            PaymentResponse = '99';
            return 99;
        }

    }
    function isPaymentSelected() {
        var selectedToken;
        var appliedgiftcardcount;
        var PostalCode = $('#CardPostalCode').val();
        var addressLine = $('#CardaddressLine').val();
        selectedToken = $('.paymentSelected').val();
        var totaldue = $('.no_border #totalDue').html();

        if (selectedToken == undefined && !totaldue.includes("0.00") && !totaldue.includes("0.0")) {
            IsPaymentSelected = 0;
        }

        else {
            if (selectedToken == undefined || selectedToken == "Cash") {
                appliedgiftcardcount = $('.PaymentGcselected').length;

                if (appliedgiftcardcount == 1) {
                    selectedToken = $('.PaymentGcselected').val();

                }

            }
            if (selectedToken != null && selectedToken != '' && selectedToken != 'undefined' || appliedgiftcardcount > 1) {
                IsPaymentSelected = 1;

            }
            if ($('#PaymentLselected').length != 0) {
                IsPaymentSelected = 1;
                selectedToken = $('#PaymentLselected').val();
            }
        }
        if (IsPaymentSelected == 0) {


            return false;
        }
        else {
            return true;
        }
    }
function guest() {
$('#loader').show();
$('#loginModal').modal('hide');
$('#loader').hide();
location.reload();
};

function guestcheckout() {
$('#loader').show();
//  $('#loginModal').modal('hide');
// $('#loader').hide();
window.location.href = '/Checkout';
};


    function startOver() {
        $('#loader').show();
        $.ajax({
            type: 'get',
            url: '/Index?handler=StartOver',
            data: null,
            contentType: 'application/json;charset=utf-8',
            dataType: 'json',
            success: function (data) {
                $('#loader').hide();

                var html = '<tr class="total_price" style="display:none"><td colspan="3"><a href="javascript:Checkout()">Checkout <span class="pull-right cart_total" id="cartTotalDue"></span></a></td> </tr>  <tr class="total_price">                        <td colspan="3">  <a href="javascript:void()" data-toggle="modal" data-target="#paypal-modal">  Start Over! </a></td>                    </tr>                    <tr id="noItems">                        <td colspan="3"><i>No Items in Cart</i></td>                    </tr>';

                $('#tblCart').html(html);
                $('.total_price').hide();
                $('.qty').text('');

                if (data == "1") {
                    window.location = '/Index';
                }

            },
            error: function (jqXHR, textStatus, errorThrown) {
                $('#loader').hide();
                if (jqXHR.status == 404 || errorThrown == 'Not Found') {

                    $('#promo-modal').modal('show');
                    $('#promo-modal #lblMessage').html('<h4>Oops something happened , please try again!</h4>');

                    setTimeout(function () {
                        $('#promo-modal').modal('hide');
                        location.href = "/WelcomePage";
                    }, 3000);
                }
            }
        });


    }

//$('#extrasForm').submit(function (event) {
//    ;
//    alert("form submission");


$("#btn_resendOTP").click(function () {
//$("#phone").attr("disabled", "disabled");
//$("#phone_close").attr("disabled", "disabled");
//$("#btn_phonecancel").attr("disabled", "disabled");
//$("#btn_resendOTP").hide();
getOTP();
});

timerOn = true;
//});
$('#btn_sendOTP').click(function () {
getOTP();
});
var sessionOTP = "";

function getOTP() {
$('#loader').show();
if ($('#phone').val() != '') {
var value = $('#phone').val();
var NumberRegex = /^[0-9]*$/;
if (value.length == 10) {
if (!NumberRegex.test(value)) {
$('#loader').hide();

$('#pay-modal').modal('show');
$('#lblPayMessage').html('<h4>Please enter a valid phone number. </h4>');
}
else {
$('#loader').hide();
$("#phone").attr("disabled", "disabled");
// $("#phone_close").attr("disabled", "disabled");
//$("#btn_phonecancel").attr("disabled", "disabled");
$('#rw_VerifyOTP').show();
$('#btn_sendOTP').text('Send OTP');
//$("#btn_resendOTP").hide();
timerOn = true;
timer(60);
// var ph = $('#country-code').val() + " " + $('#phone').val();
var ph = $('#phone').val();
$.ajax({
type: 'get',
url: '/Index?handler=SendOTP&PhNo=' + ph,
data: null,
contentType: 'application/json;charset=utf-8',
dataType: 'json',

success: function (data) {
if (data.length == 6) {
//alert(data);
sessionOTP = data;
$('#btn_verifyOTP').show();
$('#btn_sendOTP').hide();
}
else {
timerOn = false;
StopTimer();
$('#promo-modal').modal('show');
$('#promo-modal #lblMessage').html('<h4>' + data + '</h4>');

}
},
error: function (jqXHR, textStatus, errorThrown) {

$('#promo-modal').modal('show');
$('#promo-modal #lblMessage').html('<h4>Oops something happened , please contact store directly</h4>');

setTimeout(function () {
$('#promo-modal').modal('hide');
location.href = "/WelcomePage";
}, 3000);

}
});
}
} else {
$('#loader').hide();
$('#pay-modal').modal('show');
$('#lblPayMessage').html('<h4>Please enter a valid phone number. </h4>');
}

} else {
$('#phoneNumber').html('');
$('#phonemodal').modal('hide');
$('#loader').hide();
location.reload();
}
}
$(document).on('click', '#phone_close ,#btn_phonecancel', function () {
$('#phone').val('');
$('#changeNo').prop('disabled', true);

timerOn = false;
StopTimer();

});



function timer(remaining) {
var m = Math.floor(remaining / 60);
var s = remaining % 60;

m = m < 10 ? '0' + m : m;
s = s < 10 ? '0' + s : s;
document.getElementById('timer').innerHTML = m + ':' + s;
remaining -= 1;

if (remaining >= 0 && timerOn) {
setTimeout(function () {
timer(remaining);
}, 1000);
return;
}

if (!timerOn) {
// Do validate stuff here
return;
}
// Do timeout stuff here

$('#promo-modal').modal('show');
$('#promo-modal #lblMessage').html('<h4>Timeout for otp</h4>');
$("#phone").removeAttr("disabled");
$("#phone_close").removeAttr("disabled");
$("#btn_phonecancel").removeAttr("disabled");
$('#btn_sendOTP').text('Resend OTP');
$('#btn_verifyOTP').hide();
$('#rw_VerifyOTP').hide();

$('#btn_sendOTP').show();
sessionOTP = "";

}
function StopTimer() {
var remaining = 0;
var m = Math.floor(remaining / 60);
var s = remaining % 60;

m = m < 10 ? '0' + m : m;
s = s < 10 ? '0' + s : s;
document.getElementById('timer').innerHTML = m + ':' + s;
remaining -= 1;


// Do timeout stuff here

$("#phone").removeAttr("disabled");
$("#phone_close").removeAttr("disabled");
$("#btn_phonecancel").removeAttr("disabled");

$('#btn_verifyOTP').hide();
$('#rw_VerifyOTP').hide();

$('#btn_sendOTP').show();
sessionOTP = "";

}

    //function AddToCartLimited(itemId, itemname, price, ltdQty) {
    //    var submodifiercheckflag = true;
    //    $('#loader').show();
    //    $('#btn-' + itemId).addClass('processing-cart button.btn.btn-primary.add_to_cart');

    //    var qty = $('#qty_' + itemId).val();
    //    if (qty == 0) {
    //        return false;
    //    }
    //    //var instr = $('#instr_' + itemId).val();
    //    var instr = $('[id^="instr_' + itemId + '"]').val();
    //    if (instr == 'undefined') instr = '';
    //    if (qty > ltdQty) {
    //        $('#promo-modal').modal('show');
    //        $('#promo-modal #lblMessage').html('Only ' + ltdQty + ' available . Cannot add more than that!');
    //        $('#loader').hide();
    //        return false;
    //    }
    //    var ModifigrpId = $('.ModifiyGrpId-' + itemId).map(function () {
    //        return this.value;
    //    }).get();

    //    if (ModifigrpId.length > 0) {
    //        $('#product_modal-' + itemId + ' .ModifierParent').each(function (index) {

    //            //var obj = $(this).parent();
    //            var CheckRequired = $(this).parent().children(".CheckType").val();
    //            var ModifiGrpName = $(this).parent().children(".ModifierParent").val();
    //            if (ModifigrpId.includes(ModifiGrpName)) {
    //                if (CheckRequired == "Requird") {
    //                    var minval = $(this).parent().children(".ModifierMinQty").val();
    //                    var numberOfChecked = $('.CheckbocCheckVal-' + itemId + '-' + ModifiGrpName + ':checkbox:checked').length;
    //                    if (parseInt(numberOfChecked) < parseInt(minval)) {
    //                        $('#promo-modal').modal('show');
    //                        $('#promo-modal #lblMessage').html('Please select atleast ' + minval + '  ' + ModifiGrpName);
    //                        $('#loader').hide();
    //                        submodifiercheckflag = false;
    //                        return false;
    //                    }
    //                }
    //            }
    //        });
    //        //for (var i = 0; i < ModifigrpId.length; i++) {
    //        //    //var count = SubModifierCnt[i];
    //        //    var CheckRequired = $(".ConditioncheckStatus-" + itemId + '-' + ModifigrpId[i]).val();

    //        //    var ModifiGrpName = $(".ModifiyGrpName-" + ModifigrpId[i]).val();
    //        //    var issubmodifier = $(".ConditioncheckStatus-" + itemId + '-' + ModifigrpId[i]).hasClass('Checkbox_Submodifier');
    //        //    if (!issubmodifier) {
    //        //        if (CheckRequired == "Requird") {
    //        //            var minval = $(".minOrderval-" + itemId + '-' + ModifigrpId[i]).val();
    //        //            var numberOfChecked = $('.CheckbocCheckVal-' + itemId + '-' + ModifigrpId[i] + ':checkbox:checked').length;
    //        //            if (parseInt(numberOfChecked) < parseInt(minval)) {
    //        //                $('#promo-modal').modal('show');
    //        //                $('#promo-modal #lblMessage').html('Please select atleast ' + minval + '  ' + ModifiGrpName);
    //        //                $('#loader').hide();
    //        //                return false;
    //        //            }
    //        //        }


    //        //    }

    //        //}
    //        if (submodifiercheckflag) {
    //            $(".Checkrequired").each(function (index) {

    //                //var obj = $(this).parent();
    //                var CheckRequired = $(this).parent().children(".Checkrequired").val();
    //                var ModifiGrpName = $(this).parent().children(".GroupName").val();
    //                if ($(this).parent().parent().parent().parent().children('.form-check-label').children('input').prop('checked')) {
    //                    if (CheckRequired == "Requird") {
    //                        var submodifierid = $(this).parent().children(".Checkrequired").attr('submodifierId');
    //                        //alert(submodifierid);
    //                        var minval = $(this).parent().children(".minQty").val();
    //                        var numberOfChecked = $('.CheckbocCheckVal-' + submodifierid + '-' + ModifiGrpName + ':checkbox:checked').length;
    //                        if (parseInt(numberOfChecked) < parseInt(minval)) {
    //                            $('#promo-modal').modal('show');
    //                            $('#promo-modal #lblMessage').html('Please select atleast ' + minval + '  ' + ModifiGrpName);
    //                            $('#loader').hide();
    //                            submodifiercheckflag = false;
    //                            return false;
    //                        }
    //                    }
    //                }
    //            });
    //        }
    //    }
    //    else {
    //        var minval = $(".minOrderval1-" + itemId).val();
    //        var numberOfChecked = $('.' + itemId + ':checked').length;
    //        // alert(numberOfChecked);
    //        if (parseInt(numberOfChecked) < parseInt(minval)) {
    //            $('#promo-modal').modal('show');
    //            $('#promo-modal #lblMessage').html('Please select atleast ' + minval);
    //            $('#loader').hide();
    //            return false;
    //        }
    //    }
    //    if (submodifiercheckflag) {
    //       // price = $(".ChangePrice-" + itemId).html().split(currency)[1];
    //        //price = $("#PriceTotalValue-" + itemId).val();
    //        var itemTotalprice = $('.ChangePrice-' + itemId).html();
    //        var checkedVals = $('.' + itemId + ':checkbox:checked').map(function () {
    //            return this.value;
    //        }).get();
    //        checkedVals.join("•");
    //        var checkedbutton = $('.' + itemId + ':radio:checked').map(function () {
    //            return this.value;
    //        }).get();
    //        checkedbutton.join("•");


    //        var checkedNames = $('.' + itemId + ':checkbox:checked').map(function () {
    //            return '{"Id":"' + this.id + '", "_modName": "' + this.value + '","price":"' + this.attributes[2].value + '"}';
    //        }).get();

    //        checkedNames.join(",");

    //        var checkedNamebutton = $('.' + itemId + ':radio:checked').map(function () {
    //            return '{"id":"' + this.id + '", "_modName": "' + this.value + '","price":"' + this.attributes[5].value + '"}';
    //        }).get();

    //        checkedNamebutton.join(",");
    //        var Extras = '[' + checkedNamebutton + ', ' + checkedNames + ']';

    //        $.ajax({
    //            type: 'get',
    //            url: '/Index?handler=AddToCartLtd',
    //            data: { "itemId": itemId, "qty": qty, "price": price, "Name": itemname, "Extras": Extras, "Instr": instr, "ltdQty": ltdQty },
    //            //url: '/Index?handler=AddToCartLtd&itemId=' + itemId + '&qty=' + qty + '&price=' + price + '&Name=' + itemname + '&Extras=['
    //            //   + checkedNamebutton + ',' + checkedNames + ']&Instr=' + instr + ' &ltdQty=' + ltdQty,
    //            //data: null,
    //            contentType: 'application/json;charset=utf-8',
    //            dataType: 'json',

    //            success: function (data) {

    //                $('#loader').hide();
    //                var result = JSON.parse(data);
    //                if (JSON.parse(data).responseMessage == "" || JSON.parse(data).responseMessage == null) {
    //                    $('#loader').hide();
    //                    if (result.ordertype == "Dinein") {
    //                        var _issent = false;
    //                        var flag = false;
    //                        $('.guestname').remove();
    //                        $('.cart_items').remove();
    //                        $('.btn_checkout').hide();
    //                        if (result._cart.SplitCheck.GuestCount > 0) {
    //                            var html = '';
    //                            for (var i = 0; i < result._cart.SplitCheck.Guestusers.length; i++) {
    //                                if (result._cart.SplitCheck.Guestusers[i].Name != null) {

    //                                    if (result._cart.SplitCheck.Guestusers[i].gitemtotal != null && result._cart.SplitCheck.Guestusers[i].gitemtotal.subTotal != '0') {
    //                                        if (result._cart.SplitCheck.Guestusers[i].isactive == true) {
    //                                            html += "<tr style='background-color: aliceblue' class='guestname Guestuser guestactive' id='" + result._cart.SplitCheck.Guestusers[i].guestid + "'><td colspan='3'><h5>" + result._cart.SplitCheck.Guestusers[i].Name + "<span class='pull-right cart_total' id='bound_" + result._cart.SplitCheck.Guestusers[i].guestid + "'>$" + parseFloat(result._cart.SplitCheck.Guestusers[i].gitemtotal.subTotal).toFixed(2) + "</span></h5></td></tr>";
    //                                        }
    //                                        else {
    //                                            html += "<tr style='background-color: aliceblue' class='guestname Guestuser' id='" + result._cart.SplitCheck.Guestusers[i].guestid + "'><td colspan='3'><h5>" + result._cart.SplitCheck.Guestusers[i].Name + "<span class='pull-right cart_total' id='bound_" + result._cart.SplitCheck.Guestusers[i].guestid + "'>$" + parseFloat(result._cart.SplitCheck.Guestusers[i].gitemtotal.subTotal).toFixed(2) + "</span></h5></td></tr>";
    //                                        }
    //                                    }
    //                                    else {
    //                                        if (result._cart.SplitCheck.Guestusers[i].isactive == true) {
    //                                            html += "<tr style='background-color: aliceblue' class='guestname Guestuser guestactive' id='" + result._cart.SplitCheck.Guestusers[i].guestid + "'><td colspan='3'><h5>" + result._cart.SplitCheck.Guestusers[i].Name + "<span class='pull-right cart_total' id='bound_" + result._cart.SplitCheck.Guestusers[i].guestid + "'></span></h5></td></tr>";
    //                                        }
    //                                        else {
    //                                            html += "<tr style='background-color: aliceblue' class='guestname Guestuser' id='" + result._cart.SplitCheck.Guestusers[i].guestid + "'><td colspan='3'><h5>" + result._cart.SplitCheck.Guestusers[i].Name + "<span class='pull-right cart_total' id='bound_" + result._cart.SplitCheck.Guestusers[i].guestid + "'></span></h5></td></tr>";
    //                                        }
    //                                    }
    //                                    //html += "<tr style='background-color: aliceblue' class='guestname'><td colspan='3'><h5>" + result._cart.SplitCheck.Guestusers[i].Name + "<span class='pull-right cart_total' id='bound_" + result._cart.SplitCheck.Guestusers[i].guestid + "'>" + result._cart.SplitCheck.Guestusers[i].gitemtotal.subTotal + " (excluded all tax)</span></h5></td></tr>";
    //                                }
    //                                else {
    //                                    if (result._cart.SplitCheck.Guestusers[i].gitemtotal != null && result._cart.SplitCheck.Guestusers[i].gitemtotal.subTotal != '0') {
    //                                        if (result._cart.SplitCheck.Guestusers[i].isactive == true) {
    //                                            html += "<tr style='background-color: aliceblue' class='guestname Guestuser guestactive' id='" + result._cart.SplitCheck.Guestusers[i].guestid + "'><td colspan='3'><h5>Guest" + parseInt(i + 1) + "<span class='pull-right cart_total' id='bound_" + result._cart.SplitCheck.Guestusers[i].guestid + "'>$" + parseFloat(result._cart.SplitCheck.Guestusers[i].gitemtotal.subTotal).toFixed(2) + "</span></h5></td></tr>";
    //                                        }
    //                                        else {
    //                                            html += "<tr style='background-color: aliceblue' class='guestname Guestuser' id='" + result._cart.SplitCheck.Guestusers[i].guestid + "'><td colspan='3'><h5>Guest" + parseInt(i + 1) + "<span class='pull-right cart_total' id='bound_" + result._cart.SplitCheck.Guestusers[i].guestid + "'>$" + parseFloat(result._cart.SplitCheck.Guestusers[i].gitemtotal.subTotal).toFixed(2) + "</span></h5></td></tr>";
    //                                        }
    //                                    }
    //                                    else {
    //                                        if (result._cart.SplitCheck.Guestusers[i].isactive == true) {
    //                                            html += "<tr style='background-color: aliceblue' class='guestname Guestuser guestactive' id='" + result._cart.SplitCheck.Guestusers[i].guestid + "'><td colspan='3'><h5>Guest" + parseInt(i + 1) + "<span class='pull-right cart_total' id='bound_" + result._cart.SplitCheck.Guestusers[i].guestid + "'></span></h5></td></tr>";
    //                                        }
    //                                        else {
    //                                            html += "<tr style='background-color: aliceblue' class='guestname Guestuser' id='" + result._cart.SplitCheck.Guestusers[i].guestid + "'><td colspan='3'><h5>Guest" + parseInt(i + 1) + "<span class='pull-right cart_total' id='bound_" + result._cart.SplitCheck.Guestusers[i].guestid + "'></span></h5></td></tr>";
    //                                        }
    //                                    }
    //                                }

    //                                if (result._cart.SplitCheck.Guestusers[i].guestcartItems.length > 0) {

    //                                    for (var j = 0; j < result._cart.SplitCheck.Guestusers[i].guestcartItems.length; j++) {
    //                                        if (result._cart.SplitCheck.Guestusers[i].guestcartItems[j].isSent == false) {
    //                                            flag = true;
    //                                            html += "<tr class='cart_items' id='row_" + result._cart.SplitCheck.Guestusers[i].guestcartItems[j].cartItemId + "' boundguest='bound_" + result._cart.SplitCheck.Guestusers[i].guestid + "'><td class='cart_qty'>" + result._cart.SplitCheck.Guestusers[i].guestcartItems[j].qty + " ×</td><td class='cart_name'><span class='cart_title'>" + result._cart.SplitCheck.Guestusers[i].guestcartItems[j].itemName + "</span>";
    //                                        }
    //                                        else {
    //                                            _issent = true;
    //                                            html += "<tr class='cart_items oldrow' id='row_" + result._cart.SplitCheck.Guestusers[i].guestcartItems[j].cartItemId + "'><td class='cart_qty'>" + result._cart.SplitCheck.Guestusers[i].guestcartItems[j].qty + " ×</td><td class='cart_name'><span class='cart_title'>" + result._cart.SplitCheck.Guestusers[i].guestcartItems[j].itemName + "</span>";
    //                                        }
    //                                        if (result._cart.SplitCheck.Guestusers[i].guestcartItems[j].modifiers != null && result._cart.SplitCheck.Guestusers[i].guestcartItems[j].modifiers.length > 0) {
    //                                            html += "<br><span class='cart_info'>";
    //                                            for (var k = 0; k < result._cart.SplitCheck.Guestusers[i].guestcartItems[j].modifiers.length; k++) {
    //                                                html += "<label> •" + result._cart.SplitCheck.Guestusers[i].guestcartItems[j].modifiers[k]._modName + "</label >";
    //                                            }
    //                                            if (result._cart.SplitCheck.Guestusers[i].guestcartItems[j].specialInst != "" && result._cart.SplitCheck.Guestusers[i].guestcartItems[j].specialInst != null) {
    //                                                html += "<br /><label><i> •" + result._cart.SplitCheck.Guestusers[i].guestcartItems[j].specialInst + "</i></label>";
    //                                            }
    //                                            html += "</span>";
    //                                        }
    //                                        if (result._cart.SplitCheck.Guestusers[i].guestcartItems[j].isSent == false) {
    //                                            html += "<br /> <a id='" + result._cart.SplitCheck.Guestusers[i].guestcartItems[j].cartItemId + "' href='javascript:Remove(\"" + result._cart.SplitCheck.Guestusers[i].guestcartItems[j].cartItemId + "\")' class='remove_item'>Remove</a>";
    //                                        }
    //                                        if (result._cart.SplitCheck.Guestusers[i].guestcartItems[j].modifiers == null || result._cart.SplitCheck.Guestusers[i].guestcartItems[j].modifiers.length == 0) {
    //                                            html += " </td > <td class='cart_price'>$" + (result._cart.SplitCheck.Guestusers[i].guestcartItems[j].itemPrice * result._cart.SplitCheck.Guestusers[i].guestcartItems[j].qty).toFixed(2) + "</td></tr> ";
    //                                        }
    //                                        else {
    //                                            html += " </td > <td class='cart_price'>$" + parseFloat((result._cart.SplitCheck.Guestusers[i].guestcartItems[j].itemPrice * result._cart.SplitCheck.Guestusers[i].guestcartItems[j].qty) + (result._cart.SplitCheck.Guestusers[i].guestcartItems[j].modifiers[0].price * result._cart.SplitCheck.Guestusers[i].guestcartItems[j].qty)).toFixed(2) + "</td></tr> ";
    //                                        }
    //                                        //html += " </td > <td class='cart_price'>$" + (result._cart.SplitCheck.Guestusers[i].guestcartItems[j].itemPrice * result._cart.SplitCheck.Guestusers[i].guestcartItems[j].qty).toFixed(2) + "</td></tr> ";
    //                                    }
    //                                }

    //                            }

    //                            // html += "<tr class='cart_items' id='row_" + result._cartItemId + "'><td class='cart_qty'>" + qty + " ×</td><td class='cart_name'><span class='cart_title'>" + itemname + "</span>";
    //                        }
    //                        if (_issent == true && flag == true) {

    //                            $('#tblCart #tr_startover').css('display', 'none');

    //                        }
    //                        else if (_issent == false && flag == true) {

    //                            $('#tblCart #tr_startover').show();
    //                        }
    //                        else {

    //                            $('#tblCart #tr_startover').css('display', 'none');
    //                        }
    //                        $('#orderSend').show();
    //                        $('#orderSend2').show();
    //                        $('#checkouthide').hide();
    //                        $('#orderSend2Dummy').hide();
    //                        $('#orderSendDummy').hide();
    //                        $('#orderSend2 a #guestcarttotal').html(currency + JSON.parse(data)._cart.total.subTotal.toFixed(2));
    //                        $('#orderSend a #cartTotalDue').html(currency + JSON.parse(data)._cart.total.subTotal.toFixed(2));
    //                        $('#guestcarttotal').html(currency + JSON.parse(data)._cart.total.subTotal.toFixed(2));
    //                    }
    //                    else {
    //                        //location.reload();
    //                        var html = "<tr class='cart_items' id='row_" + JSON.parse(data)._cartItemId + "'><td class='cart_qty'>" + qty + " ×</td><td class='cart_name'><span class='cart_title'>" + itemname + "</span>";
    //                        //if (checkedNamebutton != '' || checkedNames != '') {
    //                        //    html = html + "<br><span class='cart_info'><label>" + checkedVals + "•" + checkedbutton + "</label>";
    //                        //    if (instr != "" && instr != 'undefined')
    //                        //        html = html + "<br /><label><i> •" + instr + "</label></i>";

    //                        //    html = html + "</span>";
    //                        //}
    //                        if (checkedNamebutton != '' || checkedNames != '') {

    //                            if (checkedVals == "" && checkedbutton != "") {
    //                                html = html + "<br /><span class='cart_info'><label>•" + checkedbutton + "</label>";
    //                            }
    //                            else if (checkedVals != "" && checkedbutton == "") {
    //                                html = html + "<br /><span class='cart_info'><label>•" + checkedVals + "</label>";
    //                            }
    //                            else {
    //                                html = html + "<br /><span class='cart_info'><label>•" + checkedVals + "•" + checkedbutton + "</label>";
    //                            }
    //                            if (instr != "" && instr != 'undefined' && instr != undefined)
    //                                html = html + "<br /><label><i> •" + instr + "</label></i>";

    //                            html = html + "</span>";
    //                        }

    //                        else if (instr != "" && instr != 'undefined' && instr != undefined)
    //                            html = html + "<br /><span class='cart_info'><label><i> •" + instr + "</i></label></span>";

    //                        html = html + "<br> <a id='" + JSON.parse(data)._cartItemId + "' href='javascript:Remove(\"" + JSON.parse(data)._cartItemId + "\")' class='remove_item'>Remove</a> </td > ";
    //                        html = html + "<td class='cart_price'>" + itemTotalprice + "</td></tr>";
    //                        $('#orderSend').show();
    //                        $('#orderSend2').show();

    //                        $('#orderSend2 a #orderSend').html(currency + JSON.parse(data)._cart.total.subTotal.toFixed(2));
    //                        $('.total_price #cartTotalDue').html(currency + JSON.parse(data)._cart.total.subTotal.toFixed(2));
    //                        $('#orderSend a #cartTotalDue').html(currency + JSON.parse(data)._cart.total.subTotal.toFixed(2));
    //                        $('#orderSend2Dummy').hide();
    //                        $('#orderSendDummy').hide();

    //                    }
    //                    //$('#tblCart').append(html);


    //                    //$('#product_modal-' + itemId).modal('hide');
    //                    //$('#qty_' + itemId).val('1');
    //                    //$('#instr_' + itemId).val('');

    //                    //$('#cartTotalDue').html(currency + JSON.parse(data)._cart.total.subTotal.toFixed(2));

    //                    //$('.total_price').show();

    //                    //$('#noItems').hide();

    //                    //$('.qty').text(JSON.parse(data).qty);
    //                    //$('#orderSend').show();
    //                    //$('#orderSend2').show();
    //                    //$('#orderSend2Dummy').hide();
    //                    //$('#orderSendDummy').hide();
    //                    $('#tblCart').append(html);
    //                    if (JSON.parse(data)._cart.minValue < JSON.parse(data)._cart.total.subTotal.toFixed(2)) {

    //                        $('.total_price>td #minVal').attr('href', 'javascript:Checkout()');
    //                        $('.total_price>td #minVal').html('Checkout <span class="pull-right cart_total" id="cartTotalDue">$' + JSON.parse(data)._cart.total.totalDue.toFixed(2) + '</span>');
    //                        $('#cartTotalDue').html(currency + JSON.parse(data)._cart.total.subTotal.toFixed(2));

    //                    }
    //                    else if (JSON.parse(data)._cart.minValue > JSON.parse(data)._cart.total.subTotal.toFixed(2)) {

    //                        if ($('#minVal').length > 0) {
    //                            $('.total_price>td #minVal').attr('href', '#');
    //                            $('.total_price>td #minVal').html('Minimum Order: <span class="pull-right cart_total" id="cartTotalDue">$' + JSON.parse(data)._cart.minValue.toFixed(2) + '</span>');
    //                        }
    //                        else {
    //                            $('a[href="javascript:Checkout()"]').attr('href', '#');
    //                            $('a[href="javascript:Checkout()"]').html('Minimum Order: <span class="pull-right cart_total" id="cartTotalDue">$' + JSON.parse(data)._cart.minValue.toFixed(2) + '</span>');
    //                        }
    //                        $('#cartTotalDue').html("$" + JSON.parse(data)._cart.minValue.toFixed(2));
    //                    }
    //                    if ($("#tblCart #checkouthide").is(":visible")) {
    //                        $('#tblCart tr#checkouthide').css('display', 'none');
    //                    }
    //                    $('#checkouthide').css('display', 'none');

    //                    $('#product_modal-' + itemId).modal('hide');
    //                    $('#qty_' + itemId).val('1');
    //                    $('#instr_' + itemId).val('');

    //                    $('#cartTotalDue').html(currency + JSON.parse(data)._cart.total.subTotal.toFixed(2));

    //                    $('.total_price').show();

    //                    $('#noItems').hide();

    //                    $('.qty').text(JSON.parse(data).qty);
    //                    $('.Guestuser .cart_total').html(currency + JSON.parse(data)._cart.total.subTotal.toFixed(2));

    //                }
    //                else {
    //                    $('#promo-modal').modal('show');
    //                    $('#promo-modal #lblMessage').html(JSON.parse(data).responseMessage);
    //                    $('#loader').hide();
    //                    return false;
    //                }
    //            },
    //            error: function (jqXHR, textStatus, errorThrown) {
    //                $('#loader').hide();
    //                if (jqXHR.status == 404 || errorThrown == 'Not Found') {
    //                    $('#promo-modal').modal('show');
    //                    $('#promo-modal #lblMessage').html('<h4>Oops something happened , please contact store directly</h4>');

    //                    setTimeout(function () {
    //                        $('#promo-modal').modal('hide');
    //                        location.href = "/WelcomePage";
    //                    }, 3000);
    //                }
    //            }
    //        });

    //    }

    //}

    //function AddToCart(itemId, itemname, price) {
    //    var submodifiercheckflag = true;
    //    $('#loader').show();
    //    $('#btn-' + itemId).addClass('processing-cart button.btn.btn-primary.add_to_cart');
    //    var qty = $('#qty_' + itemId).val();
    //    if (qty == 0) {
    //        return false;
    //    }

    //    var instr = $('[id^="instr_' + itemId + '"]').val();
    //    if (instr == 'undefined') instr = '';
    //    // var instr = $('#instr_' + itemId).val();
    //    var itemTotalprice = $('.ChangePrice-' + itemId).html();
    //    var CheckRequired = $(".ConditioncheckStatus1-" + itemId).val();
    //    var CheckRequired1 = $(".ConditioncheckStatus1-" + itemId).map(function () {
    //        return this.value;
    //    }).get();

    //    var ModifigrpId = $('.ModifiyGrpId-' + itemId).map(function () {
    //        return this.value;
    //    }).get();

    //    if (ModifigrpId.length > 0) {

    //        //for (var i = 0; i < ModifigrpId.length; i++) {
    //        //
    //        //    var CheckRequired = $(".ConditioncheckStatus-" + itemId + '-' + ModifigrpId[i]).val();
    //        //    var ModifiGrpName = $(".ModifiyGrpName-" + ModifigrpId[i]).val();
    //        //    var issubmodifier = $(".ConditioncheckStatus-" + itemId + '-' + ModifigrpId[i]).hasClass('Checkbox_Submodifier');
    //        //    if (!issubmodifier) {
    //        //        if (CheckRequired == "Requird") {
    //        //            var minval = $(".minOrderval-" + itemId + '-' + ModifigrpId[i]).val();
    //        //            var numberOfChecked = $('.CheckbocCheckVal-' + itemId + '-' + ModifigrpId[i] + ':checkbox:checked').length;
    //        //            if (parseInt(numberOfChecked) < parseInt(minval)) {
    //        //                $('#promo-modal').modal('show');
    //        //                $('#promo-modal #lblMessage').html('Please select atleast ' + minval + '  ' + ModifiGrpName);
    //        //                $('#loader').hide();
    //        //                return false;
    //        //            }
    //        //        }


    //        //    }

    //        //}
    //        $('#product_modal-' + itemId+' .ModifierParent').each(function (index) {

    //            //var obj = $(this).parent();
    //            var CheckRequired = $(this).parent().children(".CheckType").val();
    //            var ModifiGrpName = $(this).parent().children(".ModifierParent").val();
    //            if (ModifigrpId.includes(ModifiGrpName)) {
    //                if (CheckRequired == "Requird") {
    //                    var minval = $(this).parent().children(".ModifierMinQty").val();
    //                    var numberOfChecked = $('.CheckbocCheckVal-' + itemId + '-' + ModifiGrpName + ':checkbox:checked').length;
    //                    if (parseInt(numberOfChecked) < parseInt(minval)) {
    //                        $('#promo-modal').modal('show');
    //                        $('#promo-modal #lblMessage').html('Please select atleast ' + minval + '  ' + ModifiGrpName);
    //                        $('#loader').hide();
    //                        submodifiercheckflag = false;
    //                        return false;
    //                    }
    //                }
    //            }
    //        });
    //        if (submodifiercheckflag) {
    //            $(".Checkrequired").each(function (index) {

    //                //var obj = $(this).parent();
    //                var CheckRequired = $(this).parent().children(".Checkrequired").val();
    //                var ModifiGrpName = $(this).parent().children(".GroupName").val();
    //                if ($(this).parent().parent().parent().parent().children('.form-check-label').children('input').prop('checked')) {
    //                    if (CheckRequired == "Requird") {
    //                        var submodifierid = $(this).parent().children(".Checkrequired").attr('submodifierId');
    //                        //alert(submodifierid);
    //                        var minval = $(this).parent().children(".minQty").val();
    //                        var numberOfChecked = $('.CheckbocCheckVal-' + submodifierid + '-' + ModifiGrpName + ':checkbox:checked').length;
    //                        if (parseInt(numberOfChecked) < parseInt(minval)) {
    //                            $('#promo-modal').modal('show');
    //                            $('#promo-modal #lblMessage').html('Please select atleast ' + minval + '  ' + ModifiGrpName);
    //                            $('#loader').hide();
    //                            submodifiercheckflag = false;
    //                            return false;
    //                        }
    //                    }
    //                }
    //            });
    //        }

    //    }
    //    else {
    //        var minval = $(".minOrderval1-" + itemId).val();
    //        var numberOfChecked = $('.' + itemId + ':checked').length;
    //        // alert(numberOfChecked);
    //        if (parseInt(numberOfChecked) < parseInt(minval)) {
    //            $('#promo-modal').modal('show');
    //            $('#promo-modal #lblMessage').html('Please select atleast ' + minval);
    //            $('#loader').hide();
    //            return false;
    //        }
    //    }
    //    if (submodifiercheckflag) {
    //        var ItemPrice = price;
    //        price = $("#PriceTotalValue-" + itemId).val();
    //        // price = $("#PriceTotalValue-" + itemId).val();

    //        var checkedVals = $('.' + itemId + ':checkbox:checked').map(function () {
    //            return this.value;
    //        }).get();
    //        checkedVals.join("•");
    //        var checkedbutton = $('.' + itemId + ':radio:checked').map(function () {
    //            return this.value;
    //        }).get();
    //        checkedbutton.join("•");


    //        var checkedNames = $('.' + itemId + ':checkbox:checked').map(function () {
    //            var ModId = '#' + itemId + '-' + this.id;

    //            return '{"Id":"' + this.id + '", "_modName": "' + this.value + '","price":"' + this.attributes[2].value + '"}';
    //            //return '{"Id":"' + this.id + '", "_modName": "' + this.value + '","price":"' + GetModifierPrice(itemId)  +'"}';
    //        }).get();

    //        checkedNames.join(",");

    //        var checkedNamebutton = $('.' + itemId + ':radio:checked').map(function () {
    //            var ModId = '#' + itemId + '-' + this.id;

    //            return '{"Id":"' + this.id + '", "_modName": "' + this.value + '","price":"' + this.attributes[5].value + '"}';
    //            //return '{"id":"' + this.id + '", "_modName": "' + this.value + '","price":"' + GetModifierPrice(itemId) + '"}';
    //        }).get();

    //        checkedNamebutton.join(",");
    //        $.each($("[id^='product_modal'] input"), function () {
    //            $(this).prop('checked', false);
    //        });
    //        $('.ChangePrice-' + itemId).text(currency + ItemPrice);
    //        //alert('[' + checkedNamebutton + ', ' + checkedNames + ']');
    //        var Extras = '[' + checkedNamebutton + ', ' + checkedNames + ']';

    //        $.ajax({
    //            type: 'get',
    //            url: '/Index?handler=AddToCart',
    //            //url: '/Index?handler=AddToCart&itemId=' + itemId + '&qty=' + qty + '&price=' + price + '&Name=' + itemname + '&Extras=[' + checkedNamebutton + ',' + checkedNames + ']&Instr=' + instr ,
    //            data: { "itemId": itemId, "qty": qty, "price": price, "Name": itemname, "Extras": Extras, "Instr": instr },
    //            contentType: 'application/json;charset=utf-8',
    //            dataType: 'json',

    //            success: function (data) {
    //                var result = JSON.parse(data);
    //                if (JSON.parse(data).responseMessage == "" || JSON.parse(data).responseMessage == null) {
    //                    $('#loader').hide();

    //                    if (result.ordertype == "Dinein") {
    //                        //alert(result.ordertype);

    //                        var _issent = false;
    //                        var flag = false;
    //                        $('.guestname').remove();
    //                        $('.cart_items').remove();
    //                        $('.btn_checkout').hide();
    //                        if (result._cart.SplitCheck.GuestCount > 0) {
    //                            var html = '';
    //                            for (var i = 0; i < result._cart.SplitCheck.Guestusers.length; i++) {

    //                                if (result._cart.SplitCheck.Guestusers[i].Name != null) {

    //                                    if (result._cart.SplitCheck.Guestusers[i].gitemtotal != null && result._cart.SplitCheck.Guestusers[i].gitemtotal.subTotal != '0') {
    //                                        if (result._cart.SplitCheck.Guestusers[i].isactive == true) {
    //                                            html += "<tr style='background-color: aliceblue' class='guestname Guestuser guestactive' id='" + result._cart.SplitCheck.Guestusers[i].guestid + "'><td colspan='3'><h5>" + result._cart.SplitCheck.Guestusers[i].Name + "<span class='pull-right cart_total' id='bound_" + result._cart.SplitCheck.Guestusers[i].guestid + "'>$" + parseFloat(result._cart.SplitCheck.Guestusers[i].gitemtotal.subTotal).toFixed(2) + "</span></h5></td></tr>";
    //                                        }
    //                                        else {
    //                                            html += "<tr style='background-color: aliceblue' class='guestname Guestuser' id='" + result._cart.SplitCheck.Guestusers[i].guestid + "'><td colspan='3'><h5>" + result._cart.SplitCheck.Guestusers[i].Name + "<span class='pull-right cart_total' id='bound_" + result._cart.SplitCheck.Guestusers[i].guestid + "'>$" + parseFloat(result._cart.SplitCheck.Guestusers[i].gitemtotal.subTotal).toFixed(2) + "</span></h5></td></tr>";
    //                                        }
    //                                    }
    //                                    else {
    //                                        if (result._cart.SplitCheck.Guestusers[i].isactive == true) {
    //                                            html += "<tr style='background-color: aliceblue' class='guestname Guestuser guestactive' id='" + result._cart.SplitCheck.Guestusers[i].guestid + "'><td colspan='3'><h5>" + result._cart.SplitCheck.Guestusers[i].Name + "<span class='pull-right cart_total' id='bound_" + result._cart.SplitCheck.Guestusers[i].guestid + "'></span></h5></td></tr>";
    //                                        }
    //                                        else {
    //                                            html += "<tr style='background-color: aliceblue' class='guestname Guestuser' id='" + result._cart.SplitCheck.Guestusers[i].guestid + "'><td colspan='3'><h5>" + result._cart.SplitCheck.Guestusers[i].Name + "<span class='pull-right cart_total' id='bound_" + result._cart.SplitCheck.Guestusers[i].guestid + "'></span></h5></td></tr>";
    //                                        }
    //                                    }
    //                                    //html += "<tr style='background-color: aliceblue' class='guestname'><td colspan='3'><h5>" + result._cart.SplitCheck.Guestusers[i].Name + "<span class='pull-right cart_total' id='bound_" + result._cart.SplitCheck.Guestusers[i].guestid + "'>" + result._cart.SplitCheck.Guestusers[i].gitemtotal.subTotal + " (excluded all tax)</span></h5></td></tr>";
    //                                }
    //                                else {
    //                                    if (result._cart.SplitCheck.Guestusers[i].gitemtotal != null && result._cart.SplitCheck.Guestusers[i].gitemtotal.subTotal != '0') {
    //                                        if (result._cart.SplitCheck.Guestusers[i].isactive == true) {
    //                                            html += "<tr style='background-color: aliceblue' class='guestname Guestuser guestactive' id='" + result._cart.SplitCheck.Guestusers[i].guestid + "'><td colspan='3'><h5>Guest" + parseInt(i + 1) + "<span class='pull-right cart_total' id='bound_" + result._cart.SplitCheck.Guestusers[i].guestid + "'>$" + parseFloat(result._cart.SplitCheck.Guestusers[i].gitemtotal.subTotal).toFixed(2) + "</span></h5></td></tr>";
    //                                        }
    //                                        else {
    //                                            html += "<tr style='background-color: aliceblue' class='guestname Guestuser' id='" + result._cart.SplitCheck.Guestusers[i].guestid + "'><td colspan='3'><h5>Guest" + parseInt(i + 1) + "<span class='pull-right cart_total' id='bound_" + result._cart.SplitCheck.Guestusers[i].guestid + "'>$" + parseFloat(result._cart.SplitCheck.Guestusers[i].gitemtotal.subTotal).toFixed(2) + "</span></h5></td></tr>";
    //                                        }
    //                                    }
    //                                    else {
    //                                        if (result._cart.SplitCheck.Guestusers[i].isactive == true) {
    //                                            html += "<tr style='background-color: aliceblue' class='guestname Guestuser guestactive' id='" + result._cart.SplitCheck.Guestusers[i].guestid + "'><td colspan='3'><h5>Guest" + parseInt(i + 1) + "<span class='pull-right cart_total' id='bound_" + result._cart.SplitCheck.Guestusers[i].guestid + "'></span></h5></td></tr>";
    //                                        }
    //                                        else {
    //                                            html += "<tr style='background-color: aliceblue' class='guestname Guestuser' id='OLOGuest" + result._cart.SplitCheck.Guestusers[i].guestid + "'><td colspan='3'><h5>Guest" + parseInt(i + 1) + "<span class='pull-right cart_total' id='bound_" + result._cart.SplitCheck.Guestusers[i].guestid + "'></span></h5></td></tr>";
    //                                        }
    //                                    }
    //                                }
    //                                if (result._cart.SplitCheck.Guestusers[i].guestcartItems.length > 0) {
    //                                    //if (result._cart.SplitCheck.Guestusers[i].Name != null) {
    //                                    //    html += "<tr style='background-color: aliceblue' class='guestname'><td colspan='3'><h5>" + result._cart.SplitCheck.Guestusers[i].Name + "<span class='pull-right cart_total' id='bound_" + result._cart.SplitCheck.Guestusers[i].guestid + "'>" + result._cart.SplitCheck.Guestusers[i].gitemtotal.subTotal + " (excluded all tax)</span></h5></td></tr>";
    //                                    //}
    //                                    //else {
    //                                    //    html += "<tr style='background-color: aliceblue' class='guestname'><td colspan='3'><h5>Guest" + parseInt(i+1) + "<span class='pull-right cart_total' id='bound_" + result._cart.SplitCheck.Guestusers[i].guestid + "'>" + result._cart.SplitCheck.Guestusers[i].gitemtotal.subTotal + " (excluded all tax)</span></h5></td></tr>";
    //                                    //}

    //                                    for (var j = 0; j < result._cart.SplitCheck.Guestusers[i].guestcartItems.length; j++) {
    //                                        var allmodifierPrice = 0;
    //                                        if (result._cart.SplitCheck.Guestusers[i].guestcartItems[j].isSent == false) {
    //                                            flag = true;
    //                                            html += "<tr class='cart_items' id='row_" + result._cart.SplitCheck.Guestusers[i].guestcartItems[j].cartItemId + "' boundguest='bound_" + result._cart.SplitCheck.Guestusers[i].guestid + "'><td class='cart_qty'>" + result._cart.SplitCheck.Guestusers[i].guestcartItems[j].qty + " ×</td><td class='cart_name'><span class='cart_title'>" + result._cart.SplitCheck.Guestusers[i].guestcartItems[j].itemName + "</span>";
    //                                        }
    //                                        else {
    //                                            _issent = true;
    //                                            html += "<tr class='cart_items oldrow' id='row_" + result._cart.SplitCheck.Guestusers[i].guestcartItems[j].cartItemId + "'><td class='cart_qty'>" + result._cart.SplitCheck.Guestusers[i].guestcartItems[j].qty + " ×</td><td class='cart_name'><span class='cart_title'>" + result._cart.SplitCheck.Guestusers[i].guestcartItems[j].itemName + "</span>";
    //                                        }
    //                                        if (result._cart.SplitCheck.Guestusers[i].guestcartItems[j].modifiers != null && result._cart.SplitCheck.Guestusers[i].guestcartItems[j].modifiers.length > 0) {
    //                                            html += "<br /><span class='cart_info'>";
    //                                            for (var k = 0; k < result._cart.SplitCheck.Guestusers[i].guestcartItems[j].modifiers.length; k++) {
    //                                                html += "<label> •" + result._cart.SplitCheck.Guestusers[i].guestcartItems[j].modifiers[k]._modName + "</label >";
    //                                                allmodifierPrice = allmodifierPrice + result._cart.SplitCheck.Guestusers[i].guestcartItems[j].modifiers[k].price;
    //                                            }
    //                                            if (result._cart.SplitCheck.Guestusers[i].guestcartItems[j].specialInst != "" && result._cart.SplitCheck.Guestusers[i].guestcartItems[j].specialInst != null) {
    //                                                html += "<br /><label><i> •" + result._cart.SplitCheck.Guestusers[i].guestcartItems[j].specialInst + "</i></label>";
    //                                            }

    //                                        }
    //                                        else {
    //                                            if (result._cart.SplitCheck.Guestusers[i].guestcartItems[j].specialInst != "" && result._cart.SplitCheck.Guestusers[i].guestcartItems[j].specialInst != null) {
    //                                                html += "<br /><label><i> •" + result._cart.SplitCheck.Guestusers[i].guestcartItems[j].specialInst + "</i></label>";
    //                                            }
    //                                        }
    //                                        html += "</span>";
    //                                        if (result._cart.SplitCheck.Guestusers[i].guestcartItems[j].isSent == false) {
    //                                            html += "<br /> <a id='" + result._cart.SplitCheck.Guestusers[i].guestcartItems[j].cartItemId + "' href='javascript:Remove(\"" + result._cart.SplitCheck.Guestusers[i].guestcartItems[j].cartItemId + "\")' class='remove_item'>Remove</a>";
    //                                        }
    //                                        if (result._cart.SplitCheck.Guestusers[i].guestcartItems[j].modifiers == null || result._cart.SplitCheck.Guestusers[i].guestcartItems[j].modifiers.length == 0) {
    //                                            html += " </td > <td class='cart_price'>$" + (result._cart.SplitCheck.Guestusers[i].guestcartItems[j].itemPrice * result._cart.SplitCheck.Guestusers[i].guestcartItems[j].qty).toFixed(2) + "</td></tr> ";
    //                                        }
    //                                        else {
    //                                            html += " </td > <td class='cart_price'>$" + (parseFloat(result._cart.SplitCheck.Guestusers[i].guestcartItems[j].itemPrice * result._cart.SplitCheck.Guestusers[i].guestcartItems[j].qty) + parseFloat(allmodifierPrice * result._cart.SplitCheck.Guestusers[i].guestcartItems[j].qty)).toFixed(2) + "</td></tr> ";
    //                                        }
    //                                    }
    //                                }

    //                            }

    //                            // html += "<tr class='cart_items' id='row_" + result._cartItemId + "'><td class='cart_qty'>" + qty + " ×</td><td class='cart_name'><span class='cart_title'>" + itemname + "</span>";
    //                        }

    //                        if (_issent == true && flag == true) {

    //                            $('#tblCart #tr_startover').css('display', 'none');

    //                        }
    //                        else if (_issent == false && flag == true) {

    //                            $('#tblCart #tr_startover').show();
    //                        }
    //                        else {

    //                            $('#tblCart #tr_startover').css('display', 'none');
    //                        }
    //                        $('#orderSend').show();
    //                        $('#orderSend2').show();
    //                        $('#checkouthide').hide();
    //                        $('#orderSend2Dummy').hide();
    //                        $('#orderSendDummy').hide();
    //                        $('.total_price #cartTotalDue').html(currency + JSON.parse(data)._cart.total.subTotal.toFixed(2));
    //                        $('#orderSend2 a #guestcarttotal').html(currency + JSON.parse(data)._cart.total.subTotal.toFixed(2));
    //                        $('#orderSend2 a #orderSend').html(currency + JSON.parse(data)._cart.total.subTotal.toFixed(2));
    //                        $('#orderSend a #cartTotalDue').html(currency + JSON.parse(data)._cart.total.subTotal.toFixed(2));
    //                        $('#guestcarttotal').html(currency + JSON.parse(data)._cart.total.subTotal.toFixed(2));
    //                        //alert(_issent + ', ' + flag);

    //                    }
    //                    else {


    //                        var html = "<tr class='cart_items' id='row_" + JSON.parse(data)._cartItemId + "'><td class='cart_qty'>" + qty + " ×</td><td class='cart_name'><span class='cart_title'>" + itemname + "</span>";

    //                        if (checkedNamebutton != '' || checkedNames != '') {

    //                            if (checkedVals == "" && checkedbutton != "") {
    //                                html = html + "<br /><span class='cart_info'><label>•" + checkedbutton + "</label>";
    //                            }
    //                            else if (checkedVals != "" && checkedbutton == "") {
    //                                html = html + "<br /><span class='cart_info'><label>•" + checkedVals + "</label>";
    //                            }
    //                            else {
    //                                html = html + "<br /><span class='cart_info'><label>•" + checkedVals + "•" + checkedbutton + "</label>";
    //                            }
    //                            if (instr != "" && instr != 'undefined' && instr != undefined)
    //                                html = html + "<br /><label><i> •" + instr + "</label></i>";

    //                            html = html + "</span>";
    //                        }
    //                        else if (instr != "" && instr != 'undefined' && instr != undefined)
    //                            html = html + "<br /><span class='cart_info'><label><i> •" + instr + "</i></label></span>";

    //                        html = html + "<br /> <a id='" + JSON.parse(data)._cartItemId + "' href='javascript:Remove(\"" + JSON.parse(data)._cartItemId + "\")' class='remove_item'>Remove</a> </td > ";
    //                        //html = html + "<td class='cart_price'>$" + parseFloat((price * qty) + GetModifierPrice(itemId) * qty).toFixed(2)+"</td></tr>";
    //                        html = html + "<td class='cart_price'>" + itemTotalprice + "</td></tr>";
    //                        $('#orderSend').show();
    //                        $('#orderSend2').show();
    //                        $('#orderSend2 a #orderSend').html(currency + JSON.parse(data)._cart.total.subTotal.toFixed(2));
    //                        $('.total_price #cartTotalDue').html(currency + JSON.parse(data)._cart.total.subTotal.toFixed(2));
    //                        $('#orderSend a #cartTotalDue').html(currency + JSON.parse(data)._cart.total.subTotal.toFixed(2));
    //                        $('#orderSend2Dummy').hide();
    //                        $('#orderSendDummy').hide();
    //                        $('.Guestuser .cart_total').html(currency + JSON.parse(data)._cart.total.subTotal.toFixed(2));
    //                        //if (JSON.parse(data)._cart.minVal > JSON.parse(data)._cart.total.subTotal.toFixed(2)) {
    //                        //    $('#minOrder').attr('href', 'javascript:ProcessOrder()');
    //                        //    $('#placeOrder').attr('onClick', 'ProcessOrder()');
    //                        //    $.each($('#cart_total'), function () {
    //                        //        $(this).html("$"+_cart.total.totalDue.toFixed(2));
    //                        //    });
    //                        //}

    //                    }
    //                    //location.reload();
    //                    $('#tblCart').append(html);

    //                    if (JSON.parse(data)._cart.minValue <= JSON.parse(data)._cart.total.subTotal.toFixed(2) && JSON.parse(data)._cart.validateMin) {


    //                        $('.total_price>td #minVal').attr('href', 'javascript:Checkout()');
    //                        $('.total_price>td #minVal').html('Checkout <span class="pull-right cart_total" id="cartTotalDue">$' + JSON.parse(data)._cart.total.totalDue.toFixed(2) + '</span>');
    //                        $('#cartTotalDue').html(currency + JSON.parse(data)._cart.total.subTotal.toFixed(2));
    //                        $("#minVal").removeAttr("style");

    //                    }
    //                    else if (JSON.parse(data)._cart.minValue > JSON.parse(data)._cart.total.subTotal.toFixed(2) && JSON.parse(data)._cart.validateMin) {

    //                        if ($('#minVal').length > 0) {
    //                            $('.total_price>td #minVal').attr('href', '#');
    //                            $('.total_price>td #minVal').html('Minimum Order: <span class="pull-right cart_total" id="cartTotalDue">$' + JSON.parse(data)._cart.minValue.toFixed(2) + '</span>');

    //                            $('.total_price>td #minVal').removeAttr('href');
    //                            $("#minVal").css("color", "red");

    //                        }
    //                        else {
    //                            $('a[href="javascript:Checkout()"]').attr('href', '#');
    //                            $('a[href="javascript:Checkout()"]').html('Minimum Order: <span class="pull-right cart_total" id="cartTotalDue">$' + JSON.parse(data)._cart.minValue.toFixed(2) + '</span>');
    //                            $('.total_price>td #minVal').removeAttr('href');
    //                            $("#minVal").css("color", "red");
    //                        }
    //                        $('#cartTotalDue').html("$" + JSON.parse(data)._cart.minValue.toFixed(2));
    //                    }
    //                    else {

    //                        $('.total_price>td #minVal').attr('href', 'javascript:Checkout()');
    //                        $('.total_price>td #minVal').html('Checkout <span class="pull-right cart_total" id="cartTotalDue">$' + JSON.parse(data)._cart.total.totalDue.toFixed(2) + '</span>');
    //                        $('#cartTotalDue').html(currency + JSON.parse(data)._cart.total.subTotal.toFixed(2));
    //                        $("#minVal").removeAttr("style");
    //                    }

    //                    if ($("#tblCart #checkouthide").is(":visible")) {
    //                        //alert('hide');
    //                        $('#tblCart tr #checkouthide').css('display', 'none');
    //                        $('.tr_startover').hide();
    //                    }

    //                    $('#checkouthide').css('display', 'none');
    //                    $('#product_modal-' + itemId).modal('hide');
    //                    $('#qty_' + itemId).val('1');
    //                    $('#instr_' + itemId).val('');



    //                    $('.total_price').show();

    //                    $('#noItems').hide();

    //                    $('.qty').text(JSON.parse(data).qty);


    //                }
    //                else {
    //                    $('#promo-modal').modal('show');
    //                    $('#promo-modal #lblMessage').html(JSON.parse(data).responseMessage);
    //                    $('#loader').hide();
    //                    return false;
    //                }

    //            },
    //            error: function (jqXHR, textStatus, errorThrown) {
    //                $('#loader').hide();
    //                if (jqXHR.status == 404 || errorThrown == 'Not Found') {
    //                    $('#promo-modal').modal('show');
    //                    $('#promo-modal #lblMessage').html('<h4>Oops something happened , please contact store directly</h4>');

    //                    setTimeout(function () {
    //                        $('#promo-modal').modal('hide');
    //                        location.href = "/WelcomePage";
    //                    }, 3000);
    //                }
    //            }
    //        });
    //    }
    //}

$('.tips-ul li').click(function () {

$('.collapse').removeClass('show');
    var currency='$';

    if ($(this).text() != "Others") {
        $('#loader').show();
        $('.tips-ul li').removeClass('active');
        $(this).addClass("active");
        var amount = parseFloat($(this).text().replace(currency, ''));

        ApplySVC(amount, false);

    }


    else {
        $('.tips-ul li').removeClass('active');
        $(this).addClass("active");
        //var amount = parseFloat($('#customTip').val().replace(currency, ''));

        //var POSamount = parseFloat($('#tipsPOS').val().replace(currency, ''));

        //amount = amount + POSamount;


        //$('.tipsTotal').html('$ ' + amount);

        //ApplySVC(amount, true);
    }

});

    $('#customTip').on("blur", function () {
        $('#loader').show();
        var currency = '$';
        var amnt;
        if ($(this).val().includes(currency)) {
             amnt = $(this).val().substring(1).trim();

        }

        else {
             amnt = $(this).val().trim();
        }
        var amount = parseFloat(amnt);
        ApplySVC(amount, true);


    });

//$('#customTip').on("keyup", function () {

//    $('#loader').show();
//    var amount = parseFloat($(this).val().replace(currency, ''));

//    //var POSamount = parseFloat($('#tipsPOS').val().replace(currency, ''));

//    //amount = amount + POSamount;


//    //$('.tipsTotal').html('$ ' + amount);

//    ApplySVC(amount);


//})

    function isAlphabet(evt) {

        var _alphapattern = /^[A-Za-z]+$/;



        var firstname = evt.target.value;
        if (firstname != '' && !_alphapattern.test(firstname)) {
           
            evt.target.value = evt.target.value.replace(/[^A-Za-z]/g, '');
            return false;

        }
    };

    function isNumber(evt) {
        var iKeyCode = (evt.which) ? evt.which : evt.keyCode
        var id = evt.target.id;

        if (iKeyCode != 46 && iKeyCode > 31 && (iKeyCode < 48 || iKeyCode > 57)) {
            return false;
        }
        else if (id == 'customTip') {
            // var val = evt.target.value.replace(currency, '');
            var val = evt.target.value.substring(1).trim();
            var numArray = val.split('.');

            if (numArray[1].length <= 1) {
                return true;
            }
            else {
                return false;
            }
        }
        else if (id=='rphone'||id=='pphone') {
            var val = evt.target.value.trim();
            if (val.length <= 10) {
                return true
            } else {
                return false;
            }
        }
        return true;
    }
    function isTwoDecimal(obj) {
        var value = obj.Value;
        var regex = /^(?:\d*\.\d{1,2}|\d+)$/;
        if (!regex.test(value)) {
            return false;
        }
        else {
            return true;
        }
    }
    function ApplySVC(amount, isAmount) {
        if (isNaN(amount)) {
            amount = 0;
        }

        $.ajax({
            type: 'get',
            url: '/Checkout?handler=ApplySVC&amount=' + amount + '&isAmount=' + isAmount,
            data: null,
            contentType: 'application/json;charset=utf-8',
            dataType: 'json',

            success: function (data) {
                 currency = '$';
                //var total = parseFloat(JSON.parse(data).total.SVCAmountorPer) + parseFloat(JSON.parse(data).total.taxTotal) + parseFloat(JSON.parse(data).total.subTotal);
                console.log(JSON.parse(data));
                $('.tipsTotal').html(currency + parseFloat(JSON.parse(data).total.svc).toFixed(2));
                //$('.taxTotal').html(currency + parseFloat(JSON.parse(data).total.taxTotal).toFixed(2));
                $('.totalDue').html(currency + parseFloat(JSON.parse(data).total.totalDue).toFixed(2));
                $('.cart_total').html(currency + parseFloat(JSON.parse(data).total.totalDue).toFixed(2));
                $('#tipsTotal').html(currency + parseFloat(JSON.parse(data).total.svc).toFixed(2));
                //$('#taxTotal').html(currency + parseFloat(JSON.parse(data).total.taxTotal).toFixed(2));
                $('#totalDue').html(currency + parseFloat(JSON.parse(data).total.totalDue).toFixed(2));
                if ($('#Lpoints').length > 0) {
                    $('#Lpoints').text(parseFloat(JSON.parse(data).loyalty[0].pointsUsedForPayment).toFixed(2));
                } else if ($('#Lbalance').length>0) {
                    $('#Lbalance').text(parseFloat(JSON.parse(data).loyalty[0].balanceUsedForPayment).toFixed(2));
                }
                var total = JSON.parse(data).total;
                $('#tr_giftcardremove').show();
                var tr = "";
                var giftcardtotal = 0;

                $('[id^="trcard_"]').remove();
                $('[id^="trcardrm_"]').remove();
                if (total.Giftcard != null && total.Giftcard.length > 0) {
                    for (var i = 0; i < total.Giftcard.length; i++) {
                        var maskchar = total.Giftcard[i].CardNumber.substr(0, 11).replace(total.Giftcard[i].CardNumber.substr(0, 11), 'XXXXXXXXXXXX');
                        var maskcard = maskchar + total.Giftcard[i].CardNumber.substr(12, 15);
                        tr += '<tr class="no_border" id="trcard_' + total.Giftcard[i].CardNumber + '">';
                        tr += '<td class="sub_label">Gift Card</td>';
                        tr += '<td class="pull-right GCTotal" id="GCTotal">' + parseFloat(total.Giftcard[i].CardAppliedBal).toFixed(2) + '</td>';
                        tr += '</tr>';
                        tr += '<tr class="no_border"  id="trcardrm_' + total.Giftcard[i].CardNumber + '">';
                        tr += '<td class="sub_label">' + maskcard + '</td>';
                        tr += '<td class="pull-right GCTotal" id="GCTotal"><a href="javascript:RemoveGiftCard(' + total.Giftcard[i].CardNumber + ')" style="color:red" value="' + total.Giftcard[i].CardNumber + '">Remove</a></td>';
                        tr += '</tr>';
                        giftcardtotal = giftcardtotal + total.Giftcard[i].CardAppliedBal;
                    }
                    $('#totals').find("tr:last").before(tr);
                    var totalDue = parseFloat(total.subTotal + total.tips + total.taxTotal + total.svc).toFixed(2) - parseFloat(total.GCTotal);

                    if (totalDue == '0') {
                        $("#placeOrder .cart_total").html('');
                        $('#cart_total').html('');
                        $('#placeOrderInstruction').hide();
                        $('#placeOrderInstructionMob').hide();
                    }
                    else {
                        $('#placeOrderInstruction').show();
                        $('#placeOrderInstructionMob').show();
                        $("#placeOrder .cart_total").html(currency + parseFloat(totalDue).toFixed(2));
                        $('#cart_total').html(currency + parseFloat(totalDue).toFixed(2));
                    }
                }
                else {
                    $('#cart_total').html(currency + parseFloat(JSON.parse(data).total.totalDue).toFixed(2));
                    //$('#cart_total').html(currency + (parseFloat(JSON.parse(data).total.totalDue) + parseFloat(JSON.parse(data).total.GCTotal)).toFixed(2));
                }
                //$('#loader').hide();
                location.reload();
                // $('#cart_total').html(currency + parseFloat(JSON.parse(data).total.totalDue).toFixed(2));
                // $('#cart_total').html(currency + (parseFloat(JSON.parse(data).total.totalDue) + parseFloat(JSON.parse(data).total.GCTotal)).toFixed(2));
                // $('#GCTotal').html(currency + parseFloat(JSON.parse(data).total.GCTotal).toFixed(2));


                //
            },
            error: function (jqXHR, textStatus, errorThrown) {
                $('#loader').hide();
                if (jqXHR.status == 404 || errorThrown == 'Not Found') {
                    $('#promo-modal').modal('show');
                    $('#promo-modal #lblMessage').html('<h4>Oops something happened , please try again!</h4>');

                }
            }
        });


    }




$("#spInstr").on('change paste', function () {
var instuctn = $("#spInstr").val();
if (instuctn.length>32) {
$("#pay-modal").modal("show");
$('#lblPayMessage').html('<h4>Only 32 characters are allowed</h4>');
return false;
}
//
$.ajax({
type: 'get',
url: '/Checkout?handler=Saveinstruction',
//url: '/Checkout?handler=Saveinstruction&instuctn=' + instuctn,
data: { "instuctn": instuctn },
contentType: 'application/json;charset=utf-8',
dataType: 'json',

success: function (data) {


},
error: function (jqXHR, textStatus, errorThrown) {
if (jqXHR.status == 404 || errorThrown == 'Not Found') {
$('#promo-modal').modal('show');
$('#promo-modal #lblMessage').html('<h4>Oops something happened , please contact store directly</h4>');

setTimeout(function () {
$('#promo-modal').modal('hide');
location.href = "/WelcomePage";
}, 3000);
}
}
});

});

$("#Dineemail").on('change paste', function () {
var email = $("#Dineemail").val();
var emailReg = /^([\w-\.]+@([\w-]+\.)+[\w-]{2,4})?$/;
if (!emailReg.test(email)) {
$("#pay-modal").modal("show");
$('#lblPayMessage').html('<h4> Enter valid EmailId </h4>');
return false;
}
//
$.ajax({
type: 'get',
url: '/Checkout?handler=Saveguestemail&usermail=' + email,
data: null,
contentType: 'application/json;charset=utf-8',
dataType: 'json',

success: function (data) {
//alert(data);

},
error: function (jqXHR, textStatus, errorThrown) {
if (jqXHR.status == 404 || errorThrown == 'Not Found') {
$('#promo-modal').modal('show');
$('#promo-modal #lblMessage').html('<h4>Oops something happened , please contact store directly</h4>');

setTimeout(function () {
$('#promo-modal').modal('hide');
location.href = "/WelcomePage";
}, 3000);
}
}
});

});

window.fbAsyncInit = function () {
// FB JavaScript SDK configuration and setup
FB.init({
appId: '244189860208923', // FB App ID
cookie: true,  // enable cookies to allow the server to access the session
xfbml: true,  // parse social plugins on this page
version: 'v8.0' // use graph api version 2.8
});


};

// Load the JavaScript SDK asynchronously
(function (d, s, id) {
var js, fjs = d.getElementsByTagName(s)[0];
if (d.getElementById(id)) return;
js = d.createElement(s); js.id = id;
js.src = "//connect.facebook.net/en_US/sdk.js";
fjs.parentNode.insertBefore(js, fjs);
}(document, 'script', 'facebook-jssdk'));

function fbLogincheckout() {
$('#loader').show();
FB.login(function (response) {
if (response.authResponse) {
// Get and display the user profile data
LoginProcess = "FB";
getFbUserDataCheckout();
$('#loader').hide();
} else {
$('#loader').hide();
// alert('User cancelled login or did not fully authorize.');
}
}, { scope: 'email' });

}

    function getFbUserDataCheckout() {
        var GPSignIn = 0;
        if ($('#GPGuestSignInForward').length>0) {
            GPSignIn = parseInt($('#GPGuestSignInForward').val());
        }
$('#loader').show();
FB.api('/me', { locale: 'en_US', fields: 'id,first_name,last_name,email,link,gender,locale,picture' },
function (response) {
$('#loader').show();
$.ajax({
    type: 'get',
    url: '/Index?handler=SaveUser&details=' + response.first_name + ' ' + response.last_name + '&email=' + response.email + '&id=' + response.id + '&LoginSource=Facebook&IsGP=' + GPSignIn,
data: null,
contentType: 'application/json;charset=utf-8',
dataType: 'json',

success: function (data) {
// $('#loader').hide();
if (data == "WELCOME") {
//location.reload();
window.top.location = "Checkout";

} else if (data == "CHECKOUT") {
//location.reload();
window.top.location = "Checkout";

}
else if (data == "INDEX") {
//location.reload();
window.top.location = "Index";

}

}
,
error: function (jqXHR, textStatus, errorThrown) {
$('#loader').hide();
if (jqXHR.status == 404 || errorThrown == 'Not Found') {
$('#promo-modal').modal('show');
$('#promo-modal #lblMessage').html('<h4>Oops something happened , please contact store directly</h4>');

setTimeout(function () {
$('#promo-modal').modal('hide');
location.href = "/WelcomePage";
}, 3000);
}
}
});

//alert('<p>Thanks for logging in, ' + response.first_name + '!</p>');
//alert( '<h2>Facebook Profile Details</h2><p><img src="' + response.picture.data.url + '"/></p><p><b>FB ID:</b> ' + response.id + '</p><p><b>Name:</b> ' + response.first_name + ' ' + response.last_name + '</p><p><b>Email:</b> ' + response.email + '</p><p><b>Gender:</b> ' + response.gender + '</p><p><b>FB Profile:</b> <a target="_blank" href="' + response.link + '">click to view profile</a></p>');
});
}

// Facebook login with JavaScript SDK
function fbLogin() {
$('#loader').show();
FB.login(function (response) {
if (response.authResponse) {
// Get and display the user profile data
LoginProcess = "FB";
getFbUserData();
$('#loader').hide();
} else {
$('#loader').hide();
// alert('User cancelled login or did not fully authorize.');
}
}, { scope: 'email' });

}

// Fetch the user profile data from facebook
    function getFbUserData() {
        var GPSignIn = 0;
        if ($('#GPGuestSignInForward').length > 0) {
            GPSignIn = parseInt($('#GPGuestSignInForward').val());
        }
$('#loader').show();
FB.api('/me', { locale: 'en_US', fields: 'id,first_name,last_name,email,link,gender,locale,picture' },
function (response) {
$('#loader').show();
$.ajax({
type: 'get',
    url: '/Index?handler=SaveUser&details=' + response.first_name + ' ' + response.last_name + '&email=' + response.email + '&id=' + response.id + '&LoginSource=Facebook&IsGP=' + GPSignIn,
data: null,
contentType: 'application/json;charset=utf-8',
dataType: 'json',

success: function (data) {
// $('#loader').hide();
if (data == "WELCOME") {
 if (window.location.href.toUpperCase().indexOf("WELCOMEPAGE") > -1){
                            location.href="/welcomepage";
                        }
                        else{
                            location.reload();
                        }

} else if (data == "CHECKOUT") {
 if (window.location.href.toUpperCase().indexOf("WELCOMEPAGE") > -1){
                            location.href="/welcomepage";
                        }
                        else{
                            location.reload();
                        }

}
else if (data == "INDEX") {
 if (window.location.href.toUpperCase().indexOf("WELCOMEPAGE") > -1){
                            location.href="/welcomepage";
                        }
                        else{
                            location.reload();
                        }

}

}
,
error: function (jqXHR, textStatus, errorThrown) {
$('#loader').hide();
if (jqXHR.status == 404 || errorThrown == 'Not Found') {
$('#promo-modal').modal('show');
$('#promo-modal #lblMessage').html('<h4>Oops something happened , please contact store directly</h4>');

setTimeout(function () {
$('#promo-modal').modal('hide');
location.href = "/WelcomePage";
}, 3000);
}
}
});

//alert('<p>Thanks for logging in, ' + response.first_name + '!</p>');
//alert( '<h2>Facebook Profile Details</h2><p><img src="' + response.picture.data.url + '"/></p><p><b>FB ID:</b> ' + response.id + '</p><p><b>Name:</b> ' + response.first_name + ' ' + response.last_name + '</p><p><b>Email:</b> ' + response.email + '</p><p><b>Gender:</b> ' + response.gender + '</p><p><b>FB Profile:</b> <a target="_blank" href="' + response.link + '">click to view profile</a></p>');
});
}

function Logout() {
FB.logout(function () {
$.ajax({
type: 'get',
url: '/Index?handler=Logout',
data: null,
contentType: 'application/json;charset=utf-8',
dataType: 'json',

success: function (data) {
//window.location.href = "Index";
$('.list-inline-item #logout').empty();
var d = '<i class="fa fa-sign-in"></i>Sign in';
$('#logout').attr('href', 'javascript:openLogin();');
$('#logout').append(d);
},
error: function (jqXHR, textStatus, errorThrown) {
if (jqXHR.status == 404 || errorThrown == 'Not Found') {
$('#promo-modal').modal('show');
$('#promo-modal #lblMessage').html('<h4>Oops something happened , please contact store directly</h4>');

setTimeout(function () {
$('#promo-modal').modal('hide');
location.href = "/WelcomePage";
}, 3000);
}
}
});


})
}

// Logout from facebook
function fbLogout() {
FB.logout(function () {
document.getElementById('fbLink').setAttribute("onclick", "fbLogin()");
document.getElementById('fbLink').innerHTML = '<img src="images/fb-login-btn.png"/>';
document.getElementById('userData').innerHTML = '';
document.getElementById('status').innerHTML = '<p>You have successfully logout from Facebook.</p>';
});
}

    function Signout() {
      
        $.ajax({
            type: 'get',
            url: '/Index?handler=Logout',
            data: null,
            contentType: 'application/json;charset=utf-8',
            dataType: 'json',

            success: function (data) {

                if (window.location.pathname.toUpperCase() == "/ORDERS") {
                    window.top.location = "Index";
                }
                else {
                    window.location.reload();
                }

                //$('.list-inline-item #logout').empty();
                //var d = '<i class="fa fa-sign-in"></i>Sign in';
                //$('#logout').attr('href', 'javascript:openLogin();');
                //$('#logout').append(d);
                // window.top.location = "Index";
            },
            error: function (jqXHR, textStatus, errorThrown) {
                if (jqXHR.status == 404 || errorThrown == 'Not Found') {
                    $('#promo-modal').modal('show');
                    $('#promo-modal #lblMessage').html('<h4>Oops something happened , please contact store directly</h4>');

                    setTimeout(function () {
                        $('#promo-modal').modal('hide');
                        location.href = "/WelcomePage";
                    }, 3000);
                }
            }
        });

    }

function logout() {
//alert('logging out');
//var auth2 = gapi.auth2.getAuthInstance();
//auth2.signOut().then(function () {
//    console.log('User signed out.');
//});
}
/*]]>*/
</script>
                <script>
    function CancelGroupOrder() {
        $('#loader').show();
        $.ajax({
            type: 'get',
            url: '/Index?handler=CancelGroupOrder',
            data: null,
            contentType: 'application/json;charset=utf-8',
            dataType: 'json',

            success: function (data) {
                $('.modal').modal('hide');
                window.location = "/Index";

            },
            error: function (jqXHR, textStatus, errorThrown) {
                if (jqXHR.status == 404 || errorThrown == 'Not Found') {
                    $('#promo-modal').modal('show');
                    $('#promo-modal #lblMessage').html('<h4>Oops something happened , please contact store directly</h4>');

                    setTimeout(function () {
                        $('#promo-modal').modal('hide');
                        location.href = "/WelcomePage";
                    }, 3000);
                }
            }

        });
    }


    function RemoveGroupItemIndexPage(cartitemid) {

        $.ajax({
            type: 'get',
            url: '/Checkout?handler=IndexRemove&itemId=' + cartitemid,
            data: null,
            contentType: 'application/json;charset=utf-8',
            dataType: 'json',

            success: function (data) {
                $('#row_' + cartitemid).hide();
                 var currency = '$';
                if (JSON.parse(data).ordertype != "DineIn") {

                    if (JSON.parse(data).subTotal == "0.00") {

                        $('.total_price').hide();
                        $('#noItems').show();
                        $('.qty').text(JSON.parse(data).qty);
                    }
                    else {
                        $('.cart_total').html(currency + parseFloat(JSON.parse(data).subTotal).toFixed(2));
                        $('.total_price').show();
                        $('.qty').text(JSON.parse(data).qty);
                        var cartitems = JSON.parse(data)._cart.cartItems;
                        if (cartitems != null && cartitems.length > 0) {
                            var flag = false;
                            for (var i = 0; i < cartitems.length; i++) {

                                if (cartitems[i].isSent == false) {
                                    flag = true;

                                }

                            }
                            if (!flag) {
                                $('.total_price #orderSend').css('display', 'none');
                                $('.total_price #orderSendDummy').show();
                                $('.total_price #checkouthide').css('display', 'table-cell');
                            }
                        }

                    }
                    if (JSON.parse(data)._cart.minValue < JSON.parse(data)._cart.total.subTotal.toFixed(2) && JSON.parse(data)._cart.validateMin) {

                        $('.total_price>td #minVal').attr('href', 'javascript:Checkout()');
                        $('.total_price>td #minVal').html('Checkout <span class="pull-right cart_total" id="cartTotalDue">$' + JSON.parse(data)._cart.total.totalDue.toFixed(2) + '</span>');
                        $('#cartTotalDue').html(currency + JSON.parse(data)._cart.total.subTotal.toFixed(2));
                        $("#minVal").removeAttr("style");
                    }
                    else if (JSON.parse(data)._cart.minValue > JSON.parse(data)._cart.total.subTotal.toFixed(2) && JSON.parse(data)._cart.validateMin) {

                        if ($('#minVal').length > 0) {
                            $('.total_price>td #minVal').attr('href', '#');
                            $('.total_price>td #minVal').html('Minimum Order: <span class="pull-right cart_total" id="cartTotalDue">$' + JSON.parse(data)._cart.minValue.toFixed(2) + '</span>');

                        }
                        else {
                            $('a[href="javascript:Checkout()"]').attr('href', '#');
                            $('a[href="javascript:Checkout()"]').html('Minimum Order: <span class="pull-right cart_total" id="cartTotalDue">$' + JSON.parse(data)._cart.minValue.toFixed(2) + '</span>');
                        }

                        $('#cartTotalDue').html(currency + JSON.parse(data)._cart.minValue.toFixed(2));
                        $('.total_price>td #minVal').removeAttr('href');
                        $("#minVal").css("color", "red");
                    }

                    else {

                        $('.total_price>td #minVal').attr('href', 'javascript:Checkout()');
                        $('.total_price>td #minVal').html('Checkout <span class="pull-right cart_total" id="cartTotalDue">$' + JSON.parse(data)._cart.total.totalDue.toFixed(2) + '</span>');
                        $('#cartTotalDue').html(currency + JSON.parse(data)._cart.total.subTotal.toFixed(2));
                        $("#minVal").removeAttr("style");
                    }

                }


                $('#loader').hide();

            },
            error: function (jqXHR, textStatus, errorThrown) {
                $('#loader').hide();
                if (jqXHR.status == 404 || errorThrown == 'Not Found') {
                    $('#promo-modal').modal('show');
                    $('#promo-modal #lblMessage').html('<h4>Oops something happened , please contact store directly</h4>');

                    setTimeout(function () {
                        $('#promo-modal').modal('hide');
                        location.href = "/WelcomePage";
                    }, 3000);

                }
            }
        });

    }

    function DeleteUserItemFromSession(cartitemid) {
        $.ajax({
            type: 'get',
            url: '/Checkout?handler=CheckAppliedDiscount&itemId=' + cartitemid,
            data: null,
            contentType: 'application/json;charset=utf-8',
            dataType: 'json',
            success: function (data) {

                $('#loader').hide();

                if (data == 'true') {

                    $('#promo-modal').modal('show');
                    $('#promo-modal .close').hide();
                    $('#promo-modal #lblMessage').html('<h4>The applied offer is being reset now</h4>');
                    setTimeout(function () {
                        $('#promo-modal').modal('hide');
                        $('#promo-modal .close').show();
                        $('#loader').show();
                        RemoveGroupItemIndexPage(cartitemid);
                    }, 3000);

                }
                else {
                    RemoveGroupItemIndexPage(cartitemid);
                }
            },
            error: function (jqXHR, textStatus, errorThrown) {
                $('#loader').hide();
                if (jqXHR.status == 404 || errorThrown == 'Not Found') {
                    $('#promo-modal').modal('show');
                    $('#promo-modal #lblMessage').html('<h4>Oops something happened , please contact store directly</h4>');

                    setTimeout(function () {
                        $('#promo-modal').modal('hide');
                        location.href = "/WelcomePage";
                    }, 3000);
                }
            }
        });
    }

                </script>
                                <script>function GetPublicKey() {
                                        var token = '';
                                        $.get('/welcomepage?handler=PublicKey', null, function (data) { token = data.key; });
                                        return token;
                                    }</script>
                                                <script>$(function () {
                                                        if (window.location == window.location.host) {
                                                            location.href = window.location.host + "/welcomepage";
                                                        }
                                                    });</script>
                                                                    <script>var googleUser = {};
                                                                        var auth2;

                                                                        var startAppA = function () {
                                                                            gapi.load('auth2', function () {
                                                                                //Retrieve the singleton for the GoogleAuth library and set up the client.
                                                                                auth2 = gapi.auth2.init({
                                                                                    client_id: '574064121236-k9pmfgasjq1ads90ufp0povbac0rmnhi.apps.googleusercontent.com',//'863503892193-82a6lfsnmclfj6qioohsk6vq4ka3j7ie.apps.googleusercontent.com',
                                                                                    secret_key: 'wvpb4XsUCJO_vdmHCLQ7f_Hd', //'7AjC0mwP5H4DXUKHq5vr0ooB',
                                                                                    cookiepolicy: 'single_host_origin',
                                                                                });
                                                                                attachSignin(document.getElementById('GoogleLogin'));
                                                                                attachSignincheckout(document.getElementById('GoogleLoginCheckout'));

                                                                                attachSigninOrder(document.getElementById('GoogleLoginOrder'));
                                                                            });
                                                                        };

                                                                        function attachSignincheckout(element) {

                                                                            if (element == 'undefined')
                                                                                element = document.getElementById('GoogleLogin');
                                                                            //console.log(element.id);
                                                                            //console.log(element);
                                                                            auth2.attachClickHandler(element, {},
                                                                                function (googleUser) {
                                                                                    // $('#loginModal').modal('hide');
                                                                                    //$(".se-pre-con").show();
                                                                                    var GPSignIn = 0;
                                                                                    if ($('#GPGuestSignInForward').length > 0) {
                                                                                        GPSignIn = parseInt($('#GPGuestSignInForward').val());
                                                                                    }
                                                                                    console.log(googleUser);
                                                                                    $('#loader').show();
                                                                                    var profiles = googleUser.getBasicProfile();
                                                                                    //var ReturnUrl = 'https://localhost:44317/';
                                                                                    //Crate A Bunch Of Object for Search
                                                                                    var objData = {
                                                                                        Email: profiles.getEmail(),
                                                                                        LastName: profiles.getFamilyName(),
                                                                                        FirstName: profiles.getGivenName(),
                                                                                        GoogleID: profiles.getId(),
                                                                                        ProfileURL: profiles.getName(),
                                                                                    };

                                                                                    $.ajax({
                                                                                        type: 'get',
                                                                                        url: '/Index?handler=SaveUser&details=' + profiles.getGivenName() + ' ' + profiles.getFamilyName() + '&email=' + profiles.getEmail() + '&id=' + profiles.getId() + '&LoginSource=Google&IsGP=' + GPSignIn,
                                                                                        data: null,
                                                                                        contentType: 'application/json;charset=utf-8',
                                                                                        dataType: 'json',
                                                                                        success: function (data) {
                                                                                            $('#loginModal').modal('hide');
                                                                                            LoginProcess = "Google";
                                                                                            //location.reload();
                                                                                            window.top.location = "checkout";
                                                                                        },
                                                                                        error: function (jqXHR, textStatus, errorThrown) {
                                                                                            if (jqXHR.status == 404 || errorThrown == 'Not Found') {
                                                                                                $('#promo-modal').modal('show');
                                                                                                $('#promo-modal #lblMessage').html('<h4>Oops something happened , please contact store directly</h4>');

                                                                                                setTimeout(function () {
                                                                                                    $('#promo-modal').modal('hide');
                                                                                                    location.href = "/WelcomePage";
                                                                                                }, 3000);
                                                                                            }
                                                                                        }

                                                                                    });
                                                                                    // $('#loader').hide();
                                                                                    //$(".se-pre-con").hide();
                                                                                });
                                                                        }

                                                                        function attachSignin(element) {

                                                                            if (element == 'undefined')
                                                                                element = document.getElementById('GoogleLogin');
                                                                            //console.log(element.id);
                                                                            //console.log(element);
                                                                            auth2.attachClickHandler(element, {},
                                                                                function (googleUser) {
                                                                                    // $('#loginModal').modal('hide');
                                                                                    //$(".se-pre-con").show();
                                                                                    var GPSignIn = 0;
                                                                                    if ($('#GPGuestSignInForward').length > 0) {
                                                                                        GPSignIn = parseInt($('#GPGuestSignInForward').val());
                                                                                    }

                                                                                    console.log(googleUser);
                                                                                    $('#loader').show();
                                                                                    var profiles = googleUser.getBasicProfile();
                                                                                    //var ReturnUrl = 'https://localhost:44317/';
                                                                                    //Crate A Bunch Of Object for Search
                                                                                    var objData = {
                                                                                        Email: profiles.getEmail(),
                                                                                        LastName: profiles.getFamilyName(),
                                                                                        FirstName: profiles.getGivenName(),
                                                                                        GoogleID: profiles.getId(),
                                                                                        ProfileURL: profiles.getName(),
                                                                                    };

                                                                                    $.ajax({
                                                                                        type: 'get',
                                                                                        url: '/Index?handler=SaveUser&details=' + profiles.getGivenName() + ' ' + profiles.getFamilyName() + '&email=' + profiles.getEmail() + '&id=' + profiles.getId() + '&LoginSource=Google&IsGP=' + GPSignIn,
                                                                                        data: null,
                                                                                        contentType: 'application/json;charset=utf-8',
                                                                                        dataType: 'json',
                                                                                        success: function (data) {
                                                                                            $('#loginModal').modal('hide');
                                                                                            LoginProcess = "Google";
                                                                                            if (window.location.href.toUpperCase().indexOf("WELCOMEPAGE") > -1) {
                                                                                                location.href = "/welcomepage";
                                                                                            }
                                                                                            else {
                                                                                                location.reload();
                                                                                            }


                                                                                        },
                                                                                        error: function (jqXHR, textStatus, errorThrown) {
                                                                                            if (jqXHR.status == 404 || errorThrown == 'Not Found') {
                                                                                                $('#promo-modal').modal('show');
                                                                                                $('#promo-modal #lblMessage').html('<h4>Oops something happened , please contact store directly</h4>');

                                                                                                setTimeout(function () {
                                                                                                    $('#promo-modal').modal('hide');
                                                                                                    location.href = "/WelcomePage";
                                                                                                }, 3000);
                                                                                            }
                                                                                        }

                                                                                    });
                                                                                    // $('#loader').hide();
                                                                                    //$(".se-pre-con").hide();
                                                                                });
                                                                        }

                                                                        function attachSigninOrder(element) {
                                                                            if (element == 'undefined')
                                                                                element = document.getElementById('GoogleLoginOrder');
                                                                            auth2.attachClickHandler(element, {},
                                                                                function (googleUser) {

                                                                                    //$(".se-pre-con").show();
                                                                                    $('#loader').show();
                                                                                    console.log(googleUser);
                                                                                    var GPSignIn = 0;
                                                                                    if ($('#GPGuestSignInForward').length > 0) {
                                                                                        GPSignIn = parseInt($('#GPGuestSignInForward').val());
                                                                                    }
                                                                                    var profiles = googleUser.getBasicProfile();
                                                                                    //var ReturnUrl = 'https://localhost:44317/';
                                                                                    //Crate A Bunch Of Object for Search
                                                                                    var objData = {
                                                                                        Email: profiles.getEmail(),
                                                                                        LastName: profiles.getFamilyName(),
                                                                                        FirstName: profiles.getGivenName(),
                                                                                        GoogleID: profiles.getId(),
                                                                                        ProfileURL: profiles.getName(),
                                                                                    };

                                                                                    $.ajax({
                                                                                        type: 'get',
                                                                                        url: '/Index?handler=SaveUser&details=' + profiles.getGivenName() + ' ' + profiles.getFamilyName() + '&email=' + profiles.getEmail() + '&id=' + profiles.getId() + '&LoginSource=Google&IsGP=' + GPSignIn,
                                                                                        data: null,
                                                                                        contentType: 'application/json;charset=utf-8',
                                                                                        headers: { "Accept": "application/json" },
                                                                                        crossDomain: true,
                                                                                        xhrFields: { withCredentials: true },
                                                                                        dataType: 'json',
                                                                                        beforeSend: function (xhr) {
                                                                                            xhr.withCredentials = true;
                                                                                        },
                                                                                        success: function (data) {
                                                                                            $('#loginModalOrder').modal('hide');
                                                                                            LoginProcess = "Google";
                                                                                            window.top.location = "orders";
                                                                                        },
                                                                                        error: function (jqXHR, textStatus, errorThrown) {
                                                                                            if (jqXHR.status == 404 || errorThrown == 'Not Found') {
                                                                                                $('#promo-modal').modal('show');
                                                                                                $('#promo-modal #lblMessage').html('<h4>Oops something happened , please contact store directly</h4>');

                                                                                                setTimeout(function () {
                                                                                                    $('#promo-modal').modal('hide');
                                                                                                    location.href = "/WelcomePage";
                                                                                                }, 3000);
                                                                                            }
                                                                                        }

                                                                                    });
                                                                                    //  $('#loader').hide();
                                                                                    //$(".se-pre-con").hide();
                                                                                });
                                                                        }</script>
                                                                                <script>startAppA();</script>
                                                                                                <script>function UserAddress(Name, Address, lat, lng, locStatus, PostalCode) {
                                                                                                        var Apartmentnumber = "";
                                                                                                        var DropOff = "";
                                                                                                        var Dropopt = "";
                                                                                                        $.ajax({
                                                                                                            type: 'get',
                                                                                                            url: '/Index?handler=UserAddress&Name=' + Name + '&Address=' + Address + '&latitude=' + lat + '&longitude=' + lng + '&Apartmentnumber=' + Apartmentnumber + '&comment=' + DropOff + '&DropOff=' + Dropopt + '&PostalCode=' + PostalCode,
                                                                                                            data: null,
                                                                                                            contentType: 'application/json;charset=utf-8',
                                                                                                            dataType: 'json',

                                                                                                            success: function (data) {
                                                                                                                //$("#AddressName").html(data.name);
                                                                                                                //$("#UserAddress").html(data.address);
                                                                                                                $("#location_trigger").html('');
                                                                                                                $("#location_trigger").html(data.name);
                                                                                                                $("#UserAddressDetails").html('');
                                                                                                                if (locStatus == "Valid") {
                                                                                                                    $("#UserAddressDetails").append('<div class="col-9"><p style = "color: #eb1800; font-size: 18px; line-height: 18px; margin-bottom: 0;margin-left:10px;max-width:120px" ><strong id="AddressName">' + data.name + '</strong><br><span style="color: #eb1800; font-size: 14px;" id="UserAddress">' + data.address + '</span></p></div ><div class="col-2"><i class="fa fa-pencil loc-icon" aria-hidden="true" data-name="' + data.name + '" data-address="' + data.address + '" data-latitude="' + data.latitude + '" data-longitude="' + data.longitude + '" data-dropoff="' + data.dropoff + '" data-Apartmentnumber="' + data.apartmentnumber + '" data-comment="' + data.comment + '" onclick="EditUserAddress(this)"></i></div>');
                                                                                                                }
                                                                                                                else if (locStatus == "NotValid") {
                                                                                                                    $("#UserAddressDetails").append('<div class="col-9"><p style = "color: #eb1800; font-size: 18px; line-height: 18px; margin-bottom: 0;margin-left: 10px;max-width:120px" ><strong id="AddressName">' + data.name + '</strong><br><span style="color: #eb1800; font-size: 14px;" id="UserAddress">' + data.address + '</span></p></div ><div class="col-2"></div>');
                                                                                                                }
                                                                                                            },
                                                                                                            error: function (jqXHR, textStatus, errorThrown) {
                                                                                                                if (jqXHR.status == 404 || errorThrown == 'Not Found') {
                                                                                                                    $('#promo-modal').modal('show');
                                                                                                                    $('#promo-modal #lblMessage').html('<h4>Oops something happened , please contact store directly</h4>');

                                                                                                                    setTimeout(function () {
                                                                                                                        $('#promo-modal').modal('hide');
                                                                                                                        location.href = "/WelcomePage";
                                                                                                                    }, 3000);
                                                                                                                }
                                                                                                            }
                                                                                                        });

                                                                                                    }

                                                                                                    function EditUserAddress(el) {

                                                                                                        var name = $(el).attr('data-name');
                                                                                                        var address = $(el).attr('data-address');
                                                                                                        var latitude = $(el).attr('data-latitude');
                                                                                                        var longitude = $(el).attr('data-longitude');
                                                                                                        var Apartmentnumber = $(el).attr('data-apartmentnumber');
                                                                                                        var Dropoff = $(el).attr('data-dropoff');

                                                                                                        var comment = $(el).attr('data-comment');
                                                                                                        $('.strname').html('');

                                                                                                        $('.strname').html(name);
                                                                                                        $("#eidtUserAddress").html('');
                                                                                                        $("#eidtUserAddress").html(address);
                                                                                                        $("#longitude").val(longitude);
                                                                                                        $("#latitude").val(latitude);
                                                                                                        if (Apartmentnumber != "null") {
                                                                                                            $("#Apartmentnumber").val(Apartmentnumber);
                                                                                                        }
                                                                                                        else {
                                                                                                            $("#Apartmentnumber").val('');
                                                                                                        }
                                                                                                        if (comment != "null") {
                                                                                                            $("#additional_drop_info").val(comment);
                                                                                                        }
                                                                                                        else {
                                                                                                            $("#additional_drop_info").val('');
                                                                                                        }
                                                                                                        if (Dropoff == "Hand it to me") {
                                                                                                            $("#hand").prop("checked", true);
                                                                                                        }
                                                                                                        else if (Dropoff == "Leave it at my door") {
                                                                                                            $("#door").prop("checked", true);
                                                                                                        }
                                                                                                        MapGenerated(name, longitude, latitude);
                                                                                                        $('.map-box').show();
                                                                                                        $('.loction-set .loction-inner').hide();
                                                                                                        //$('.loction-set .loction-inner').hide();
                                                                                                    }

                                                                                                    function MapGenerated(addr, longitude, latitude) {
                                                                                                        $(".map-frame").html('');
                                                                                                        var embed = "<iframe width='100%' height='180'; frameborder='0' style='border:0;' src = 'https://maps.google.com/maps?q=" + encodeURIComponent(latitude) + "," + encodeURIComponent(longitude) + "&amp;output=embed'></iframe>";
                                                                                                        $('.map-frame').html(embed);

                                                                                                    }



                                                                                                    //$(".btnAdjustpin").click(function () {
                                                                                                    //    $(".map-frame").html('');
                                                                                                    //    var longitude =$("#longitude").val();
                                                                                                    //    var latitude= $("#latitude").val();

                                                                                                    //    initializeAdjuct(latitude, longitude);
                                                                                                    //});

                                                                                                    //let map1;
                                                                                                    //let marker2;
                                                                                                    //function initializeAdjuct(Lat,Lng) {

                                                                                                    //    var myLatLng = new google.maps.LatLng(Lat, Lng),
                                                                                                    //        myOptions = {
                                                                                                    //            zoom: 15,
                                                                                                    //            center: myLatLng,
                                                                                                    //            mapTypeId: google.maps.MapTypeId.ROADMAP
                                                                                                    //        },
                                                                                                    //        map1 = new google.maps.Map(document.getElementById('mapframe'),
                                                                                                    //            myOptions);

                                                                                                    //    var image = {
                                                                                                    //        url: 'http://maps.google.com/mapfiles/ms/icons/yellow-dot.png',
                                                                                                    //        scaledSize: new google.maps.Size(70, 70),
                                                                                                    //    };
                                                                                                    //   // ;
                                                                                                    //    var dd = myLatLng;
                                                                                                    //   marker2 = new google.maps.Marker({
                                                                                                    //       position: new google.maps.LatLng(28.6228331, 77.3659138),
                                                                                                    //        map: map1,
                                                                                                    //        icon: image

                                                                                                    //    });

                                                                                                    //    marker2.setMap(map1);
                                                                                                    //    moveBus(map1, marker2);

                                                                                                    //}

                                                                                                    //function moveBus(map, marker) {

                                                                                                    //    marker.setPosition(new google.maps.LatLng(0, 0));
                                                                                                    //    map.panTo(new google.maps.LatLng(0, 0));

                                                                                                    //};</script>
                                                                                                                <script>function CheckLoggedIn() {
                                                                                                                        $.ajax({
                                                                                                                            type: 'get',
                                                                                                                            url: '/Index?handler=CheckUserLoggedin',
                                                                                                                            data: null,
                                                                                                                            contentType: 'application/json;charset=utf-8',
                                                                                                                            dataType: 'json',

                                                                                                                            success: function (data) {

                                                                                                                                if (data == '0') {
                                                                                                                                    $('#loginModalOrder').modal('show');
                                                                                                                                }
                                                                                                                                else {

                                                                                                                                    window.top.location = "orders";

                                                                                                                                }

                                                                                                                            },
                                                                                                                            error: function (jqXHR, textStatus, errorThrown) {
                                                                                                                                if (jqXHR.status == 404 || errorThrown == 'Not Found') {
                                                                                                                                    $('#promo-modal').modal('show');
                                                                                                                                    $('#promo-modal #lblMessage').html('<h4>Oops something happened , please contact store directly</h4>');

                                                                                                                                    setTimeout(function () {
                                                                                                                                        $('#promo-modal').modal('hide');
                                                                                                                                        location.href = "/WelcomePage";
                                                                                                                                    }, 3000);
                                                                                                                                }
                                                                                                                            }
                                                                                                                        });

                                                                                                                    }

                                                                                                                    function fbLoginOrder() {
                                                                                                                        $('#loader').show();
                                                                                                                        FB.login(function (response) {
                                                                                                                            if (response.authResponse) {
                                                                                                                                // Get and display the user profile data
                                                                                                                                LoginProcess = "FB";
                                                                                                                                getFbUserDataOrder();
                                                                                                                            } else {
                                                                                                                                // alert('User cancelled login or did not fully authorize.');
                                                                                                                            }
                                                                                                                        }, { scope: 'email' });
                                                                                                                        $('#loader').hide();
                                                                                                                    }

                                                                                                                    // Fetch the user profile data from facebook

                                                                                                                    function getFbUserDataOrder() {
                                                                                                                        $('#loader').show();
                                                                                                                        var GPSignIn = 0;
                                                                                                                        if ($('#GPGuestSignInForward').length > 0) {
                                                                                                                            GPSignIn = parseInt($('#GPGuestSignInForward').val());
                                                                                                                        }
                                                                                                                        FB.api('/me', { locale: 'en_US', fields: 'id,first_name,last_name,email,link,gender,locale,picture' },
                                                                                                                            function (response) {
                                                                                                                                $('#loader').show();

                                                                                                                                $.ajax({
                                                                                                                                    type: 'get',
                                                                                                                                    url: '/Index?handler=SaveUser&details=' + response.first_name + ' ' + response.last_name + '&email=' + response.email + '&id=' + response.id + '&LoginSource=Facebook&IsGP=' + GPSignIn,
                                                                                                                                    data: null,
                                                                                                                                    contentType: 'application/json;charset=utf-8',
                                                                                                                                    dataType: 'json',

                                                                                                                                    success: function (data) {

                                                                                                                                        if (data == "WELCOME") {
                                                                                                                                            window.top.location = "orders";
                                                                                                                                            $('#loader').hide();
                                                                                                                                        } else if (data == "CHECKOUT") {
                                                                                                                                            window.top.location = "orders";
                                                                                                                                            $('#loader').hide();
                                                                                                                                        }
                                                                                                                                        else {
                                                                                                                                            window.top.location = "orders";
                                                                                                                                            $('#loader').hide();
                                                                                                                                        }

                                                                                                                                    },
                                                                                                                                    error: function (jqXHR, textStatus, errorThrown) {
                                                                                                                                        $('#loader').hide();
                                                                                                                                        if (jqXHR.status == 404 || errorThrown == 'Not Found') {
                                                                                                                                            $('#promo-modal').modal('show');
                                                                                                                                            $('#promo-modal #lblMessage').html('<h4>Oops something happened , please contact store directly</h4>');

                                                                                                                                            setTimeout(function () {
                                                                                                                                                $('#promo-modal').modal('hide');
                                                                                                                                                location.href = "/WelcomePage";
                                                                                                                                            }, 3000);
                                                                                                                                        }
                                                                                                                                    }
                                                                                                                                });

                                                                                                                                //alert('<p>Thanks for logging in, ' + response.first_name + '!</p>');
                                                                                                                                //alert( '<h2>Facebook Profile Details</h2><p><img src="' + response.picture.data.url + '"/></p><p><b>FB ID:</b> ' + response.id + '</p><p><b>Name:</b> ' + response.first_name + ' ' + response.last_name + '</p><p><b>Email:</b> ' + response.email + '</p><p><b>Gender:</b> ' + response.gender + '</p><p><b>FB Profile:</b> <a target="_blank" href="' + response.link + '">click to view profile</a></p>');
                                                                                                                            });
                                                                                                                    }</script>
                                                                                                                                <script>
    function SubmodifiersCheckboxChec(event) {
        ;
        //$(event).parent().closest("div").children().find("input[type='checkbox']").prop('checked', false);
        //$(event).parent().closest("div").children().find("input[type='radio']").prop('checked', false);
        var maxlengval = $(event).attr('data-max');
        //alert(maxlengval);
        var ModifierPrice = $(event).attr('data-price');
        //$(event).attr('data-price');
        var mainItemId = $(event).attr('class').split(' ')[3];

        var ItemId = $(event).attr('data-itmId');

        var qtyId = '#qty_' + mainItemId;
        var qty = parseInt($(qtyId).val()) == 0 ? 1 : parseInt($(qtyId).val());
        var PriceTotal = $("#PriceTotalValue-" + mainItemId).val();
        var CurrencySumbol = $("#CurenceSymbol-" + mainItemId).val();
       // var CurrencySumbol = '$';
        var MofId = $(event).attr('data-ModifyerId');
        var TPrice = $(".ChangePrice-" + mainItemId).text().split(CurrencySumbol);
        PriceTotal = parseFloat(TPrice[1]);

        var PriceCal = 0;
        var numberOfChecked = $('.CheckbocCheckVal-' + ItemId + '-' + MofId + ':checkbox:checked').length;
        if (numberOfChecked <= maxlengval) {
            if (numberOfChecked == maxlengval) {
                $('.CheckbocCheckVal-' + ItemId + '-' + MofId + ':checkbox:not(:checked)').attr("disabled", true);
            }
            else {
                $('.CheckbocCheckVal-' + ItemId + '-' + MofId + ':checkbox:not(:checked)').removeAttr("disabled");
            }
        }
        else {

            $(event).prop('checked', false);

            $('#promo-modal').modal('show');
            $('#lblMessage').html('Only ' + maxlengval + ' Choices Allowed');
            return false;
        }

        //var ModifierPrice = parseFloat(GetModifierPrice(ItemId));
        if ($(event).prop("checked") == true) {

            PriceCal = (parseFloat(PriceTotal)) + parseFloat(ModifierPrice * qty);
        }
        else if ($(event).prop("checked") == false) {

            PriceCal = (parseFloat(PriceTotal) - parseFloat(ModifierPrice * qty));
        }
        //$("#PriceTotalValue-" + ItemId).val(PriceCal.toFixed(2));
        $(".ChangePrice-" + mainItemId).html('');
        $(".ChangePrice-" + mainItemId).html(CurrencySumbol + '' + PriceCal.toFixed(2));
    }

    function SubmodifiersRadioChec(event) {
        var ItemId = $(event).attr('data-itmId');
        var mainItemId = $(event).attr('class').split(' ')[1];
        var CurrencySumbol = $("#CurenceSymbol-" + mainItemId).val();
      //  var CurrencySumbol = '$';
        var qtyId = '#qty_' + mainItemId;
        var qty = parseInt($(qtyId).val()) == 0 ? 1 : parseInt($(qtyId).val());
        var PriceCal = parseFloat($("#PriceTotalValue-" + mainItemId).val()) * qty;

        //var allchcked = document.querySelectorAll('#product_modal-' + ItemId+' input[type="radio"]:checked');
        //for (var i = 0; i < allchcked.length; i++) {
        var TPrice = $(".ChangePrice-" + mainItemId).text().split(CurrencySumbol);
        //PriceCal = parseFloat(TPrice[1]);
        //var ModifierPrice = parseFloat($(event).attr('data-MoPrice'))*qty;
        var ModifierPrice = parseFloat(GetModifierPrice(mainItemId)) * qty;
        PriceCal = (parseFloat(parseFloat(PriceCal) + parseFloat(ModifierPrice)));


        //}
        $(".ChangePrice-" + mainItemId).html('');
        $(".ChangePrice-" + mainItemId).html(CurrencySumbol + '' + PriceCal.toFixed(2));
    }

    function CheckboxChec(event) {
        var submodifierprice = parseFloat("0.00");
        var ItemId = $(event).attr('data-itmId');
        if ($(event).prop("checked") == true) {
            $(event).closest('.form-check').find('.dropdown_item').addClass('open');
            $(event).closest('.form-check').find('.dropdown_items').show();
            $(event).closest('.form-check').find('.dropdown_items').children('.SubModfier').find('.reqmodifier').parent().siblings('.form-check').children().find("input[type='radio']").prop('required', true);
            //if ($(event).closest('.form-check').find('.dropdown_items h4').find('.req').hasClass('reqmodifier')) {
            //    $(event).closest('.form-check').find('.dropdown_items').children().find("input[type='radio']").prop('required', true);
            //}
            //var target = $(event).parent().parent().nextAll('h4:first').children('.req');
           //$(event).parent().parent().nextAll('h4').each(function () {
               // if ($(this).siblings('span').hasClass('.req')) {
                   //target = $(this).siblings('span.req');
                   // return false;
               // }
           // });


            //var modalId = '#product_modal-' + ItemId+ ' .modal-body';
            //$(modalId).animate({
              //  scrollTop: target.offset().top
           // }, 2000);
        }
        else {
            $(event).closest('.form-check').find('.dropdown_item').removeClass('open');
            $(event).closest('.form-check').find('.dropdown_items').hide();
            if ($(event).closest('.form-check').find('.dropdown_items').children().find("input[type='radio']:checked").length > 0) {
                submodifierprice = parseFloat(submodifierprice) + parseFloat($(event).closest('.form-check').find('.dropdown_items').children().find("input[type='radio']:checked").attr('data-price'));

                $(event).closest('.form-check').find('.dropdown_items').find("input[type='radio']").prop('checked', false);
            }
            if ($(event).closest('.form-check').find('.dropdown_items').children().find("input[type='checkbox']:checked").length > 0) {
                if ($(event).closest('.form-check').find('.dropdown_items').children().find("input[type='checkbox']:checked").length == 1) {
                    submodifierprice = parseFloat(submodifierprice) +parseFloat($(event).closest('.form-check').find('.dropdown_items').children().find("input[type='checkbox']:checked").attr('data-price'));
                }
                else {
                    $(event).closest('.form-check').find('.dropdown_items').children().find("input[type='checkbox']:checked").each(function () {
                        submodifierprice = parseFloat(submodifierprice) + parseFloat($(this).attr('data-price'));
                        //alert(submodifiers);
                    });
                }
                $(event).closest('.form-check').find('.dropdown_items').children().find("input[type='checkbox']").prop('checked', false);
                $(event).closest('.form-check').find('.dropdown_items').children().find("input[type='checkbox']").prop('disabled', false);
            }
            if ($(event).closest('.form-check').find('.dropdown_items h4').find('.req').hasClass('reqmodifier')) {
                $(event).closest('.form-check').find('.dropdown_items').children().find("input[type='radio']").prop('required', false);
            }
        }

        var maxlengval = $(event).attr('data-max');
        //alert(maxlengval);
        var ModifierPrice = $(event).attr('data-MoPrice');
        //$(event).attr('data-price');



        var qtyId = '#qty_' + ItemId;
        var qty = parseInt($(qtyId).val()) == 0 ? 1 : parseInt($(qtyId).val());
        var PriceTotal = $("#PriceTotalValue-" + ItemId).val();
        var CurrencySumbol = $("#CurenceSymbol-" + ItemId).val();
        var MofId = $(event).attr('data-ModifyerId');
        var TPrice = $(".ChangePrice-" + ItemId).text().split(CurrencySumbol);
        PriceTotal = parseFloat(TPrice[1]);

        var PriceCal = 0;
        var numberOfChecked = $('.CheckbocCheckVal-' + ItemId + '-' + MofId + ':checkbox:checked').length;
        //alert(numberOfChecked);
        if (numberOfChecked <= maxlengval) {
            if (numberOfChecked == maxlengval) {

                $('.CheckbocCheckVal-' + ItemId + '-' + MofId + ':checkbox:not(:checked)').attr("disabled", true);
                //$('.ModReq-' + ReqId).addClass("fa-check");
            }
            else {

                $('.CheckbocCheckVal-' + ItemId + '-' + MofId + ':checkbox:not(:checked)').removeAttr("disabled");
                //$('.ModReq-' + ReqId).removeClass("fa-check");
            }
        }
        else {

            $(event).prop('checked', false);

            $('#promo-modal').modal('show');
            $('#lblMessage').html('Only ' + maxlengval + ' Choices Allowed');
            return false;
        }
        //var ModifierPrice = parseFloat(GetModifierPrice(ItemId));
        if ($(event).prop("checked") == true) {

            PriceCal = (parseFloat(PriceTotal)) + parseFloat(ModifierPrice * qty);
        }
        else if ($(event).prop("checked") == false) {

            PriceCal = (parseFloat(PriceTotal) - parseFloat(ModifierPrice * qty)) - parseFloat(submodifierprice * qty);
        }
        //$("#PriceTotalValue-" + ItemId).val(PriceCal.toFixed(2));
        $(".ChangePrice-" + ItemId).html('');
        $(".ChangePrice-" + ItemId).html(CurrencySumbol + '' + PriceCal.toFixed(2));
        ScrolltoNextModifierGroup()
    }

    function RadioChec(event) {
        var submodifierprice = parseFloat("0.00");
        if ($(event).closest('.form-check').children('.dropdown_items').length > 0) {

            var attrname = $(event).attr('name');
            $(event).parent().parent().siblings('.form-check').children('.form-check-label').children('[name="' + attrname + '"]').parent().siblings('.dropdown_items').children('.SubModfier').find("input[type='radio']").prop('required', false);
            $(event).parent().parent().siblings('.form-check').children('.form-check-label').children('[name="' + attrname + '"]').parent().siblings('.dropdown_items').children('.SubModfier').find("input[type='checkbox']:checked").prop('checked', false);

            $(event).parent().parent().siblings('.form-check').children('.form-check-label').children('[name="' + attrname + '"]').parent().siblings('.dropdown_items').children('.SubModfier').find("input[type='radio']").prop('checked', false);

            $(event).parent().parent().siblings('.form-check').children('.form-check-label').children('[name="' + attrname + '"]').parent().parent().children('.dropdown_item').removeClass('open');
            $(event).parent().parent().siblings('.form-check').children('.form-check-label').children('[name="' + attrname + '"]').parent().parent().children('.dropdown_items').css('display', 'none');

            if ($(event).closest('.form-check').find('.dropdown_items h4').find('.req').hasClass('reqmodifier')) {
                $(event).closest('.form-check').find('.dropdown_items').children('.SubModfier').find('.reqmodifier').parent().siblings('.form-check').children().find("input[type='radio']").prop('required', true);


            }
            else {
                $(event).closest('.form-check').find('.dropdown_items').children().find("input[type='radio']").prop('required', false);
                $(event).parent().parent().parent().find('.dropdown_items').find("input[type='radio']").prop('checked', false);
                $(event).closest('.form-check').find('.dropdown_items').find("input[type='checkbox']").prop('checked', false);
                $(event).closest('.form-check').find('.dropdown_items').children().find("input[type='checkbox']").prop('disabled', false);
            }
        }
        else {
            if ($(event).parent().parent().find('.dropdown_items').siblings('label').children('input').prop("checked") == false) {
                $(event).parent().parent().find('.dropdown_items').removeClass('open');
                $(event).parent().parent().find('.dropdown_items').hide();
                $(event).parent().parent().find('.dropdown_items').find("input[type='radio']").prop('checked', false);
                $(event).parent().parent().find('.dropdown_items').children().find("input[type='radio']").prop('required', false);
                $(event).parent().parent().find('.dropdown_items').find("input[type='checkbox']").prop('checked', false);
                $(event).closest('.form-check').find('.dropdown_items').children().find("input[type='checkbox']").prop('disabled', false);
            }
            else  {
                //
                var attrname = $(event).attr('name');
                $(event).parent().parent().siblings('.form-check').children('.form-check-label').children('[name="' + attrname + '"]').parent().siblings('.dropdown_items').children('.SubModfier').find("input[type='radio']").prop('required', false);
                $(event).parent().parent().siblings('.form-check').children('.form-check-label').children('[name="' + attrname + '"]').parent().siblings('.dropdown_items').children('.SubModfier').find("input[type='checkbox']:checked").prop('checked', false);
                $(event).parent().parent().siblings('.form-check').children('.form-check-label').children('[name="' + attrname + '"]').parent().siblings('.dropdown_items').children('.SubModfier').find("input[type='radio']").prop('checked', false);

                $(event).parent().parent().siblings('.form-check').children('.form-check-label').children('[name="' + attrname + '"]').parent().parent().children('.dropdown_item').removeClass('open');
                $(event).parent().parent().siblings('.form-check').children('.form-check-label').children('[name="' + attrname + '"]').parent().parent().children('.dropdown_items').css('display', 'none');


            }

        }
        $(event).closest('.form-check').find('.dropdown_item').addClass('open');
        $(event).closest('.form-check').find('.dropdown_items').show();

        var ItemId = $(event).attr('data-itmId');
        var CurrencySumbol = $("#CurenceSymbol-" + ItemId).val();
        var qtyId = '#qty_' + ItemId;
        var qty = parseInt($(qtyId).val()) == 0 ? 1 : parseInt($(qtyId).val());
        var PriceCal = parseFloat($("#PriceTotalValue-" + ItemId).val()) * qty;

        var TPrice = $(".ChangePrice-" + ItemId).text().split(CurrencySumbol);
        var ModifierPrice1 = parseFloat($(event).attr('data-MoPrice')) * qty;

        var ModifierPrice = parseFloat(GetModifierPrice(ItemId)) * qty;
        PriceCal = (parseFloat(parseFloat(PriceCal) + parseFloat(ModifierPrice)));
        $(".ChangePrice-" + ItemId).html('');
        $(".ChangePrice-" + ItemId).html(CurrencySumbol + '' + PriceCal.toFixed(2));
        ScrolltoNextModifierGroup();
    }

    function ScrolltoNextModifierGroup()
    {
        var flag = false;
        outerloop:
        $(".modifierGroup").each(function (index) {
            var modifierid = $(this).attr('id');
            if ($(this).children('span').hasClass('req')) {

               // $($(this).parent().children('.form-check')).each(function (index) {
                if ($(this).parent().children().find("input[type=radio]:checked").length > 0) {
                        flag = false;


                    }
                else if ($(this).parent().children().find("input[type=checkbox]:checked").length > 0) {
                        flag = false;

                    }
                    else {
                        flag = true;
                        const element = document.getElementById(modifierid);
                        element.scrollIntoView({  behavior: "smooth" });

                    }
                    //return false;
               // });
            }
            if (flag == true) {
                return false;
            }

        });
    }
    //function RadioChec(event) {

    //    var ModifiyerPrice = $(event).attr('data-MoPrice');
    //    if (ModifiyerPrice != "0.00") {
    //        //$(event).attr('data-price');
    //        var ItemId = $(event).attr('data-itmId');
    //        var PriceTotal = $("#PriceTotalValue-" + ItemId).val();
    //        var PriceTotal1 = $("#TotalPriceValue-" + ItemId).val();
    //        var CurrencySumbol = $("#CurenceSymbol-" + ItemId).val();
    //        var MofId = $(event).attr('data-ModifyerId');
    //        var Name = $("#ModifeName-" + ItemId).val();
    //        var OldPriceValu = $("#ModiferPriceValue-" + ItemId + "-" + MofId).val();
    //        var TotalMTotal = $("#TotalModiferPriceValue-" + ItemId).val();
    //        //TotalMTotal = $("#TotalModiferPriceValue-" + ItemId).val(ModifiyerPrice)[0].value;
    //        if (MofId == Name) {

    //            $("#TotalModiferPriceValue-" + ItemId).val(ModifiyerPrice);

    //            TotalMTotal = parseFloat(ModifiyerPrice);
    //            //if (PriceTotal != "0.00") {
    //            var TotalMTotal1 = $("#TotalModiferPriceValue1-" + ItemId).val(); //(parseFloat(PriceTotal) - parseFloat(OldPriceValu));
    //            // $("#ModiferPriceValue-" + ItemId + "-" + MofId).val(TotalMTotal1);
    //            TotalMTotal = (parseFloat(TotalMTotal1) + parseFloat(TotalMTotal) + parseFloat(PriceTotal1));
    //            //}
    //            //else {
    //            //var TotalMTotal1 = $("#TotalModiferPriceValue1-" + ItemId).val();
    //            //TotalMTotal = (parseFloat(TotalMTotal1) + parseFloat(TotalMTotal) + parseFloat(PriceTotal));
    //            //}
    //            //else {
    //            $("#ModiferPriceValue-" + ItemId + "-" + MofId).val(TotalMTotal);
    //            //}
    //        }
    //        else {

    //            TotalMTotal = (parseFloat(TotalMTotal) + parseFloat(ModifiyerPrice) + parseFloat(PriceTotal1));
    //            $("#TotalModiferPriceValue1-" + ItemId).val(ModifiyerPrice);
    //        }

    //        var PriceCal = 0;

    //        if ($(event).prop("checked") == true) {
    //            PriceCal = parseFloat(TotalMTotal);


    //        }
    //        //else if ($(event).prop("checked") == false) {

    //        //    PriceCal = (parseFloat(OldPriceValu) - parseFloat(ModifiyerPrice));

    //        //}
    //        $("#PriceTotalValue-" + ItemId).val(PriceCal.toFixed(2));
    //        $(".ChangePrice-" + ItemId).html('');
    //        $(".ChangePrice-" + ItemId).html(CurrencySumbol + '' + PriceCal.toFixed(2));
    //    }
    //    else {
    //        var ItemId = $(event).attr('data-itmId');
    //        var PriceTotal = $("#PriceTotalValue-" + ItemId).val();
    //        var PriceTotal1 = $("#TotalPriceValue-" + ItemId).val();
    //        var CurrencySumbol = $("#CurenceSymbol-" + ItemId).val();
    //        var MofId = $(event).attr('data-ModifyerId');
    //        var Name = $("#ModifeName-" + ItemId).val();
    //        var OldPriceValu = $("#ModiferPriceValue-" + ItemId + "-" + MofId).val();
    //        var TotalMTotal = $("#TotalModiferPriceValue-" + ItemId).val();

    //            $("#TotalModiferPriceValue-" + ItemId).val(ModifiyerPrice);

    //            TotalMTotal = parseFloat(ModifiyerPrice);

    //            var TotalMTotal1 = $("#TotalModiferPriceValue1-" + ItemId).val(); //(parseFloat(PriceTotal) - parseFloat(OldPriceValu));

    //            TotalMTotal = (parseFloat(TotalMTotal1) + parseFloat(TotalMTotal) + parseFloat(PriceTotal1));

    //            $("#ModiferPriceValue-" + ItemId + "-" + MofId).val(TotalMTotal);

    //        var PriceCal = 0;
    //        var PriceCal = 0;

    //        if ($(event).prop("checked") == true) {
    //            PriceCal = parseFloat(TotalMTotal);


    //        }
    //        //else if ($(event).prop("checked") == false) {

    //        //    PriceCal = (parseFloat(OldPriceValu) - parseFloat(ModifiyerPrice));

    //        //}
    //        $("#PriceTotalValue-" + ItemId).val(PriceCal.toFixed(2));
    //        $(".ChangePrice-" + ItemId).html('');
    //        $(".ChangePrice-" + ItemId).html(CurrencySumbol + '' + PriceCal.toFixed(2));
    //    }
    //}
                                                                                                                                </script>
                                                                                                                                                <script>if (performance.navigation.type == 2) {
                                                                                                                                                        //alert("Back button clicked");
                                                                                                                                                        location.reload();
                                                                                                                                                    }</script>
                                                                                                                                                                <script>//window.onload = function () {
                                                                                                                                                                    //    var sessionExists = CheckForSession();
                                                                                                                                                                    //    if (!sessionExists) {
                                                                                                                                                                    //        location.href = "/welcomepage";
                                                                                                                                                                    //    }

                                                                                                                                                                    //}

                                                                                                                                                                    window.onload = function () {
                                                                                                                                                                        var sessionExists = CheckForSession();
                                                                                                                                                                        if (!sessionExists) {
                                                                                                                                                                            location.href = "/welcomepage";
                                                                                                                                                                        }

                                                                                                                                                                    }

                                                                                                                                                                    function CheckForSession() {
                                                                                                                                                                        var userInSession = false;
                                                                                                                                                                        $.ajax({
                                                                                                                                                                            url: "/index?handler=CheckSession",
                                                                                                                                                                            type: 'GET',
                                                                                                                                                                            dataType: 'json',
                                                                                                                                                                            contentType: 'application/json; charset=utf-8',
                                                                                                                                                                            async: false,
                                                                                                                                                                            success: function (result) {
                                                                                                                                                                                userInSession = result;
                                                                                                                                                                            }
                                                                                                                                                                        });
                                                                                                                                                                        return userInSession;
                                                                                                                                                                    }</script>
                                                                                                                                                                                <script type="text/javascript">var idleTime = 0;

                                                                                                                                                                                    function GetModifierPrice(ItemId) {
                                                                                                                                                                                        var allchcked = document.querySelectorAll('#product_modal-' + ItemId + ' input[type="radio"]:checked');

                                                                                                                                                                                        var allchckedCheckBox = document.querySelectorAll('#product_modal-' + ItemId + ' input[type="checkbox"]:checked');
                                                                                                                                                                                        var ModifierPrice = 0;
                                                                                                                                                                                        // alert(allchcked.length);
                                                                                                                                                                                        if (allchcked.length > 0) {

                                                                                                                                                                                            for (var i = 0; i < allchcked.length; i++) {
                                                                                                                                                                                                ModifierPrice += parseFloat(allchcked[i].attributes[5].value);

                                                                                                                                                                                            }
                                                                                                                                                                                        }
                                                                                                                                                                                        if (allchckedCheckBox.length > 0) {

                                                                                                                                                                                            for (var i = 0; i < allchckedCheckBox.length; i++) {
                                                                                                                                                                                                ModifierPrice += parseFloat(allchckedCheckBox[i].attributes[2].value);

                                                                                                                                                                                            }
                                                                                                                                                                                        }
                                                                                                                                                                                        return ModifierPrice;

                                                                                                                                                                                    }
                                                                                                                                                                                    var IsIframeIdle = false;
                                                                                                                                                                                    function timerIncrement() {
                                                                                                                                                                                        idleTime = idleTime + 1;
                                                                                                                                                                                        var InSession = CheckForSession();
                                                                                                                                                                                        if (InSession == true) {
                                                                                                                                                                                            if (idleTime >= 5) {
                                                                                                                                                                                                if (IsIframeIdle) {
                                                                                                                                                                                                    IsIframeIdle = false;
                                                                                                                                                                                                    $('#iframe_holder').modal('hide');
                                                                                                                                                                                                    $(".auth_net").removeClass('paymentSelected')
                                                                                                                                                                                                    $('#promo-modal').modal('show');
                                                                                                                                                                                                    $('#promo-modal #lblMessage').html('<h4>Payment timed out.</h4>');
                                                                                                                                                                                                    //setTimeout(function () { $('#loader').show();location.reload(); }, 2000);
                                                                                                                                                                                                }
                                                                                                                                                                                            }
                                                                                                                                                                                            if (idleTime == 14) { // 16 minutes

                                                                                                                                                                                                $('#promo-modal').modal('show');
                                                                                                                                                                                                $('#promo-modal #lblMessage').html('<h4>Your session is about to expire in 4 minutes.</h4>');

                                                                                                                                                                                            }
                                                                                                                                                                                            else if (idleTime == 15) { // 16 minutes

                                                                                                                                                                                                $('#promo-modal #lblMessage').html('<h4>Your session is about to expire in 3 minutes.</h4>');

                                                                                                                                                                                            }
                                                                                                                                                                                            else if (idleTime == 16) {

                                                                                                                                                                                                $('#promo-modal #lblMessage').html('<h4>Your session is about to expire in 2 minutes.</h4>');
                                                                                                                                                                                            }
                                                                                                                                                                                            else if (idleTime == 17) { // 16 minutes

                                                                                                                                                                                                $('#promo-modal #lblMessage').html('<h4>Your session is about to expire in less than a minute.</h4>');

                                                                                                                                                                                            }
                                                                                                                                                                                            else if (idleTime == 18) { // 19 minutes

                                                                                                                                                                                                location.href = "/welcomepage";
                                                                                                                                                                                            }
                                                                                                                                                                                            else if (idleTime == 20) { // 20 minutes
                                                                                                                                                                                                location.href = "/welcomepage";
                                                                                                                                                                                            }
                                                                                                                                                                                        }
                                                                                                                                                                                        else {
                                                                                                                                                                                            location.href = "/welcomepage";
                                                                                                                                                                                            //location.href = "/" + InSession;

                                                                                                                                                                                        }




                                                                                                                                                                                    }

                                                                                                                                                                                    function timerIncrementWelcome() {
                                                                                                                                                                                        idleTime = idleTime + 1;
                                                                                                                                                                                        var InSession = CheckForSession();
                                                                                                                                                                                        if (InSession == true) {

                                                                                                                                                                                            if (idleTime == 14) { // 16 minutes
                                                                                                                                                                                                location.href = "/welcomepage";
                                                                                                                                                                                            }
                                                                                                                                                                                        }

                                                                                                                                                                                    }

                                                                                                                                                                                    function CalcPlus(itemId, price, currency) {

                                                                                                                                                                                        var qtyId = '#qty_' + itemId;
                                                                                                                                                                                        var priceId = '.ChangePrice-' + itemId;
                                                                                                                                                                                        var qty = parseInt($(qtyId).val());
                                                                                                                                                                                        var itempriceId = '#PriceTotalValue-' + itemId;
                                                                                                                                                                                        var price = parseFloat($(itempriceId).val());
                                                                                                                                                                                        var ModifierPrice = parseFloat(GetModifierPrice(itemId));
                                                                                                                                                                                        //var itemqty = $('#qty_' + itemId).val();
                                                                                                                                                                                        var TotalPrice = 0;
                                                                                                                                                                                        if (qty <= 0) {
                                                                                                                                                                                            $(qtyId).val(1);
                                                                                                                                                                                        }
                                                                                                                                                                                        else if (qty == 99) {

                                                                                                                                                                                            TotalPrice = (99 * price) + (99 * ModifierPrice);
                                                                                                                                                                                            $(priceId).html(currency + '' + TotalPrice.toFixed(2));
                                                                                                                                                                                        }
                                                                                                                                                                                        //if (itemqty > 98) {
                                                                                                                                                                                        //     $('#promo-modal').modal('show');
                                                                                                                                                                                        //    $('#promo-modal #lblMessage').html('<h4>Item quantity reached max limit!</h4>');
                                                                                                                                                                                        //    $('#qty_' + itemId).val(1);
                                                                                                                                                                                        //     return false;
                                                                                                                                                                                        // }
                                                                                                                                                                                        if (qty == 0) {
                                                                                                                                                                                            //$(qtyId).val(1);




                                                                                                                                                                                        } else if (qty != 99) {
                                                                                                                                                                                            $(qtyId).val(qty++);
                                                                                                                                                                                            TotalPrice = (qty * price) + (ModifierPrice * qty);

                                                                                                                                                                                            $(priceId).html(currency + '' + TotalPrice.toFixed(2));
                                                                                                                                                                                        }

                                                                                                                                                                                    }
                                                                                                                                                                                    function CalcMinus(itemId, price, currency) {
                                                                                                                                                                                        var qtyId = '#qty_' + itemId;
                                                                                                                                                                                        var priceId = '.ChangePrice-' + itemId;
                                                                                                                                                                                        var qty = parseInt($(qtyId).val()) == 0 ? 1 : parseInt($(qtyId).val());
                                                                                                                                                                                        var itempriceId = '#PriceTotalValue-' + itemId;
                                                                                                                                                                                        var price = parseFloat($(itempriceId).val());
                                                                                                                                                                                        var ModifierPrice = parseFloat(GetModifierPrice(itemId));
                                                                                                                                                                                        //var itemqty =$('#qty_' + itemId).val();
                                                                                                                                                                                        var TotalPrice = 0;
                                                                                                                                                                                        if (qty <= 0 || qty != '' || qty != 'undefined') {
                                                                                                                                                                                            $(qtyId).val(1);
                                                                                                                                                                                        }
                                                                                                                                                                                        //if (itemqty > 100) {
                                                                                                                                                                                        //     $('#promo-modal').modal('show');
                                                                                                                                                                                        //    $('#promo-modal #lblMessage').html('<h4>Item quantity reached max limit!</h4>');
                                                                                                                                                                                        //    $('#qty_' + itemId).val(1);
                                                                                                                                                                                        //     return false;
                                                                                                                                                                                        // }
                                                                                                                                                                                        if (qty == 0) {
                                                                                                                                                                                            if (qty != 1) qty = qty--;
                                                                                                                                                                                            $(qtyId).val(qty);
                                                                                                                                                                                            $(priceId).html(currency + '' + '0');
                                                                                                                                                                                        } else {
                                                                                                                                                                                            if (qty != 1) $(qtyId).val(qty--);
                                                                                                                                                                                            TotalPrice = (qty * price) + (ModifierPrice * qty);

                                                                                                                                                                                            $(priceId).html(currency + '' + TotalPrice.toFixed(2));
                                                                                                                                                                                        }

                                                                                                                                                                                    }
                                                                                                                                                                                    function CheckValue(qty, itemId, curr) {
                                                                                                                                                                                        var qtyId = '#qty_' + itemId;
                                                                                                                                                                                        if (qty.trim() == '') {
                                                                                                                                                                                            qty = 1;
                                                                                                                                                                                            $(qtyId).val(1);
                                                                                                                                                                                        }
                                                                                                                                                                                        else if (qty % 1 != 0) {
                                                                                                                                                                                            qty = parseInt(qty);
                                                                                                                                                                                            $(qtyId).val(qty);
                                                                                                                                                                                        }

                                                                                                                                                                                        if (qty <= 0 || qty % 1 != 0) {
                                                                                                                                                                                            $(qtyId).val(1);
                                                                                                                                                                                        }
                                                                                                                                                                                        //else if (qty == 99)
                                                                                                                                                                                        //{
                                                                                                                                                                                        //    var qtyId = '#qty_' + itemId;
                                                                                                                                                                                        //    $(qtyId).val(99);
                                                                                                                                                                                        //    var ModifierPrice = parseFloat(GetModifierPrice(itemId) * qty);
                                                                                                                                                                                        //    var Tprice = '.ChangePrice-' + itemId;
                                                                                                                                                                                        //    var MIprice = '#PriceTotalValue-' + itemId;
                                                                                                                                                                                        //    var MIpriceVal = parseFloat($(MIprice).val());
                                                                                                                                                                                        //    var TpriceVal = parseFloat(MIpriceVal * parseFloat(qty)) + ModifierPrice;
                                                                                                                                                                                        //    $(Tprice).html(curr + '' + parseFloat(TpriceVal).toFixed(2));
                                                                                                                                                                                        //}
                                                                                                                                                                                        else {
                                                                                                                                                                                            var ModifierPrice = parseFloat(GetModifierPrice(itemId) * qty);
                                                                                                                                                                                            var Tprice = '.ChangePrice-' + itemId;
                                                                                                                                                                                            var MIprice = '#PriceTotalValue-' + itemId;
                                                                                                                                                                                            var MIpriceVal = parseFloat($(MIprice).val());
                                                                                                                                                                                            var TpriceVal = parseFloat(MIpriceVal * parseFloat(qty)) + ModifierPrice;
                                                                                                                                                                                            $(Tprice).html(curr + '' + parseFloat(TpriceVal).toFixed(2));
                                                                                                                                                                                        }
                                                                                                                                                                                    }
                                                                                                                                                                                    //$('#btn_Welcomereset').click(function () {
                                                                                                                                                                                    //    alert('true');
                                                                                                                                                                                    //});</script>
                                                                                                                                                                                                <script>var activeslotid;
                                                                                                                                                                                                    //This is for future Order Timings
                                                                                                                                                                                                    function ShowThisDaySlot(Day) {
                                                                                                                                                                                                        var CountSlot = 0;

                                                                                                                                                                                                        $.each($('[id^="Date-"]'), function () {
                                                                                                                                                                                                            var Id = $(this).attr('id');
                                                                                                                                                                                                            var DayName = Id.split('-');
                                                                                                                                                                                                            if (activeslotid == undefined) {
                                                                                                                                                                                                                activeslotid = $(this).find('.active').attr('slotno');
                                                                                                                                                                                                            }
                                                                                                                                                                                                            if (DayName[1] == Day) {

                                                                                                                                                                                                                $(this).css('display', '');
                                                                                                                                                                                                                CountSlot++;

                                                                                                                                                                                                            } else {

                                                                                                                                                                                                                $(this).css('display', 'none');
                                                                                                                                                                                                            }
                                                                                                                                                                                                        });
                                                                                                                                                                                                        var d = new Date();

                                                                                                                                                                                                        if (CountSlot == 0 && Day != d.getDate() && Day > d.getDate()) {

                                                                                                                                                                                                            $('#ClosedStoreForDay').remove();
                                                                                                                                                                                                            $('#ClosedStore').hide();
                                                                                                                                                                                                            $('.asap').hide();
                                                                                                                                                                                                            $('.sch_later').hide();

                                                                                                                                                                                                            $('.schld-ul').append('<li class="active" id="ClosedStoreForDay" onclick="javascript: return false">Order Closed for ' + Day + '</li>')
                                                                                                                                                                                                        }
                                                                                                                                                                                                        else {
                                                                                                                                                                                                            $('.sch_later').show();
                                                                                                                                                                                                            $('#ClosedStoreForDay').remove();
                                                                                                                                                                                                        }

                                                                                                                                                                                                    }
                                                                                                                                                                                                    $(document).on('click', '.selDate', function () {
                                                                                                                                                                                                        var id = $(this).attr('id');
                                                                                                                                                                                                        if ($('#ClosedStore').length > 0) {
                                                                                                                                                                                                            if (id == "today") {
                                                                                                                                                                                                                $('#ClosedStore').show();

                                                                                                                                                                                                            } else {
                                                                                                                                                                                                                $('#ClosedStore').hide();
                                                                                                                                                                                                            }
                                                                                                                                                                                                        }
                                                                                                                                                                                                        if (id == "today") {
                                                                                                                                                                                                            $('.asap').show();
                                                                                                                                                                                                            $('#schdl-collapser').addClass('show');
                                                                                                                                                                                                        } else {
                                                                                                                                                                                                            $('.asap').hide();
                                                                                                                                                                                                        }
                                                                                                                                                                                                        $.each($('.selDate'), function () {
                                                                                                                                                                                                            if ($(this).attr('id') == id) {
                                                                                                                                                                                                                $(this).addClass('active');
                                                                                                                                                                                                            }
                                                                                                                                                                                                            else if ($(this).hasClass('active')) {
                                                                                                                                                                                                                $(this).removeClass('active');
                                                                                                                                                                                                            }
                                                                                                                                                                                                        });
                                                                                                                                                                                                        if (activeslotid != undefined) {
                                                                                                                                                                                                            $("[slotno=" + activeslotid + "]").addClass('active');

                                                                                                                                                                                                        }
                                                                                                                                                                                                        activeslotid = undefined;
                                                                                                                                                                                                    });
                                                                                                                                                                                                    function WordCount(id) {
                                                                                                                                                                                                        var instrId = '#instr_' + id;
                                                                                                                                                                                                        var value = $(instrId).val();

                                                                                                                                                                                                        if (value.length > 32) {
                                                                                                                                                                                                            return false;
                                                                                                                                                                                                        }
                                                                                                                                                                                                        else {
                                                                                                                                                                                                            var remain = 32 - (parseInt(value.length));

                                                                                                                                                                                                            $('#wordCount').html(remain);
                                                                                                                                                                                                        }
                                                                                                                                                                                                    }</script>
                                                                                                                                                                                                                <script>
    $(document).ready(function () {
        var s1 = document.createElement("script");
        var s2 = document.createElement("script");
        s1.src = GetAnalyticsUrl();
        s2.text = GetAnalyticsCode();
        $("head").append(s1);
        $("head").append(s2);
        var currency = '$';

    });
                                                                                                                                                                                                                </script>
                                                                                                                                                                                                                                <script>function GetIEVersion() {

                                                                                                                                                                                                                                        var sAgent = window.navigator.userAgent;
                                                                                                                                                                                                                                        var Idx = sAgent.indexOf("MSIE");
                                                                                                                                                                                                                                        var Idx2 = navigator.appVersion.indexOf("Edg");

                                                                                                                                                                                                                                        // If IE, return version number.
                                                                                                                                                                                                                                        if (Idx > 0)
                                                                                                                                                                                                                                            return parseInt(sAgent.substring(Idx + 5, sAgent.indexOf(".", Idx)));
                                                                                                                                                                                                                                        // If IE 11 then look for Updated user agent string.
                                                                                                                                                                                                                                        else if (!!navigator.userAgent.match(/Trident\/7./))
                                                                                                                                                                                                                                            return 11;
                                                                                                                                                                                                                                        else if (Idx2 > 0)
                                                                                                                                                                                                                                            return 0;
                                                                                                                                                                                                                                        else
                                                                                                                                                                                                                                            return 0; //It is not IE
                                                                                                                                                                                                                                    }
                                                                                                                                                                                                                                    $(document).ready(function () {
                                                                                                                                                                                                                                        if (GetIEVersion() > 0) {
                                                                                                                                                                                                                                            alert("For best experience, browse the site on Chrome and Mozilla browsers.");
                                                                                                                                                                                                                                        }
                                                                                                                                                                                                                                    });

                                                                                                                                                                                                                                    $("#btn_Cancelstartover").on('click', function () {
                                                                                                                                                                                                                                        $('#paypal-modal').modal('hide');
                                                                                                                                                                                                                                    });
                                                                                                                                                                                                                                    $("#btn_Canceltakeaway").on('click', function () {
                                                                                                                                                                                                                                        $('#delivery-modal').modal('hide');
                                                                                                                                                                                                                                        if ($('#deliveryPrompt-modal').is(':visible')) {
                                                                                                                                                                                                                                            $('#deliveryPrompt-modal').modal('hide');
                                                                                                                                                                                                                                        }
                                                                                                                                                                                                                                        $('#address').val('');
                                                                                                                                                                                                                                    });

                                                                                                                                                                                                                                    $('#btn_redirectallstore,#btn_changestore').click(function () {

                                                                                                                                                                                                                                        $('#loader').show();

                                                                                                                                                                                                                                        $('#PickupromptModal').modal('hide');
                                                                                                                                                                                                                                        $('#ChangeStore-Modal').modal('hide');

                                                                                                                                                                                                                                        window.location = '/AllStore';
                                                                                                                                                                                                                                    });

                                                                                                                                                                                                                                    //btn_changestore</script>
                                                                                                                                                                                                                                                <script>function ShowCheckout() {
                                                                                                                                                                                                                                                        //$('#pay-modal').modal('show');
                                                                                                                                                                                                                                                        //$('#lblPayMessage').html('<h4>Please pay at counter.</h4>');
                                                                                                                                                                                                                                                        //$.ajax({
                                                                                                                                                                                                                                                        //    type: 'get',
                                                                                                                                                                                                                                                        //    url: '/Index?handler=CheckForUpsell',
                                                                                                                                                                                                                                                        //    data: null,
                                                                                                                                                                                                                                                        //    contentType: 'application/json;charset=utf-8',
                                                                                                                                                                                                                                                        //    dataType: 'json',
                                                                                                                                                                                                                                                        //    success: function (data) {

                                                                                                                                                                                                                                                        //    }
                                                                                                                                                                                                                                                        //});
                                                                                                                                                                                                                                                        //setTimeout(function () { location.href = "/Confirmation"; }, 3000);
                                                                                                                                                                                                                                                        LoginDineincheckout();
                                                                                                                                                                                                                                                    }
                                                                                                                                                                                                                                                    function LoginDineincheckout() {
                                                                                                                                                                                                                                                        $('#loader').show();
                                                                                                                                                                                                                                                        $.ajax({
                                                                                                                                                                                                                                                            type: 'get',
                                                                                                                                                                                                                                                            url: '/Checkout?handler=CheckIsExist',
                                                                                                                                                                                                                                                            data: null,
                                                                                                                                                                                                                                                            contentType: 'application/json;charset=utf-8',
                                                                                                                                                                                                                                                            dataType: 'json',

                                                                                                                                                                                                                                                            success: function (data) {
                                                                                                                                                                                                                                                                // ;
                                                                                                                                                                                                                                                                if (data == '0') {
                                                                                                                                                                                                                                                                    $('#loader').hide();
                                                                                                                                                                                                                                                                    $('#CheckoutloginModal').modal('show');
                                                                                                                                                                                                                                                                }
                                                                                                                                                                                                                                                                else if (data == 'Not found') {
                                                                                                                                                                                                                                                                    $('#loader').hide();
                                                                                                                                                                                                                                                                    $('#Checkclose-modal').modal('show');
                                                                                                                                                                                                                                                                    $('#pay-modal .Dinein-close').hide();
                                                                                                                                                                                                                                                                    $('body').css('z-index', 999999);
                                                                                                                                                                                                                                                                }
                                                                                                                                                                                                                                                                else if (data == 'Partial Payment') {
                                                                                                                                                                                                                                                                    $('#loader').hide();
                                                                                                                                                                                                                                                                    $('#Phonenumber_Modal').modal('show');
                                                                                                                                                                                                                                                                    $('.hideforcheckout').hide();
                                                                                                                                                                                                                                                                    $('#btn_getcheckDetails').hide();
                                                                                                                                                                                                                                                                    $('#btn_SavePhoneNumber').hide();
                                                                                                                                                                                                                                                                    $('#btn_RedirectQRCode').show();
                                                                                                                                                                                                                                                                    $('#Phonenumber_Modal #lbl_error').html('Check is already tendered, Please contact staff!');
                                                                                                                                                                                                                                                                }
                                                                                                                                                                                                                                                                //location.href = "/SignIn";
                                                                                                                                                                                                                                                                else {
                                                                                                                                                                                                                                                                    window.top.location = "checkout";
                                                                                                                                                                                                                                                                }



                                                                                                                                                                                                                                                            },
                                                                                                                                                                                                                                                            error: function (jqXHR, textStatus, errorThrown) {
                                                                                                                                                                                                                                                                if (jqXHR.status == 404 || errorThrown == 'Not Found') {
                                                                                                                                                                                                                                                                    $('#promo-modal').modal('show');
                                                                                                                                                                                                                                                                    $('#promo-modal #lblMessage').html('<h4>Oops something happened , please contact store directly</h4>');

                                                                                                                                                                                                                                                                    setTimeout(function () {
                                                                                                                                                                                                                                                                        $('#promo-modal').modal('hide');
                                                                                                                                                                                                                                                                        location.href = "/WelcomePage";
                                                                                                                                                                                                                                                                    }, 3000);
                                                                                                                                                                                                                                                                }
                                                                                                                                                                                                                                                            }

                                                                                                                                                                                                                                                        });

                                                                                                                                                                                                                                                    }
                                                                                                                                                                                                                                                    function UserSaveDeliveryAddress(Name, Address, lat, lng, locStatus, PostalCode) {
                                                                                                                                                                                                                                                        $('#loader').show();
                                                                                                                                                                                                                                                        var Apartmentnumber = "";
                                                                                                                                                                                                                                                        var DropOff = "";
                                                                                                                                                                                                                                                        var Dropopt = "";
                                                                                                                                                                                                                                                        $.ajax({
                                                                                                                                                                                                                                                            type: 'get',
                                                                                                                                                                                                                                                            url: '/Index?handler=UserAddress&Name=' + Name + '&Address=' + Address + '&latitude=' + lat + '&longitude=' + lng + '&Apartmentnumber=' + Apartmentnumber + '&comment=' + DropOff + '&DropOff=' + Dropopt + '&PostalCode=' + PostalCode,
                                                                                                                                                                                                                                                            data: null,
                                                                                                                                                                                                                                                            contentType: 'application/json;charset=utf-8',
                                                                                                                                                                                                                                                            dataType: 'json',

                                                                                                                                                                                                                                                            success: function (data) {
                                                                                                                                                                                                                                                                //alert(data.PostalCode);
                                                                                                                                                                                                                                                                $('#input_useraddress').html(Name + ',' + Address);
                                                                                                                                                                                                                                                                $('.div_editaddr').show();
                                                                                                                                                                                                                                                                $('#div_inputaddress').hide();
                                                                                                                                                                                                                                                                $('#div_notfound').hide();
                                                                                                                                                                                                                                                                $('#div_storeoffline').hide();
                                                                                                                                                                                                                                                                $('#loader').hide();
                                                                                                                                                                                                                                                                $('#hd_mainaddr').val(data.name);
                                                                                                                                                                                                                                                                $('#hd_secondaryaddr').val(data.address);
                                                                                                                                                                                                                                                                $('#hd_lat').val(data.latitude);
                                                                                                                                                                                                                                                                $('#hd_long').val(data.longitude);
                                                                                                                                                                                                                                                                $('#hd_postalcode').val(PostalCode);
                                                                                                                                                                                                                                                                //$('#hd_mainaddr').val();

                                                                                                                                                                                                                                                                //address + '" data-latitude="' + data.latitude + '" data-longitude="' + data.longitude + '" data-dropoff="' + data.dropoff + '" data-Apartmentnumber="' + data.apartmentnumber + '" data-comment="' + data.comment + '" onclick="EditUserAddress(this)"></i></div>');
                                                                                                                                                                                                                                                                //window.location = "/index?Ordertype=" + ordertype;
                                                                                                                                                                                                                                                                //window.location.reload();

                                                                                                                                                                                                                                                            },
                                                                                                                                                                                                                                                            error: function (jqXHR, textStatus, errorThrown) {
                                                                                                                                                                                                                                                                if (jqXHR.status == 404 || errorThrown == 'Not Found') {
                                                                                                                                                                                                                                                                    $('#promo-modal').modal('show');
                                                                                                                                                                                                                                                                    $('#promo-modal #lblMessage').html('<h4>Oops something happened , please contact store directly</h4>');

                                                                                                                                                                                                                                                                    setTimeout(function () {
                                                                                                                                                                                                                                                                        $('#promo-modal').modal('hide');
                                                                                                                                                                                                                                                                        location.href = "/WelcomePage";
                                                                                                                                                                                                                                                                    }, 3000);
                                                                                                                                                                                                                                                                }
                                                                                                                                                                                                                                                            }
                                                                                                                                                                                                                                                        });

                                                                                                                                                                                                                                                    }

                                                                                                                                                                                                                                                    $(document).on('click', '#btn_redirectstore, #btn_redirectstoreII', function () {
                                                                                                                                                                                                                                                        $('#loader').show();
                                                                                                                                                                                                                                                        //$('#deliveryaddressmodal').modal('hide');

                                                                                                                                                                                                                                                        window.location = '/AllStore';
                                                                                                                                                                                                                                                    });

                                                                                                                                                                                                                                                    function showAddressdetail(Name, Address, lat, lng, locStatus, PostalCode) {
                                                                                                                                                                                                                                                        $('#input_useraddress').html(Name + ',' + Address);
                                                                                                                                                                                                                                                        $('.div_editaddr').show();
                                                                                                                                                                                                                                                        $('#div_inputaddress').hide();
                                                                                                                                                                                                                                                        $('#div_notfound').hide();
                                                                                                                                                                                                                                                        $('#div_storeoffline').hide();
                                                                                                                                                                                                                                                        $('#loader').hide();
                                                                                                                                                                                                                                                        $('#hd_mainaddr').val(Name);
                                                                                                                                                                                                                                                        $('#hd_secondaryaddr').val(Address);
                                                                                                                                                                                                                                                        $('#hd_lat').val(lat);
                                                                                                                                                                                                                                                        $('#hd_long').val(lng);
                                                                                                                                                                                                                                                        $('#hd_postalcode').val(PostalCode);
                                                                                                                                                                                                                                                    }

                                                                                                                                                                                                                                                    function OnlyNumeric() {

                                                                                                                                                                                                                                                        var regex = new RegExp("^[0-9\]+$");
                                                                                                                                                                                                                                                        var key = String.fromCharCode(!event.charCode ? event.which : event.charCode);
                                                                                                                                                                                                                                                        if (!regex.test(key)) {
                                                                                                                                                                                                                                                            event.preventDefault();
                                                                                                                                                                                                                                                            return false;
                                                                                                                                                                                                                                                        }
                                                                                                                                                                                                                                                    }

                                                                                                                                                                                                                                                    function OnlyAlbhabet() {

                                                                                                                                                                                                                                                        var regex = new RegExp("^[a-zA-Z\.\ ]+$");
                                                                                                                                                                                                                                                        var key = String.fromCharCode(!event.charCode ? event.which : event.charCode);
                                                                                                                                                                                                                                                        if (!regex.test(key)) {
                                                                                                                                                                                                                                                            event.preventDefault();
                                                                                                                                                                                                                                                            return false;
                                                                                                                                                                                                                                                        }

                                                                                                                                                                                                                                                    }

                                                                                                                                                                                                                                                    function OnlyDecimalNumeric() {
                                                                                                                                                                                                                                                        var regex = new RegExp("^[0-9\.\]+$");
                                                                                                                                                                                                                                                        //var regex = new RegExp("^[0-9\.\]+$");
                                                                                                                                                                                                                                                        var key = String.fromCharCode(!event.charCode ? event.which : event.charCode);
                                                                                                                                                                                                                                                        if (!regex.test(key)) {
                                                                                                                                                                                                                                                            event.preventDefault();
                                                                                                                                                                                                                                                            return false;
                                                                                                                                                                                                                                                        }
                                                                                                                                                                                                                                                    }

                                                                                                                                                                                                                                                    function RedeemOffers() {
                                                                                                                                                                                                                                                        if ($("#inactivetbl").hasClass("active")) {
                                                                                                                                                                                                                                                            $('#lblMessageComo').html('<h4>No Deals to apply</h4>');
                                                                                                                                                                                                                                                            return;
                                                                                                                                                                                                                                                        }
                                                                                                                                                                                                                                                        else {
                                                                                                                                                                                                                                                            $('#loader').show();
                                                                                                                                                                                                                                                            var id = 1;
                                                                                                                                                                                                                                                            var allAssets = '';

                                                                                                                                                                                                                                                            $('#active_tbl').find("tr.active").each(function (index) {
                                                                                                                                                                                                                                                                var assetkey = $(this).attr('id');
                                                                                                                                                                                                                                                                if (id > 1)
                                                                                                                                                                                                                                                                    allAssets = allAssets + ',';
                                                                                                                                                                                                                                                                allAssets = allAssets + assetkey;
                                                                                                                                                                                                                                                                id = id + 1;

                                                                                                                                                                                                                                                            });

                                                                                                                                                                                                                                                            $.ajax({
                                                                                                                                                                                                                                                                type: 'get',
                                                                                                                                                                                                                                                                url: '/Checkout?handler=ApplyDeals&AllAssets=' + allAssets,
                                                                                                                                                                                                                                                                data: null,
                                                                                                                                                                                                                                                                contentType: 'application/json;charset=utf-8',
                                                                                                                                                                                                                                                                dataType: 'json',

                                                                                                                                                                                                                                                                success: function (data) {

                                                                                                                                                                                                                                                                    if (data == 1)
                                                                                                                                                                                                                                                                        location.reload();
                                                                                                                                                                                                                                                                    else {
                                                                                                                                                                                                                                                                        $('#loader').hide();
                                                                                                                                                                                                                                                                        $('#lblMessageComo').html('<h4>Unable to apply Deal(s), Please try again!</h4>');
                                                                                                                                                                                                                                                                        //  alert(data);
                                                                                                                                                                                                                                                                    }
                                                                                                                                                                                                                                                                },
                                                                                                                                                                                                                                                                error: function (jqXHR, textStatus, errorThrown) {
                                                                                                                                                                                                                                                                    $('#loader').hide();
                                                                                                                                                                                                                                                                    if (jqXHR.status == 404 || errorThrown == 'Not Found') {

                                                                                                                                                                                                                                                                        $('#lblMessageComo').html('<h4>Unable to apply Deals, Please try again!</h4>');

                                                                                                                                                                                                                                                                    }
                                                                                                                                                                                                                                                                }
                                                                                                                                                                                                                                                            });

                                                                                                                                                                                                                                                        }


                                                                                                                                                                                                                                                    }</script>
                                                                                                                                                                                                                                                                <script>function checkUserLogin(modelName) {
                                                                                                                                                                                                                                                                   
                                                                                                                                                                                                                                                                        var GPSignIn = 0;
                                                                                                                                                                                                                                                                        if ($('#GPGuestSignInForward').length > 0) 
                                                                                                                                                                                                                                                                        {
                                                                                                                                                                                                                                                                            GPSignIn = parseInt($('#GPGuestSignInForward').val());
                                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                        }
                                                                                                                                                                                                                                                                        modelName = '#' + modelName;
                                                                                                                                                                                                                                                                        var username = $(modelName + ' #lgusername').val();
                                                                                                                                                                                                                                                                        var password = $(modelName + ' #lgpassword').val();

                                                                                                                                                                                                                                                                        if (username.trim() == '' || username == 'undefined') {
                                                                                                                                                                                                                                                                            $(modelName + ' #loginErrorMsg').text("Email/Phone can't be blank");
                                                                                                                                                                                                                                                                        }
                                                                                                                                                                                                                                                                        else if (password.trim() == '' || password == 'undefined') {
                                                                                                                                                                                                                                                                            $(modelName + ' #loginErrorMsg').text("Password can't be blank");
                                                                                                                                                                                                                                                                        }
                                                                                                                                                                                                                                                                        else {
                                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                            $('#loader').show();
                                                                                                                                                                                                                                                                            $.ajax({
                                                                                                                                                                                                                                                                                url: '/index?handler=CustomLogin',
                                                                                                                                                                                                                                                                                data: {
                                                                                                                                                                                                                                                                                    'Email': username, 'Password': password, 'IsGP': GPSignIn
                                                                                                                                                                                                                                                                                },
                                                                                                                                                                                                                                                                                dataType: 'json',
                                                                                                                                                                                                                                                                                type: 'get',
                                                                                                                                                                                                                                                                                success: function (data) {
                                                                                                                                                                                                                                                                                    
                                                                                                                                                                                                                                                                                    $('#loader').hide();
                                                                                                                                                                                                                                                                                    if (data == '1') 
                                                                                                                                                                                                                                                                                    {
                                                                                                                                                                                                                                                                                        $(modelName).modal('hide');
                                                                                                                                                                                                                                                                                        
                                                                                                                                                                                                                                                                                        //if (modelName == '#CheckoutloginModal') Jira Ticket QOVER2-2954
                                                                                                                                                                                                                                                                                        if (modelName == '#loginModal') 
                                                                                                                                                                                                                                                                                        {
                                                                                                                                                                                                                                                                                            //alert('NB1')
                                                                                                                                                                                                                                                                                            window.location = "/Checkout";
                                                                                                                                                                                                                                                                                        }
                                                                                                                                                                                                                                                                                        else if (modelName == '#loginModalOrder') 
                                                                                                                                                                                                                                                                                        {
                                                                                                                                                                                                                                                                                            //alert('NB2')
                                                                                                                                                                                                                                                                                            window.location = "/orders";
                                                                                                                                                                                                                                                                                        }
                                                                                                                                                                                                                                                                                        else 
                                                                                                                                                                                                                                                                                        {
                                                                                                                                                                                                                                                                                            //alert('NB3')
                                                                                                                                                                                                                                                                                            //window.location = "/Checkout";
                                                                                                                                                                                                                                                                                            location.reload();
                                                                                                                                                                                                                                                                                        }
                                                                                                                                                                                                                                                                                        
                                                                                                                                                                                                                                                                                    }
                                                                                                                                                                                                                                                                                    else 
                                                                                                                                                                                                                                                                                    {
                                                                                                                                                                                                                                                                                        $(modelName + ' #loginErrorMsg').text("Unable to login with this email/phone and password. Check your login information and try again.");
                                                                                                                                                                                                                                                                                    }
                                                                                                                                                                                                                                                                                }
                                                                                                                                                                                                                                                                            });
                                                                                                                                                                                                                                                                        }
                                                                                                                                                                                                                                                                    }</script>
                                                                                                                                                                                                                                                                                <script>
                                                                                                                                                                                                                                                                                    function RegisterUser(modelName) {

                                                                                                                                                                                                                                                                                        var IsValid = 1;
                                                                                                                                                                                                                                                                                        modelName = '#' + modelName;
                                                                                                                                                                                                                                                                                        $.each($(modelName + ' #rfirstName,' + modelName + ' #rlastName,' + modelName + ' #remail,' + modelName + ' #rphone,' + modelName + ' #rpassword,' + modelName + ' #rconfirmPassword'), function () {
                                                                                                                                                                                                                                                                                            var thisId = $(this).attr('id');
                                                                                                                                                                                                                                                                                            var id = 'ErrorMessage-' + $(this).attr('id');
                                                                                                                                                                                                                                                                                            if (($(this).val()).trim() == '') {

                                                                                                                                                                                                                                                                                                IsValid = 0;

                                                                                                                                                                                                                                                                                                if ($('#' + id).length == 0) {
                                                                                                                                                                                                                                                                                                    $('<div id="' + id + '"><h7 style="color:red">Value can not be blank for the above.</h7></div>').insertAfter($(this));
                                                                                                                                                                                                                                                                                                }



                                                                                                                                                                                                                                                                                            }
                                                                                                                                                                                                                                                                                            else {
                                                                                                                                                                                                                                                                                                id = '#' + id;
                                                                                                                                                                                                                                                                                                $(id).remove();
                                                                                                                                                                                                                                                                                            }
                                                                                                                                                                                                                                                                                        });

                                                                                                                                                                                                                                                                                        if (IsValid == 1) {
                                                                                                                                                                                                                                                                                            var emailReg = /^([\w-\.]+@([\w-]+\.)+[\w-]{2,4})?$/;
                                                                                                                                                                                                                                                                                            var nameRegx = /^[a-zA-Z0-9 '.-]*$/;
                                                                                                                                                                                                                                                                                            if (!nameRegx.test($(modelName + ' #rfirstName').val())) {

                                                                                                                                                                                                                                                                                                $(modelName + ' #registerErrorMsg').html(' Enter valid First name');
                                                                                                                                                                                                                                                                                            }
                                                                                                                                                                                                                                                                                            else if (!nameRegx.test($(modelName + ' #rlastName').val())) {

                                                                                                                                                                                                                                                                                                $(modelName + ' #registerErrorMsg').html(' Enter valid Last name ');
                                                                                                                                                                                                                                                                                            }
                                                                                                                                                                                                                                                                                            else if (!emailReg.test($(modelName + ' #remail').val())) {

                                                                                                                                                                                                                                                                                                $(modelName + ' #registerErrorMsg').html('Enter valid EmailId ');
                                                                                                                                                                                                                                                                                            }
                                                                                                                                                                                                                                                                                            else if (($(modelName + ' #rphone').val()).length < 10) {

                                                                                                                                                                                                                                                                                                $(modelName + ' #registerErrorMsg').html(' Enter valid Phone ');
                                                                                                                                                                                                                                                                                            }
                                                                                                                                                                                                                                                                                            else if ($(modelName + ' #rpassword').val() != $(modelName + ' #rconfirmPassword').val()) {

                                                                                                                                                                                                                                                                                                $(modelName + ' #registerErrorMsg').html('Password and confirm password not matching ');
                                                                                                                                                                                                                                                                                            }
                                                                                                                                                                                                                                                                                            else {
                                                                                                                                                                                                                                                                                                var model = {
                                                                                                                                                                                                                                                                                                    FirstName: $(modelName + ' #rfirstName').val(),
                                                                                                                                                                                                                                                                                                    LastName: $(modelName + ' #rlastName').val(),
                                                                                                                                                                                                                                                                                                    Email: $(modelName + ' #remail').val(),
                                                                                                                                                                                                                                                                                                    Phone: $(modelName + ' #rphone').val(),
                                                                                                                                                                                                                                                                                                    Password: $(modelName + ' #rpassword').val(),
                                                                                                                                                                                                                                                                                                }
                                                                                                                                                                                                                                                                                                $('#loader').show();
                                                                                                                                                                                                                                                                                                $.ajax({
                                                                                                                                                                                                                                                                                                    type: 'get',
                                                                                                                                                                                                                                                                                                    url: '/RegisterNewUser?handler=RegisterUser',
                                                                                                                                                                                                                                                                                                    data: { 'model': JSON.stringify(model) },
                                                                                                                                                                                                                                                                                                    dataType: "html",
                                                                                                                                                                                                                                                                                                    success: function (data) {
                                                                                                                                                                                                                                                                                                        data = data.substring(1, data.length - 1);
                                                                                                                                                                                                                                                                                                        if (data == "1") {
                                                                                                                                                                                                                                                                                                            $(modelName + ' #registerErrorMsg').html('<h4>Successfully Registered. Please close Pop Up to continue!</h4>');
                                                                                                                                                                                                                                                                                                            $(modelName + ' .close').attr('onclick', 'javascript:$("#loader").show();;location.reload();');
                                                                                                                                                                                                                                                                                                            $(modelName + ' .modal-footer .customclose').attr('onclick', 'javascript:$("#loader").show();;location.reload();');
                                                                                                                                                                                                                                                                                                            IsCustomSignupDone = true;
                                                                                                                                                                                                                                                                                                            $(modelName + ' .btn_signup').hide();
                                                                                                                                                                                                                                                                                                        }

                                                                                                                                                                                                                                                                                                        else {

                                                                                                                                                                                                                                                                                                            $(modelName + ' #registerErrorMsg').html('<h4>' + data + '</h4>');
                                                                                                                                                                                                                                                                                                        }
                                                                                                                                                                                                                                                                                                        $('#loader').hide();
                                                                                                                                                                                                                                                                                                    },
                                                                                                                                                                                                                                                                                                    error: function () {
                                                                                                                                                                                                                                                                                                        $('#loader').hide();
                                                                                                                                                                                                                                                                                                        $(modelName + ' #registerErrorMsg').html('<h4>Something went wrong. Please try after sometime.</h4>');
                                                                                                                                                                                                                                                                                                    }
                                                                                                                                                                                                                                                                                                })
                                                                                                                                                                                                                                                                                            }


                                                                                                                                                                                                                                                                                        }
                                                                                                                                                                                                                                                                                    }
                                                                                                                                                                                                                                                                                    var IsCustomSignupDone = false;

                                                                                                                                                                                                                                                                                    $(document).on('hidden.bs.modal', '.modal', function () {
                                                                                                                                                                                                                                                                                        if (IsCustomSignupDone) {
                                                                                                                                                                                                                                                                                            location.reload();
                                                                                                                                                                                                                                                                                        }
                                                                                                                                                                                                                                                                                        IsCustomSignupDone = false;
                                                                                                                                                                                                                                                                                    });
                                                                                                                                                                                                                                                                                    $('#rfirstName,#rlastName,#remail,#rphone,#rpassword,#rconfirmPassword').blur(function () {
                                                                                                                                                                                                                                                                                        var id = 'ErrorMessage-' + $(this).attr('id');
                                                                                                                                                                                                                                                                                        var emailReg = /^([\w-\.]+@([\w-]+\.)+[\w-]{2,4})?$/;
                                                                                                                                                                                                                                                                                        var nameRegx = /^[a-zA-Z0-9'.-]*$/;
                                                                                                                                                                                                                                                                                        if (($(this).val()).trim() == '') {
                                                                                                                                                                                                                                                                                            if ($('#' + id).length == 0) {
                                                                                                                                                                                                                                                                                                if ($(this).attr('id') == "rconfirmPassword" || $(this).attr('id') == "rpassword") {
                                                                                                                                                                                                                                                                                                    $('<div id="' + id + '"><h7 style="color:red">Value can not be blank for the above.</h7></div>').insertAfter($(this).parent());
                                                                                                                                                                                                                                                                                                }
                                                                                                                                                                                                                                                                                                else {
                                                                                                                                                                                                                                                                                                    $('<div id="' + id + '"><h7 style="color:red">Value can not be blank for the above.</h7></div>').insertAfter($(this));
                                                                                                                                                                                                                                                                                                }
                                                                                                                                                                                                                                                                                            }
                                                                                                                                                                                                                                                                                            else {
                                                                                                                                                                                                                                                                                                id = '#' + id;
                                                                                                                                                                                                                                                                                                $(id).show();
                                                                                                                                                                                                                                                                                            }

                                                                                                                                                                                                                                                                                        }
                                                                                                                                                                                                                                                                                        else {
                                                                                                                                                                                                                                                                                            ;
                                                                                                                                                                                                                                                                                            oldid = id;
                                                                                                                                                                                                                                                                                            id = '#' + id;
                                                                                                                                                                                                                                                                                            $(id).remove();
                                                                                                                                                                                                                                                                                            if (($(this).attr('id') == "rconfirmPassword" && $(this).parent().parent().parent().find("#rpassword").val().trim() != '') && $(this).val() != $(this).parent().parent().parent().find("#rpassword").val()) {
                                                                                                                                                                                                                                                                                                if ($(id).length == 0) {
                                                                                                                                                                                                                                                                                                    $('<div id="' + oldid + '"><h7 style="color:red">Password and confirm password must be same.</h7></div>').insertAfter($(this).parent());
                                                                                                                                                                                                                                                                                                }
                                                                                                                                                                                                                                                                                                else {

                                                                                                                                                                                                                                                                                                    $(id).show();
                                                                                                                                                                                                                                                                                                }
                                                                                                                                                                                                                                                                                            }
                                                                                                                                                                                                                                                                                            else if ($(this).attr('id') == "rconfirmPassword") {
                                                                                                                                                                                                                                                                                                if ($(this).parent().parent().parent().parent().find('#ErrorMessage-rpassword').length > 0) $(this).parent().parent().parent().parent().find('#ErrorMessage-rpassword').remove();

                                                                                                                                                                                                                                                                                                if ($(this).parent().parent().parent().parent().find(id).length > 0) $(this).parent().parent().parent().parent().find(id).remove();
                                                                                                                                                                                                                                                                                            }
                                                                                                                                                                                                                                                                                            if (($(this).attr('id') == "rpassword" && $(this).parent().parent().parent().find("#rconfirmPassword").val().trim() != '') && $(this).parent().parent().parent().find("#rconfirmPassword").val() != $(this).val()) {
                                                                                                                                                                                                                                                                                                if ($(id).length == 0) {
                                                                                                                                                                                                                                                                                                    $('<div id="' + oldid + '"><h7 style="color:red">Password and confirm password must be same.</h7></div>').insertAfter($(this).parent());
                                                                                                                                                                                                                                                                                                }
                                                                                                                                                                                                                                                                                                else {

                                                                                                                                                                                                                                                                                                    $(id).show();
                                                                                                                                                                                                                                                                                                }
                                                                                                                                                                                                                                                                                            }
                                                                                                                                                                                                                                                                                            else if ($(this).attr('id') == "rpassword") {

                                                                                                                                                                                                                                                                                                if ($(this).parent().parent().parent().parent().find('#ErrorMessage-rconfirmPassword').length > 0) $(this).parent().parent().parent().parent().find('#ErrorMessage-rconfirmPassword').remove();

                                                                                                                                                                                                                                                                                                if ($(this).parent().parent().parent().parent().find(id)) $(this).parent().parent().parent().parent().find(id).remove();
                                                                                                                                                                                                                                                                                            }
                                                                                                                                                                                                                                                                                            if ((($(this).attr('id') == "rfirstName" && !nameRegx.test($(this).val())) || $(this).attr('id') == "rlastName" && !nameRegx.test($(this).val()))) {
                                                                                                                                                                                                                                                                                                if ($(id).length == 0) {
                                                                                                                                                                                                                                                                                                    $('<div id="' + oldid + '"><h7 style="color:red">Invalid name.</h7></div>').insertAfter($(this));
                                                                                                                                                                                                                                                                                                }
                                                                                                                                                                                                                                                                                                else {

                                                                                                                                                                                                                                                                                                    $(id).show();
                                                                                                                                                                                                                                                                                                }
                                                                                                                                                                                                                                                                                            }
                                                                                                                                                                                                                                                                                            if ($(this).attr('id') == "remail" && !emailReg.test($(this).val())) {
                                                                                                                                                                                                                                                                                                if ($(id).length == 0) {
                                                                                                                                                                                                                                                                                                    $('<div id="' + oldid + '"><h7 style="color:red">Invalid email.</h7></div>').insertAfter($(this));
                                                                                                                                                                                                                                                                                                }
                                                                                                                                                                                                                                                                                                else {

                                                                                                                                                                                                                                                                                                    $(id).show();
                                                                                                                                                                                                                                                                                                }
                                                                                                                                                                                                                                                                                            }
                                                                                                                                                                                                                                                                                            if ($(this).attr('id') == "rphone" && ($(this).val()).length < 10) {
                                                                                                                                                                                                                                                                                                if ($(id).length == 0) {
                                                                                                                                                                                                                                                                                                    $('<div id="' + oldid + '"><h7 style="color:red">Invalid phone.</h7></div>').insertAfter($(this));
                                                                                                                                                                                                                                                                                                }
                                                                                                                                                                                                                                                                                                else {

                                                                                                                                                                                                                                                                                                    $(id).show();
                                                                                                                                                                                                                                                                                                }
                                                                                                                                                                                                                                                                                            }
                                                                                                                                                                                                                                                                                        }

                                                                                                                                                                                                                                                                                    });
                                                                                                                                                                                                                                                                                    function ForgotUser(modelName, isreset) {
                                                                                                                                                                                                                                                                                        $('#' + modelName + 'OTP').val('');
                                                                                                                                                                                                                                                                                        var email = $("#" + modelName + "EmailToVerify #email").val();
                                                                                                                                                                                                                                                                                        var emailReg = /^([\w-\.]+@([\w-]+\.)+[\w-]{2,4})?$/;
                                                                                                                                                                                                                                                                                        if (!emailReg.test(email)) {
                                                                                                                                                                                                                                                                                            $('#' + modelName + ' #forgotErrorMsg').text('');
                                                                                                                                                                                                                                                                                            $('#' + modelName + ' #forgotErrorMsg').text('Invalid email');
                                                                                                                                                                                                                                                                                        }
                                                                                                                                                                                                                                                                                        else {

                                                                                                                                                                                                                                                                                            $('#' + modelName + ' #forgotErrorMsg').text('');
                                                                                                                                                                                                                                                                                            $.ajax({
                                                                                                                                                                                                                                                                                                type: 'get',
                                                                                                                                                                                                                                                                                                url: '/RegisterNewUser?handler=GenerateOTP&email=' + email,
                                                                                                                                                                                                                                                                                                data: null,
                                                                                                                                                                                                                                                                                                dataType: 'json',
                                                                                                                                                                                                                                                                                                success: function (data) {
                                                                                                                                                                                                                                                                                                    if (data != 'NA') {
                                                                                                                                                                                                                                                                                                        $('#' + modelName + ' #forgotErrorMsg').text('');
                                                                                                                                                                                                                                                                                                        $('#' + modelName + ' #forgotErrorMsg').text('');
                                                                                                                                                                                                                                                                                                        $('#' + modelName + ' #' + modelName + 'EmailToVerifyMsg').hide();
                                                                                                                                                                                                                                                                                                        $('#' + modelName + ' #' + modelName + 'EmailToVerify').hide();
                                                                                                                                                                                                                                                                                                        $('#' + modelName + ' #' + modelName + 'OTPArea').show();
                                                                                                                                                                                                                                                                                                        $('#' + modelName + ' #' + modelName + 'NewPasswordArea').hide();
                                                                                                                                                                                                                                                                                                        $('#' + modelName + ' #' + modelName + 'ResetPassword').hide();
                                                                                                                                                                                                                                                                                                        $('#' + modelName + ' #' + modelName + 'SubmitOTP').show();
                                                                                                                                                                                                                                                                                                        $('#' + modelName + ' #' + modelName + 'NewPassword').hide();
                                                                                                                                                                                                                                                                                                        if (isreset) { $('#' + modelName + ' #forgotErrorMsg').text('OTP Sent.'); setTimeout(function () { $('#' + modelName + ' #forgotErrorMsg').text(''); }, 3000); }
                                                                                                                                                                                                                                                                                                    }
                                                                                                                                                                                                                                                                                                    else {
                                                                                                                                                                                                                                                                                                        $('#' + modelName + ' #forgotErrorMsg').text('');
                                                                                                                                                                                                                                                                                                        $('#' + modelName + ' #forgotErrorMsg').text('Unable to proceed with this email. Check your email and try again.');
                                                                                                                                                                                                                                                                                                    }
                                                                                                                                                                                                                                                                                                }
                                                                                                                                                                                                                                                                                            });
                                                                                                                                                                                                                                                                                        }

                                                                                                                                                                                                                                                                                    }
                                                                                                                                                                                                                                                                                    function SubmitOTP(modelName) {
                                                                                                                                                                                                                                                                                        var otp = $('#' + modelName + 'OTP').val();
                                                                                                                                                                                                                                                                                        $('#' + modelName + 'password').val('');
                                                                                                                                                                                                                                                                                        $('#' + modelName + 'confirmPassword').val('');
                                                                                                                                                                                                                                                                                        if (otp != 'undefined' && otp.trim() != '') {
                                                                                                                                                                                                                                                                                            $.ajax({
                                                                                                                                                                                                                                                                                                type: 'get',
                                                                                                                                                                                                                                                                                                url: '/RegisterNewUser?handler=SubmitOTP&otp=' + otp,
                                                                                                                                                                                                                                                                                                data: null,
                                                                                                                                                                                                                                                                                                dataType: 'json',
                                                                                                                                                                                                                                                                                                success: function (data) {
                                                                                                                                                                                                                                                                                                    if (data == '1') {
                                                                                                                                                                                                                                                                                                        $('#' + modelName + ' #forgotErrorMsg').text('');
                                                                                                                                                                                                                                                                                                        $('#' + modelName + ' #forgotErrorMsg').text('');
                                                                                                                                                                                                                                                                                                        $('#' + modelName + ' #' + modelName + 'EmailToVerifyMsg').hide();
                                                                                                                                                                                                                                                                                                        $('#' + modelName + ' #' + modelName + 'EmailToVerify').hide();
                                                                                                                                                                                                                                                                                                        $('#' + modelName + ' #' + modelName + 'OTPArea').hide();
                                                                                                                                                                                                                                                                                                        $('#' + modelName + ' #' + modelName + 'NewPasswordArea').show();
                                                                                                                                                                                                                                                                                                        $('#' + modelName + ' #' + modelName + 'ResetPassword').hide();
                                                                                                                                                                                                                                                                                                        $('#' + modelName + ' #' + modelName + 'SubmitOTP').hide();
                                                                                                                                                                                                                                                                                                        $('#' + modelName + ' #' + modelName + 'NewPassword').show();
                                                                                                                                                                                                                                                                                                    }
                                                                                                                                                                                                                                                                                                    else {
                                                                                                                                                                                                                                                                                                        $('#' + modelName + ' #forgotErrorMsg').text('');
                                                                                                                                                                                                                                                                                                        $('#' + modelName + ' #forgotErrorMsg').text('Invalid OTP. Check your email or try resend.');
                                                                                                                                                                                                                                                                                                    }
                                                                                                                                                                                                                                                                                                }
                                                                                                                                                                                                                                                                                            });
                                                                                                                                                                                                                                                                                        }
                                                                                                                                                                                                                                                                                    }
                                                                                                                                                                                                                                                                                    function UpdatePassword(modelName) {
                                                                                                                                                                                                                                                                                        var email = $("#" + modelName + "EmailToVerify #email").val();
                                                                                                                                                                                                                                                                                        var password = $('#' + modelName + 'password').val();
                                                                                                                                                                                                                                                                                        var confirmPassword = $('#' + modelName + 'confirmPassword').val();
                                                                                                                                                                                                                                                                                        if (password != 'undefined' && confirmPassword != 'undefined' && password.trim() != '' && confirmPassword.trim() != '') {
                                                                                                                                                                                                                                                                                            $('#' + modelName + ' #forgotErrorMsg').text('');
                                                                                                                                                                                                                                                                                            if (password.trim() == confirmPassword.trim()) {
                                                                                                                                                                                                                                                                                                $('#' + modelName + ' #forgotErrorMsg').text('');
                                                                                                                                                                                                                                                                                                var model = {
                                                                                                                                                                                                                                                                                                    FirstName: '',
                                                                                                                                                                                                                                                                                                    LastName: '',
                                                                                                                                                                                                                                                                                                    Email: email,
                                                                                                                                                                                                                                                                                                    Phone: '',
                                                                                                                                                                                                                                                                                                    Password: password,
                                                                                                                                                                                                                                                                                                    ConfirmPassword: confirmPassword
                                                                                                                                                                                                                                                                                                }
                                                                                                                                                                                                                                                                                                $.ajax({
                                                                                                                                                                                                                                                                                                    type: 'get',
                                                                                                                                                                                                                                                                                                    url: '/RegisterNewUser?handler=UpdatePassword',
                                                                                                                                                                                                                                                                                                    data: { 'dataModel': JSON.stringify(model) },
                                                                                                                                                                                                                                                                                                    dataType: 'html',
                                                                                                                                                                                                                                                                                                    success: function (data) {
                                                                                                                                                                                                                                                                                                        data = JSON.parse(data);
                                                                                                                                                                                                                                                                                                        if (data == '1') {
                                                                                                                                                                                                                                                                                                            $('#' + modelName + ' #forgotErrorMsg').text('');
                                                                                                                                                                                                                                                                                                            $('#' + modelName + ' #ForgotArea').hide();
                                                                                                                                                                                                                                                                                                            $('#' + modelName + ' #' + modelName + 'EmailToVerifyMsg').show();
                                                                                                                                                                                                                                                                                                            $('#' + modelName + ' #' + modelName + 'EmailToVerify').show();
                                                                                                                                                                                                                                                                                                            $('#' + modelName + ' #' + modelName + 'OTPArea').hide();
                                                                                                                                                                                                                                                                                                            $('#' + modelName + ' #' + modelName + 'NewPasswordArea').hide();
                                                                                                                                                                                                                                                                                                            $('#' + modelName + ' #' + modelName + 'ResetPassword').show();
                                                                                                                                                                                                                                                                                                            $('#' + modelName + ' #' + modelName + 'SubmitOTP').hide();
                                                                                                                                                                                                                                                                                                            $('#' + modelName + ' #' + modelName + 'NewPassword').hide();
                                                                                                                                                                                                                                                                                                            $('#' + modelName + ' #LoginArea').show();
                                                                                                                                                                                                                                                                                                            $('#' + modelName + ' #loginErrorMsg').text('Your Password has been changed.Please Sign in!');
                                                                                                                                                                                                                                                                                                        }
                                                                                                                                                                                                                                                                                                        else if (data == 'New password must be different from old password') {
                                                                                                                                                                                                                                                                                                            $('#' + modelName + ' #forgotErrorMsg').text('New password must be different from old password');
                                                                                                                                                                                                                                                                                                        }
                                                                                                                                                                                                                                                                                                        else {
                                                                                                                                                                                                                                                                                                            $('#' + modelName + ' #forgotErrorMsg').text('Something went wrong. Please check back later.');
                                                                                                                                                                                                                                                                                                        }

                                                                                                                                                                                                                                                                                                    }
                                                                                                                                                                                                                                                                                                })
                                                                                                                                                                                                                                                                                            }
                                                                                                                                                                                                                                                                                            else {
                                                                                                                                                                                                                                                                                                $('#' + modelName + ' #forgotErrorMsg').text('');
                                                                                                                                                                                                                                                                                                $('#' + modelName + ' #forgotErrorMsg').text('New password and confirm password should match.');
                                                                                                                                                                                                                                                                                            }
                                                                                                                                                                                                                                                                                        }
                                                                                                                                                                                                                                                                                        else {
                                                                                                                                                                                                                                                                                            $('#' + modelName + ' #forgotErrorMsg').text('');
                                                                                                                                                                                                                                                                                            $('#' + modelName + ' #forgotErrorMsg').text("New password and confirm password can't be blank.");
                                                                                                                                                                                                                                                                                        }
                                                                                                                                                                                                                                                                                    }

                                                                                                                                                                                                                                                                                    function isNumber(evt) {
                                                                                                                                                                                                                                                                                        evt = (evt) ? evt : window.event;
                                                                                                                                                                                                                                                                                        var charCode = (evt.which) ? evt.which : evt.keyCode;
                                                                                                                                                                                                                                                                                        var id = evt.target.id;
                                                                                                                                                                                                                                                                                        if (charCode > 31 && (charCode < 48 || charCode > 57)) {
                                                                                                                                                                                                                                                                                            return false;
                                                                                                                                                                                                                                                                                        }
                                                                                                                                                                                                                                                                                        if (id == 'rphone' || id == 'pphone') {
                                                                                                                                                                                                                                                                                            var val = evt.target.value.trim();
                                                                                                                                                                                                                                                                                            if (val.length < 10) {
                                                                                                                                                                                                                                                                                                return true
                                                                                                                                                                                                                                                                                            } else {
                                                                                                                                                                                                                                                                                                return false;
                                                                                                                                                                                                                                                                                            }
                                                                                                                                                                                                                                                                                        }
                                                                                                                                                                                                                                                                                        return true;
                                                                                                                                                                                                                                                                                    }
                                                                                                                                                                                                                                                                                    $('#confirmReset').click(function () {
                                                                                                                                                                                                                                                                                        $('#loader').show();
                                                                                                                                                                                                                                                                                        location.href = "/index";
                                                                                                                                                                                                                                                                                    });
                                                                                                                                                                                                                                                                                </script>


<script type="text/javascript" src="/js/CookieConsent.js" charset="UTF-8"></script>
<script type="text/javascript" charset="UTF-8">

    document.addEventListener('DOMContentLoaded', function () {
        
            cookieconsent.run({ "notice_banner_type": "simple", "consent_type": "implied", "palette": "light", "language": "en", "page_load_consent_levels": ["strictly-necessary", "functionality", "tracking", "targeting"], "notice_banner_reject_button_hide": false, "preferences_center_close_button_hide": false, "page_refresh_confirmation_buttons": false, "website_name": "OrderApp", "website_privacy_policy_url": "https://www.techryde.com/terms-of-use/" });
        });
</script>
<noscript>ePrivacy and GPDR Cookie Consent management by <a href="https://www.techryde.com/" rel="nofollow">Techryde Inc.</a></noscript>
<script>
    $('.cc-nb-changep').on('click',
        function () {
            $('#termsfeed-com---preferences-center > div > div > div.cc-cp-foot > div.cc-cp-foot-byline > a').attr('href', 'https://www.techryde.com');
        });

    $(document).on('ready', function () {
            $('.cc-nb-changep').on('click', function () {
                $('.cc-cp-foot-byline')
            });
        });
    </script>

